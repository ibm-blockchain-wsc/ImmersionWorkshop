
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.2">
    
    
      
        <title>Vscode part2 - Blockchain Immersion Workshop</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f72e892.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#section-1-commercial-paper-overview" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="Blockchain Immersion Workshop" class="md-header-nav__button md-logo" aria-label="Blockchain Immersion Workshop">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Blockchain Immersion Workshop
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Vscode part2
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/ibm-blockchain-wsc/ImmersionWorkshop.git" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Blockchain Immersion Workshop" class="md-nav__button md-logo" aria-label="Blockchain Immersion Workshop">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Blockchain Immersion Workshop
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ibm-blockchain-wsc/ImmersionWorkshop.git" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../assignment/" class="md-nav__link">
      Skytap image assignments
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../lab-intro/" class="md-nav__link">
      Choose your own lab - introduction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      IBM Blockchain Platform v2.5.0 on Linux on IBM Z Lab
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="IBM Blockchain Platform v2.5.0 on Linux on IBM Z Lab" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        IBM Blockchain Platform v2.5.0 on Linux on IBM Z Lab
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ibpconsole/" class="md-nav__link">
      Part 1 - Create a Blockchain Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ibpdeploy/" class="md-nav__link">
      Part 2 - Deploy Smart Contract
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../references/" class="md-nav__link">
      Additional Resources
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="section-1-commercial-paper-overview">Section 1: Commercial Paper Overview<a class="headerlink" href="#section-1-commercial-paper-overview" title="Permanent link">&para;</a></h1>
<p>This tutorial works with a sample commercial paper trading network
called <code>PaperNet</code>. Commercial paper is a type of unsecured lending in
the form of a "promissory note". The papers are normally issued by large
corporations to raise funds to meet short-term financial obligations at
a fixed rate of interest. Once issued at a fixed price, for a fixed
term, another company or bank will purchase them at a discount to the
face value and when the term is up, they will be redeemed for their face
value.</p>
<p>As an example, if a paper was issued at a face value of 10M USD for a
6-month term at 2% interest then it could be bought for 9.8M USD (10M less
2%) by another company or bank who is willing to bear the risk that the
issuer will not default. Once the term is up, then the paper could be
redeemed or sold back to the issuer for its full face value of 10M USD.
Between buying and redemption, the paper can be bought or sold between
different parties on a commercial paper market.</p>
<p>These three key steps of issue, buy and redeem are the main transactions
in a simplified commercial paper marketplace, which we will mirror in
our lab. We will see a commercial paper issued by a company called
MagnetoCorp and, once issued on the commercial paper blockchain network,
another company called DigiBank will first buy the paper and then redeem
it.</p>
<p>You'll act as a developer, end user, and administrator, within different
organizations, performing various steps designed to help you understand
what it's like to collaborate as two different organizations working
independently, but according to mutually agreed rules in a Hyperledger
Fabric network.</p>
<p>Below is an image of our PaperNet network. For our lab, we will create
Isabella who is with MagnetoCorp. Additionally, we will create Balaji
who is with DigiBank. Isabella will issue a paper for the network. The
paper will have an ID number, when it was issued, the maturity date, and
the face value in USD. Balaji, from DigiBank, will then buy the paper and
then eventually redeem it.</p>
<p><img alt="image" src="../vscode-images/papernet_overview.png" /></p>
<p>Below is the full breakdown of Part 2 of this lab:</p>
<ul>
<li>
<p>Setting the Stage
    :      Based off of Part 1, we have started a blockchain network,
            created a smart contract, created and run tests and then
            submitted transactions. For Part 2, we need to create a
            couple more docker containers that will set us up for
            success for the rest of the lab. One of these containers
            will just monitor the docker network we are operating in. If
            you have no idea what a docker network is, I will explain
            later on. The other container contains Hyperledger Fabric
            tools and is named cliMagnetoCorp, as MagnetoCorp will use
            the Hyperledger Fabric command line interface (cli) within
            this container.</p>
</li>
<li>
<p>Install and Instantiate Smart Contract
    :      Now that we have those new docker containers up and running,
            we will enter our cliMagnetoCorp container and install and
            instantiate our smart contract. Since we are connected to
            the same running local Hyperledger Fabric network, we will
            see the smart contract show up in VSCode.</p>
</li>
<li>
<p>Issue Identities and Submit Transactions
    :      In this section, we will issue two identities. One is an
            end-user named Isabella with MagnetoCorp. She will invoke a
            transaction that will issue a paper. Then we will issue an
            identity for DigiBank named Balaji. Balaji will act as the
            adminstrator for DigiBank and will buy and redeem the paper
            that Isabella issued. Balaji is important in this lab, as we
            will add a Fabric Gateway connection to connect to his
            perspective of the network.</p>
</li>
<li>
<p>Create Fabric Gateways and Submit Transactions
    :      In this section we will create gateways that allows VSCode to
            connect to a running Hyperledger Fabric or IBM Blockchain
            Platform instance through a connection profile. In this lab,
            we will connect to our <code>local_fabric</code> network, which is also
            the Papernet network. We will create two gateways and
            associate our identities to these gateways. That way we can
            ensure the appropriate people are making the transactions
            they should.</p>
</li>
<li>
<p>Lab Cleanup
    :      This is the most bittersweet part of the entire lab. It means that this lab portion is over and we have to clean up. If you have kids (I don't), I'd imagine their faces are sad and full of despair when you (the guardian) tell them to clean up their mess. I'd also like to imagine your face is making a similar expression when we get to this lab. It's okay, more fun is going to be had soon - very soon!      </p>
</li>
<li>
<p>Loopback APIs
    :      We have proven that we can submit transactions through the
            command line interface (CLI) and the VSCode user interface.
            In this section, we will deploy two loopback API
            applications (for each of our organizations) and submit
            transactions through loopback. We will also include some
            transactions through the CLI and VSCode.</p>
</li>
</ul>
<h1 id="section-2-setting-the-stage">Section 2: Setting the Stage<a class="headerlink" href="#section-2-setting-the-stage" title="Permanent link">&para;</a></h1>
<p><strong>1.</strong> Navigate to your Desktop and then do a git clone of a repository
to gather all the things you need to run through this tutorial :</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~$ cd Desktop/</span>
<span class="err">tecadmin@ubuntubase:~/Desktop$ ls -l</span>
<span class="err">total 0</span>
<span class="err">drwxr-xr-x  16 tecadmin  tecadmin  512 Jun 11 12:34 Kale</span>
<span class="err">tecadmin@ubuntubase:~/Desktop$ git clone https://github.com/austingrice/fabric-samples-cp.git</span>
<span class="err">Cloning into &#39;fabric-samples-cp&#39;...</span>
<span class="c">remote: Enumerating objects: 85, done.</span>
<span class="c">remote: Counting objects: 100% (85/85), done.</span>
<span class="c">remote: Compressing objects: 100% (71/71), done.</span>
<span class="c">remote: Total 2658 (delta 26), reused 71 (delta 13), pack-reused 2573</span>
<span class="err">Receiving objects: 100% (2658/2658), 927.08 KiB | 0 bytes/s, done.</span>
<span class="err">Resolving deltas: 100% (1293/1293), done.</span>
<span class="err">tecadmin@ubuntubase:~/Desktop$ ls -l</span>
<span class="err">total 0</span>
<span class="err">drwxr-xr-x  22 tecadmin  tecadmin  704 Jun 11 12:41 fabric-samples-cp</span>
<span class="err">drwxr-xr-x  16 tecadmin  tecadmin  512 Jun 11 12:34 Kale</span>
</code></pre></div>

<p><strong>2.</strong> Then, do a <code>docker network list</code> to see all the running Docker
networks :</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop$ docker network list</span>
<span class="err">NETWORK ID          NAME                            DRIVER              SCOPE</span>
<span class="err">ad2e1a3e2fc2        bridge                          bridge              local</span>
<span class="err">35837170ae5b        fabricvscodelocalfabric_basic   bridge              local</span>
<span class="err">c5e0411b0d34        host                            host                local</span>
<span class="err">42ffa501f2f9        none                            null                local</span>
</code></pre></div>

<p><strong>3.</strong> The network we are operating out of is the
<code>fabricvscodelocalfabric_basic</code> network. You can see that by entering
the following command below :</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop$ docker network inspect fabricvscodelocalfabric_basic</span>
</code></pre></div>

<p>That command will show you all the containers running in this network.
In a nutshell, docker networks are natural ways to isolate containers
from other containers or other networks. Having containers within a
network allows them to communicate with other containers in the same
network.</p>
<p><strong>4.</strong> Within VSCode, go to the <code>Explorer</code> perspective and click on
<code>File</code> and select <code>Add Folder to Workplace..</code>. This will allow us to
work from an Untitled Workplace, but have the <code>fabric-samples-cp</code> folder
in there.</p>
<p><strong>5.</strong> Within VSCode, navigate to the folder below within MagnetoCorp :</p>
<div class="codehilite"><pre><span></span><code><span class="err">fabric-samples-cp -&gt; commercial-paper -&gt; organizations -&gt; magnetocorp -&gt; configuration -&gt; cli</span>
</code></pre></div>

<p>You will see two files in there. One file is <code>monitordocker.sh</code> that
will produce log messages across the network that you specify it to look
at. If you click on this file to open it up, you'll see the file is
called to look at the <code>fabricvscodelocalfabric_basic</code> Docker network.
The other file is <code>docker-compose.yml</code>, which pulls down a
<code>fabric-tools</code> container that is connected to our local network. When we
spun up our <code>local_fabric</code> network, back in Part 1, it placed all the
cryptographic material in our
<code>/home/tecadmin/.fabric-vscode/runtime/crypto-config/</code> directory. It is then
taking all the crypto material and placing it in our fabric-tools
container. This will make more sense once we install and instantiate the
smart contract from this container instead of VSCode.</p>
<p><strong>6.</strong> Now from the terminal navigate to the cli directory within
MagnetoCorp. <strong>NOTE:</strong> scroll over to see the entire command below :</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop$ cd fabric-samples-cp/commercial-paper/organization/magnetocorp/configuration/cli/</span>
<span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/magnetocorp/configuration/cli/$ ls -l</span>
<span class="err">total 16</span>
<span class="err">-rw-r--r--  1 tecadmin  tecadmin  1168 Jun 11 12:41 docker-compose.yml</span>
<span class="err">-rwxr-xr-x  1 tecadmin  tecadmin   751 Jun 11 12:44 monitordocker.sh</span>
</code></pre></div>

<p><strong>7.</strong> From here, we can actually start the <code>monitordocker.sh</code> script by
entering the command below. <strong>NOTE:</strong> scroll over to see the entire
command below :</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/magnetocorp/configuration/cli/$ ./monitordocker.sh fabricvscodelocalfabric_basic</span>
<span class="err">#</span>
</code></pre></div>

<p><strong>8.</strong> Since this terminal is occupied with log messages, let's open
another terminal tab. We can open a new tab by clicking on <code>File</code> and
then selecting <code>New Tab</code></p>
<p><strong>9.</strong> When you opened a new tab, you should have been taken to the same
file path that you were in on the previous tab. Now that we have a
command line ready, go ahead and enter the command below that will
create a <code>cliMagnetoCorp</code> container for our docker network to use.
<strong>NOTE:</strong> scroll over to see the entire command below :</p>
<div class="codehilite"><pre><span></span><code><span class="n">tecadmin</span><span class="err">@</span><span class="n">ubuntubase</span><span class="p">:</span><span class="o">~/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">samples</span><span class="o">-</span><span class="n">cp</span><span class="o">/</span><span class="n">commercial</span><span class="o">-</span><span class="n">paper</span><span class="o">/</span><span class="n">organization</span><span class="o">/</span><span class="n">magnetocorp</span><span class="o">/</span><span class="n">configuration</span><span class="o">/</span><span class="n">cli</span><span class="o">/$</span> <span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="o">-</span><span class="n">f</span> <span class="n">docker</span><span class="o">-</span><span class="n">compose</span><span class="o">.</span><span class="n">yml</span> <span class="n">up</span> <span class="o">-</span><span class="n">d</span> <span class="n">cliMagnetoCorp</span>
<span class="o">.</span>
<span class="o">.</span> <span class="c1"># We&#39;ll see docker messages</span>
<span class="o">.</span>
<span class="n">Status</span><span class="p">:</span> <span class="n">Downloaded</span> <span class="n">newer</span> <span class="n">image</span> <span class="k">for</span> <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">tools</span><span class="p">:</span><span class="n">latest</span>
<span class="n">Creating</span> <span class="n">cliMagnetoCorp</span> <span class="o">...</span> 
<span class="n">Creating</span> <span class="n">cliMagnetoCorp</span> <span class="o">...</span> <span class="n">done</span>
</code></pre></div>

<p><img alt="image" src="../vscode-images/papernet_magnetocorp.png" /></p>
<p>When we first install the smart contract, we will go through the
cliMagnetoCorp container, which is our Administrator Console. This will
allow us to use Fabric peer commands.</p>
<p><strong>10.</strong> We can also do a <code>docker ps -a</code> command to see all of our docker
containers. We should see two new containers - <code>cliMagnetoCorp</code> and
<code>logspout</code> from steps 9 and 10.</p>
<p><strong>11.</strong> Equally, we could do
<code>docker network inspect fabricvscodelocalfabric_basic</code> to see all of our
containers together in one network - and no, not in a blockchain
network. They are, however, the components that make up our local
blockchain network :-)</p>
<h1 id="section-3-install-and-instantiate-commercial-paper-smart-contract">Section 3: Install and Instantiate Commercial Paper Smart Contract<a class="headerlink" href="#section-3-install-and-instantiate-commercial-paper-smart-contract" title="Permanent link">&para;</a></h1>
<p>Before we actually install the commercial paper smart contract, let's
actually open the file to see what the smart contract is trying to do.</p>
<p><strong>1.</strong> From your explorer perspective within VSCode, navigate from the
<code>fabric-samples-cp</code> folder to the contract folder of MagnetoCorp :</p>
<div class="codehilite"><pre><span></span><code><span class="err">fabric-samples-cp -&gt; commercial-paper -&gt; organization -&gt; magnetocorp -&gt; contract</span>
</code></pre></div>

<p>Within the lib folder, you'll see 3 javascript (.js) files in there.
Click on the papercontract.js file, which will open it within VSCode</p>
<p><img alt="image" src="../vscode-images/2-2-1.png" /></p>
<p>Let's dissect our papercontract.js file as it is our smart contract. We
will only go over the issue transaction, but the other transactions
follow pretty closely to this one</p>
<p>Below, these 2 lines of code bring into scope two key Hyperledger Fabric
classes that will be used extensively by the smart contract --
<code>Contract and Context</code> :</p>
<div class="codehilite"><pre><span></span><code><span class="o">//</span> <span class="n">Fabric</span> <span class="n">smart</span> <span class="n">contract</span> <span class="n">classes</span>
<span class="k">const</span> <span class="p">{</span> <span class="n">Contract</span><span class="p">,</span> <span class="n">Context</span> <span class="p">}</span> <span class="o">=</span> <span class="n">require</span><span class="p">(</span><span class="s1">&#39;fabric-contract-api&#39;</span><span class="p">);</span>
</code></pre></div>

<p>Below, we define the smart contract class <code>CommercialPaperContract</code>
based on the built-in Fabric Contract class. The methods which implement
the key transactions to issue, buy and redeem commercial paper are
defined within this class :</p>
<div class="codehilite"><pre><span></span><code><span class="o">/**</span>
<span class="o">*</span> <span class="n">Define</span> <span class="n">commercial</span> <span class="n">paper</span> <span class="n">smart</span> <span class="n">contract</span> <span class="n">by</span> <span class="n">extending</span> <span class="n">Fabric</span> <span class="n">Contract</span> <span class="k">class</span>
<span class="o">*</span>
<span class="o">*/</span>
<span class="k">class</span> <span class="n">CommercialPaperContract</span> <span class="k">extends</span> <span class="n">Contract</span> <span class="p">{</span>
</code></pre></div>

<p>Below, this method defines the commercial paper <code>issue</code> transaction for
the commercial paper blockchain network. The parameters that are passed
to this method will be used to create the new commercial paper. Locate
and examine the buy and redeem transactions within the smart contract :</p>
<div class="codehilite"><pre><span></span><code><span class="err">/**</span>
<span class="err">* Issue commercial paper</span>
<span class="err">*</span>
<span class="err">* @param {Context} ctx the transaction context</span>
<span class="err">* @param {String} issuer commercial paper issuer</span>
<span class="err">* @param {Integer} paperNumber paper number for this issuer</span>
<span class="err">* @param {String} issueDateTime paper issue date</span>
<span class="err">* @param {String} maturityDateTime paper maturity date</span>
<span class="err">* @param {Integer} faceValue face value of paper</span>
<span class="err">*/</span>
<span class="err">async issue(ctx, issuer, paperNumber, issueDateTime, maturityDateTime, faceValue) {</span>
</code></pre></div>

<p>Within the <code>issue</code> transaction, this statement creates a new commercial
paper in memory using the CommercialPaper class with the supplied
transaction inputs. Examine the buy, get paper and redeem transactions
to see how they similarly use this class :</p>
<div class="codehilite"><pre><span></span><code><span class="err">// create an instance of the paper</span>
<span class="err">let paper = CommercialPaper.createInstance(issuer, paperNumber, issueDateTime, maturityDateTime, faceValue);</span>
</code></pre></div>

<p>Below, this statement adds the new commercial paper to the ledger using
<code>ctx.paperList</code>, an instance of a PaperList class that was created when
the smart contract context CommercialPaperContext was initialized.
Again, examine the buy and redeem methods to see how they use this class
:</p>
<div class="codehilite"><pre><span></span><code><span class="err">// Add the paper to the list of all similar commercial papers in the ledger world state</span>
<span class="err">await ctx.paperList.addPaper(paper);</span>
</code></pre></div>

<p>Below you will find that this statement returns a binary buffer as
response from the issue transaction for processing by the caller of the
smart contract :</p>
<div class="codehilite"><pre><span></span><code><span class="err">// Must return a serialized paper to caller of smart contract</span>
<span class="err">return paper.toBuffer();</span>
</code></pre></div>

<p><strong>2.</strong> Now that we have an understanding of the smart contract, let's
actually install it on our peer through our terminal application.
<strong>NOTE:</strong> scroll over to see the entire command below :</p>
<div class="codehilite"><pre><span></span><code><span class="n">tecadmin</span><span class="nv">@ubuntubase</span><span class="err">:</span><span class="o">~/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">samples</span><span class="o">-</span><span class="n">cp</span><span class="o">/</span><span class="n">commercial</span><span class="o">-</span><span class="n">paper</span><span class="o">/</span><span class="n">organization</span><span class="o">/</span><span class="n">magnetocorp</span><span class="o">/</span><span class="n">configuration</span><span class="o">/</span><span class="n">cli</span><span class="o">/</span><span class="err">$</span><span class="w"> </span><span class="n">docker</span><span class="w"> </span><span class="k">exec</span><span class="w"> </span><span class="n">cliMagnetoCorp</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">chaincode</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="n">papercontract</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">contract</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">node</span><span class="w"></span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">11</span><span class="w"> </span><span class="mi">17</span><span class="err">:</span><span class="mi">48</span><span class="err">:</span><span class="mf">23.721</span><span class="w"> </span><span class="n">UTC</span><span class="w"> </span><span class="o">[</span><span class="n">chaincodeCmd</span><span class="o">]</span><span class="w"> </span><span class="n">checkChaincodeCmdParams</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="mi">001</span><span class="w"> </span><span class="k">Using</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">escc</span><span class="w"></span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">11</span><span class="w"> </span><span class="mi">17</span><span class="err">:</span><span class="mi">48</span><span class="err">:</span><span class="mf">23.721</span><span class="w"> </span><span class="n">UTC</span><span class="w"> </span><span class="o">[</span><span class="n">chaincodeCmd</span><span class="o">]</span><span class="w"> </span><span class="n">checkChaincodeCmdParams</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="mi">002</span><span class="w"> </span><span class="k">Using</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">vscc</span><span class="w"></span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">11</span><span class="w"> </span><span class="mi">17</span><span class="err">:</span><span class="mi">48</span><span class="err">:</span><span class="mf">23.862</span><span class="w"> </span><span class="n">UTC</span><span class="w"> </span><span class="o">[</span><span class="n">chaincodeCmd</span><span class="o">]</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="mi">003</span><span class="w"> </span><span class="n">Installed</span><span class="w"> </span><span class="n">remotely</span><span class="w"> </span><span class="nl">response</span><span class="p">:</span><span class="o">&lt;</span><span class="nl">status</span><span class="p">:</span><span class="mi">200</span><span class="w"> </span><span class="nl">payload</span><span class="p">:</span><span class="ss">&quot;OK&quot;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"></span>
</code></pre></div>

<p>A message saying 200 is a great sign to see.</p>
<p>If you notice, we are not in the contract folder of our command line
interface. Instead, we are entering the <code>cliMagnetoCorp</code> docker
container with <code>docker exec cliMagnetoCorp</code> and navigating to the
<code>/opt/gopath/src/github.com/contract</code> file path within our container to
grab the files we need to install the smart contract. The
<code>-n papercontract</code> flag names our smart contract papercontract. The
<code>-v 0</code> gives our smart contract a version of 0. Finally, the <code>-l node</code>
tells us that the language of our smart contract is nodejs. The picture
below goes into detail, visually, as to how we are actually installing a
copy of the commercial paper smart contract on our peer.</p>
<p><img alt="image" src="../vscode-images/papernet_magnetoinstall.png" /></p>
<p><strong>3.</strong> Since our network is connected to our VSCode instance, you can
refresh the <code>Local Fabric Ops panel</code> in VSCode under the
<code>IBM Blockchain Extension</code>. The refresh button (<code>unclosed circle icon</code>)
is revealed when you hover your mouse over the Local Fabric Ops panel</p>
<p><img alt="image" src="../vscode-images/2-2-3.png" /></p>
<p><strong>4.</strong> Since we have installed the smart contract, we should actually
make it active by instantiating it. <strong>NOTE:</strong> scroll over to see the
entire command below :</p>
<div class="codehilite"><pre><span></span><code><span class="n">tecadmin</span><span class="nv">@ubuntubase</span><span class="err">:</span><span class="o">~/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">samples</span><span class="o">-</span><span class="n">cp</span><span class="o">/</span><span class="n">commercial</span><span class="o">-</span><span class="n">paper</span><span class="o">/</span><span class="n">organization</span><span class="o">/</span><span class="n">magnetocorp</span><span class="o">/</span><span class="n">configuration</span><span class="o">/</span><span class="n">cli</span><span class="o">/</span><span class="err">$</span><span class="w"> </span><span class="n">docker</span><span class="w"> </span><span class="k">exec</span><span class="w"> </span><span class="n">cliMagnetoCorp</span><span class="w"> </span><span class="n">peer</span><span class="w"> </span><span class="n">chaincode</span><span class="w"> </span><span class="n">instantiate</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="n">papercontract</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="s1">&#39;{&quot;Args&quot;:[&quot;org.papernet.commercialpaper:instantiate&quot;]}&#39;</span><span class="w"> </span><span class="o">-</span><span class="n">C</span><span class="w"> </span><span class="n">mychannel</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="ss">&quot;&quot;</span><span class="w"></span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">11</span><span class="w"> </span><span class="mi">17</span><span class="err">:</span><span class="mi">50</span><span class="err">:</span><span class="mf">34.673</span><span class="w"> </span><span class="n">UTC</span><span class="w"> </span><span class="o">[</span><span class="n">chaincodeCmd</span><span class="o">]</span><span class="w"> </span><span class="n">InitCmdFactory</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="mi">001</span><span class="w"> </span><span class="n">Retrieved</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="p">(</span><span class="n">mychannel</span><span class="p">)</span><span class="w"> </span><span class="n">orderer</span><span class="w"> </span><span class="nl">endpoint</span><span class="p">:</span><span class="w">   </span><span class="n">orderer</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">17050</span><span class="w"></span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">11</span><span class="w"> </span><span class="mi">17</span><span class="err">:</span><span class="mi">50</span><span class="err">:</span><span class="mf">34.675</span><span class="w"> </span><span class="n">UTC</span><span class="w"> </span><span class="o">[</span><span class="n">chaincodeCmd</span><span class="o">]</span><span class="w"> </span><span class="n">checkChaincodeCmdParams</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="mi">002</span><span class="w"> </span><span class="k">Using</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">escc</span><span class="w"></span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">11</span><span class="w"> </span><span class="mi">17</span><span class="err">:</span><span class="mi">50</span><span class="err">:</span><span class="mf">34.675</span><span class="w"> </span><span class="n">UTC</span><span class="w"> </span><span class="o">[</span><span class="n">chaincodeCmd</span><span class="o">]</span><span class="w"> </span><span class="n">checkChaincodeCmdParams</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="mi">003</span><span class="w"> </span><span class="k">Using</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">vscc</span><span class="w"></span>
<span class="n">tecadmin</span><span class="nv">@ubuntubase</span><span class="err">:</span><span class="o">~/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">samples</span><span class="o">-</span><span class="n">cp</span><span class="o">/</span><span class="n">commercial</span><span class="o">-</span><span class="n">paper</span><span class="o">/</span><span class="n">organization</span><span class="o">/</span><span class="n">magnetocorp</span><span class="o">/</span><span class="n">configuration</span><span class="o">/</span><span class="n">cli</span><span class="o">/</span><span class="err">$</span><span class="w"></span>
</code></pre></div>

<p>As you can see in the image below, we are instantiating a copy of the
commercial paper smart contract on our MagnetoCorp peer. Similar to the
installation of the smart contract, the instantiation goes into the
<code>cliMagnetoCorp</code> container. After successfully instantiating the smart
contract, there will be a commercial paper smart contract docker image
and container.</p>
<p><img alt="image" src="../vscode-images/papernet_magnetoinstant.png" /></p>
<p><strong>5.</strong> You will know our instantiate command worked when we get our
command prompt back without any error messages. You can really verify it
worked by going back to the VSCode and refreshing the Local Fabric Ops
panel and you should see it under the instantiate section.</p>
<p><img alt="image" src="../vscode-images/2-2-5.png" /></p>
<h1 id="section-4-create-identities-and-submit-transactions">Section 4: Create Identities and Submit Transactions<a class="headerlink" href="#section-4-create-identities-and-submit-transactions" title="Permanent link">&para;</a></h1>
<p>Now that we have a ready-to-use smart contract, let's issue some
identities so that those identities can invoke and query transactions.</p>
<p><strong>1.</strong> You should be within the cli folder of the MagnetoCorp folder.
You can confirm this by issuing the command below. <strong>NOTE:</strong> scroll over
to see the entire command below :</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/magnetocorp/configuration/cli/$ pwd</span>
<span class="err">/home/tecadmin/Desktop/fabric-samples-cp/commercial-paper/organization/magnetocorp/configuration/cli</span>
<span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/magnetocorp/configuration/cli/$</span>
</code></pre></div>

<p><strong>2.</strong> This is a good sign. Issue the following command below to get to
the application folder within MagnetoCorp. <strong>NOTE:</strong> scroll over to see
the entire command below :</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/magnetocorp/configuration/cli/$ cd ../../application/</span>
<span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples/commercial-paper/organization/magnetocorp/application$</span>
</code></pre></div>

<p><strong>3.</strong> Within VSCode, navigate to the same folder :</p>
<div class="codehilite"><pre><span></span><code><span class="err">fabric-samples-cp -&gt; commercial-paper -&gt; organization -&gt; magnetocorp -&gt; appplication</span>
</code></pre></div>

<p><strong>4.</strong> In that folder, you should see a file called <code>addtoWallet.js</code>.
Go ahead and click on it to open it up.</p>
<p><strong>5.</strong> On line 25, you should see what is below :</p>
<div class="codehilite"><pre><span></span><code><span class="k">const</span> <span class="n">key</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">readFileSync</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">credPath</span><span class="p">,</span> <span class="s1">&#39;/msp/keystore/&lt;PUT_PRIVATE_KEY_HERE&gt;&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">toString</span><span class="p">();</span>
</code></pre></div>

<p><strong>6.</strong> To put in the file name of your actual private key, you can enter the command below
in your terminal application to find the key's file name. <strong>NOTE:</strong> scroll over
to see the entire command below :</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/magnetocorp/application$ ls -l /home/tecadmin/.fabric-vscode/runtime/crypto-config/peerOrganizations/org1.example.com/users/User1@org1.example.com/msp/keystore/</span>
<span class="err">-rw-------@ 1 tecadmin  tecadmin  241 Jun 11 08:57 e7a117b799890646fe1d6e688d9c979845a411830400b673e2fe7dc01f91f9b8_sk</span>
</code></pre></div>

<p><strong>7.</strong> Now, copy your private key's file name,
<code>e7a117b799890646fe1d6e688d9c979845a411830400b673e2fe7dc01f91f9b8_sk</code> in this example- but your name will differ- 
and paste it in the field asking for your private key. For example, line 25
looks like this now. <strong>NOTE:</strong> scroll over to see the entire key file name below:</p>
<div class="codehilite"><pre><span></span><code><span class="k">const</span> <span class="n">key</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">readFileSync</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">credPath</span><span class="p">,</span> <span class="s1">&#39;/msp/keystore/e7a117b799890646fe1d6e688d9c979845a411830400b673e2fe7dc01f91f9b8_sk&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">toString</span><span class="p">();</span>
</code></pre></div>

<p><strong>NOTE:</strong> It is of the upmost importance that you are doing this from the
<code>magnetocorp/application</code> folder and you save this file. We will do the
DigiBank folder here in a second.</p>
<p><strong>8.</strong> Go ahead and save this file by either doing <code>File -&gt; Save</code> or
<code>Control + s</code>.</p>
<p><strong>9.</strong> Back in your terminal application, you can enter the command
below to install some dependencies. <strong>NOTE:</strong> scroll over to see the
entire command below :</p>
<div class="codehilite"><pre><span></span><code><span class="n">tecadmin</span><span class="p">@</span><span class="nl">ubuntubase</span><span class="p">:</span><span class="o">~/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">samples</span><span class="o">-</span><span class="n">cp</span><span class="o">/</span><span class="n">commercial</span><span class="o">-</span><span class="n">paper</span><span class="o">/</span><span class="n">organization</span><span class="o">/</span><span class="n">magnetocorp</span><span class="o">/</span><span class="n">application$</span> <span class="n">npm</span> <span class="n">install</span> 
<span class="p">.</span>
<span class="p">.</span> <span class="err">#</span> <span class="n">A</span> <span class="n">bunch</span> <span class="n">of</span> <span class="n">output</span><span class="p">,</span> <span class="n">with</span> <span class="n">some</span> <span class="n">of</span> <span class="n">the</span> <span class="n">output</span> <span class="n">repeating</span>
<span class="p">.</span>
<span class="n">node</span><span class="o">-</span><span class="n">pre</span><span class="o">-</span><span class="n">gyp</span> <span class="n">WARN</span> <span class="n">Using</span> <span class="n">request</span> <span class="k">for</span> <span class="n">node</span><span class="o">-</span><span class="n">pre</span><span class="o">-</span><span class="n">gyp</span> <span class="n">https</span> <span class="n">download</span> 
<span class="p">[</span><span class="n">grpc</span><span class="p">]</span> <span class="nl">Success</span><span class="p">:</span> <span class="s">&quot;/home/tecadmin/Desktop/fabric-samples/commercial-paper/organization/magnetocorp/application/node_modules/grpc/src/node/extension_binary/node-v57-darwin-x64-unknown/grpc_node.node&quot;</span> <span class="n">is</span> <span class="n">installed</span> <span class="n">via</span> <span class="n">remote</span>
<span class="n">npm</span> <span class="n">notice</span> <span class="n">created</span> <span class="n">a</span> <span class="n">lockfile</span> <span class="n">as</span> <span class="n">package</span><span class="o">-</span><span class="n">lock</span><span class="p">.</span><span class="n">json</span><span class="p">.</span> <span class="n">You</span> <span class="n">should</span> <span class="n">commit</span> <span class="n">this</span> <span class="n">file</span><span class="p">.</span>
<span class="n">npm</span> <span class="n">WARN</span> <span class="n">nodejs</span><span class="mf">@1.0.0</span> <span class="n">No</span> <span class="n">description</span>
<span class="n">npm</span> <span class="n">WARN</span> <span class="n">nodejs</span><span class="mf">@1.0.0</span> <span class="n">No</span> <span class="n">repository</span> <span class="n">field</span><span class="p">.</span>

<span class="n">added</span> <span class="mi">318</span> <span class="n">packages</span> <span class="k">in</span> <span class="mf">36.994</span><span class="n">s</span>
</code></pre></div>

<p><strong>10.</strong> Since we are in our command line, let's issue the following
command that will create Isabella. <strong>NOTE:</strong> scroll over to see the
entire command below :</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/magnetocorp/application$ node addToWallet.js </span>
<span class="err">done</span>
</code></pre></div>

<p><strong>11.</strong> We will know it worked if we can execute the following command
successfully. <strong>NOTE:</strong> scroll over to see the entire command below :</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/magnetocorp/application$ ls -l ../identity/user/isabella/wallet/</span>
<span class="err">total 0</span>
<span class="err">drwxr-xr-x  5 tecadmin  tecadmin  160 Jun 11 12:53 User1@org1.example.com</span>
<span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/magnetocorp/application$ ls -l ../identity/user/isabella/wallet/User1@org1.example.com/</span>
<span class="err">total 24</span>
<span class="err">-rw-r--r--  1 tecadmin  tecadmin  1037 Jun 11 12:53 User1@org1.example.com</span>
<span class="err">-rw-r--r--  1 tecadmin  tecadmin   246 Jun 11 12:53 e7a117b799890646fe1d6e688d9c979845a411830400b673e2fe7dc01f91f9b8-priv</span>
<span class="err">-rw-r--r--  1 tecadmin  tecadmin   182 Jun 11 12:53 e7a117b799890646fe1d6e688d9c979845a411830400b673e2fe7dc01f91f9b8-pub</span>
</code></pre></div>

<p>Keys are vital to understanding how transactions and identity work
within a blockchain network. Below is a breakdown of the keys and
certificate used in this example:</p>
<ul>
<li>a <strong>private key</strong> <code>e7a117b799...-priv</code> used to sign transactions on
    Isabella's behalf, but not distributed outside of her immediate
    control</li>
<li>a <strong>public key</strong> <code>e7a117b799...-pub</code> which is cryptographically
    linked to Isabella's private key. This public key is contained
    within Isabella's X.509 certificate</li>
<li>a <strong>certificate</strong> <code>User1@org.example.com</code> which contains Isabella's
    public key and other X.509 attributes added by the Certificate
    Authority at certificate creation. This certificate is distributed
    to the network so that different actors at different times can
    cryptographically verify information signed by Isabella's private
    key</li>
</ul>
<p><strong>12.</strong> Before we submit our first transaction, let's go over it below.
You can find the code by clicking on <code>issue.js</code> within the
<code>magnetocorp/application</code> folder in VSCode.</p>
<p>Below we bring two key Hyperledger Fabric SDK classes into scope --
<code>Wallet and Gateway</code>. Because Isabella's X.509 certificate is in the
local file system, the application uses FileSystemWallet :</p>
<div class="codehilite"><pre><span></span><code><span class="o">//</span> <span class="n">Bring</span> <span class="n">key</span> <span class="n">classes</span> <span class="n">into</span> <span class="n">scope</span><span class="p">,</span> <span class="n">most</span> <span class="n">importantly</span> <span class="n">Fabric</span> <span class="n">SDK</span> <span class="n">network</span> <span class="k">class</span> 
<span class="k">const</span> <span class="p">{</span> <span class="n">FileSystemWallet</span><span class="p">,</span> <span class="n">Gateway</span> <span class="p">}</span> <span class="o">=</span> <span class="n">require</span><span class="p">(</span><span class="s1">&#39;fabric-network&#39;</span><span class="p">);</span>
</code></pre></div>

<p>Below, this statement identifies that the application will use
Isabella's wallet when it connects to the blockchain network channel.
The application will select a particular identity within Isabella's
wallet. (The wallet must have been loaded with Isabella's X.509
certificate -- that's what addToWallet.js does):</p>
<div class="codehilite"><pre><span></span><code><span class="o">//</span> <span class="n">A</span> <span class="n">wallet</span> <span class="n">stores</span> <span class="n">a</span> <span class="n">collection</span> <span class="n">of</span> <span class="n">identities</span> <span class="k">for</span> <span class="n">use</span> 
<span class="k">const</span> <span class="n">wallet</span> <span class="o">=</span> <span class="n">new</span> <span class="n">FileSystemWallet</span><span class="p">(</span><span class="s1">&#39;../identity/user/isabella/wallet&#39;</span><span class="p">);</span>
</code></pre></div>

<p>This line of code, below, connects to the network using the gateway
identified by connectionProfile, using the identity referred to in
connectionOptions. See how <code>../gateway/networkConnection.yaml</code> and
<code>User1@org1.example.com</code> are used for these values respectively:</p>
<div class="codehilite"><pre><span></span><code><span class="err">// Connect to gateway using application specified parameters </span>
<span class="err">await gateway.connect(connectionProfile, connectionOptions);</span>
</code></pre></div>

<p>Below in the couple lines of code, the application connects to the
network channel <code>mychannel</code>, where the papercontract was previously
instantiated. If you had a different channel name, you would have to
modify this line of code:</p>
<div class="codehilite"><pre><span></span><code><span class="o">//</span> <span class="n">Access</span> <span class="n">commercial</span> <span class="n">paper</span> <span class="n">network</span> 
<span class="k">const</span> <span class="n">network</span> <span class="o">=</span> <span class="n">await</span> <span class="n">gateway</span><span class="o">.</span><span class="n">getNetwork</span><span class="p">(</span><span class="s1">&#39;mychannel&#39;</span><span class="p">);</span>
</code></pre></div>

<p>Below, this statement gives the application addressability to the smart
contract defined by the namespace <code>org.papernet.commercialpaper</code> within
<code>papercontract</code>. Once an application has issued <code>getContract</code>, it can
submit any transaction implemented within it:</p>
<div class="codehilite"><pre><span></span><code><span class="o">//</span> <span class="n">Get</span> <span class="n">addressability</span> <span class="n">to</span> <span class="n">commercial</span> <span class="n">paper</span> <span class="n">contract</span> 
<span class="k">const</span> <span class="n">contract</span> <span class="o">=</span> <span class="n">await</span> <span class="n">network</span><span class="o">.</span><span class="n">getContract</span><span class="p">(</span><span class="s1">&#39;papercontract&#39;</span><span class="p">,</span> <span class="s1">&#39;org.papernet.comm...&#39;</span><span class="p">);</span>
</code></pre></div>

<p>Below, these lines of code submit a transaction to the network using the
issue transaction defined within the smart contract.
<code>MagnetoCorp, 00001</code> are the values to be used by the issue transaction
to create a new commercial paper:</p>
<div class="codehilite"><pre><span></span><code><span class="o">//</span> <span class="n">issue</span> <span class="n">commercial</span> <span class="n">paper</span> 
<span class="k">const</span> <span class="n">issueResponse</span> <span class="o">=</span> <span class="n">await</span> <span class="n">contract</span><span class="o">.</span><span class="n">submitTransaction</span><span class="p">(</span><span class="s1">&#39;issue&#39;</span><span class="p">,</span><span class="s1">&#39;MagnetoCorp&#39;</span><span class="p">,</span> <span class="s1">&#39;00001&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-05-31&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-11-30&#39;</span><span class="p">,</span><span class="s1">&#39;5000000&#39;</span><span class="p">);</span>
</code></pre></div>

<p>This statement, below, processes the response from the issue
transaction. The response needs to be deserialized from a buffer into
paper, a CommercialPaper object which can be interpreted correctly by
the application:</p>
<div class="codehilite"><pre><span></span><code><span class="err">// process response let paper =</span>
<span class="err">CommercialPaper.fromBuffer(issueResponse);</span>
</code></pre></div>

<p><strong>13.</strong> Now that we have Isabella from MagnetoCorp, let's perform the
issue transaction from our terminal. <strong>NOTE:</strong> scroll over to see the
entire command below:</p>
<div class="codehilite"><pre><span></span><code><span class="n">tecadmin</span><span class="nv">@ubuntubase</span><span class="err">:</span><span class="o">~/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">samples</span><span class="o">-</span><span class="n">cp</span><span class="o">/</span><span class="n">commercial</span><span class="o">-</span><span class="n">paper</span><span class="o">/</span><span class="n">organization</span><span class="o">/</span><span class="n">magnetocorp</span><span class="o">/</span><span class="n">application</span><span class="err">$</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="n">issue</span><span class="p">.</span><span class="n">js</span><span class="w"></span>
<span class="k">Connect</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">Fabric</span><span class="w"> </span><span class="n">gateway</span><span class="p">.</span><span class="w"></span>
<span class="k">Use</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="nl">channel</span><span class="p">:</span><span class="w"> </span><span class="n">mychannel</span><span class="p">.</span><span class="w"></span>
<span class="k">Use</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="n">papernet</span><span class="p">.</span><span class="n">commercialpaper</span><span class="w"> </span><span class="n">smart</span><span class="w"> </span><span class="n">contract</span><span class="p">.</span><span class="w"></span>
<span class="n">Submit</span><span class="w"> </span><span class="n">commercial</span><span class="w"> </span><span class="n">paper</span><span class="w"> </span><span class="n">issue</span><span class="w"> </span><span class="k">transaction</span><span class="p">.</span><span class="w"></span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">22</span><span class="nl">T17</span><span class="p">:</span><span class="mi">55</span><span class="err">:</span><span class="mf">20.631</span><span class="n">Z</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nl">info</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">TransactionEventHandler</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="nl">_strategySuccess</span><span class="p">:</span><span class="w"> </span><span class="n">strategy</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">transaction</span><span class="w"> </span><span class="ss">&quot;f8e124886d6cb84434cb6a996f4889145c0541199c88bab7d4d85ae41266e51e&quot;</span><span class="w"></span>
<span class="n">Process</span><span class="w"> </span><span class="n">issue</span><span class="w"> </span><span class="k">transaction</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="w"></span>
<span class="n">MagnetoCorp</span><span class="w"> </span><span class="n">commercial</span><span class="w"> </span><span class="n">paper</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">00001</span><span class="w"> </span><span class="n">successfully</span><span class="w"> </span><span class="n">issued</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="mi">5000000</span><span class="w"></span>
<span class="k">Transaction</span><span class="w"> </span><span class="n">complete</span><span class="p">.</span><span class="w"></span>
<span class="k">Disconnect</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Fabric</span><span class="w"> </span><span class="n">gateway</span><span class="p">.</span><span class="w"></span>
<span class="n">Issue</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">complete</span><span class="p">.</span><span class="w"></span>
</code></pre></div>

<p>This successfully committed a transaction to the ledger. See how it
outputted a transaction hash for us. You can look at our
<code>monitoring docker</code> terminal tab as well.</p>
<p>As you can see in the image below, we are using the certificate
belonging to Isabella to submit our paper issue transaction. Once we
verify that Isabella can submit a transaction (via her certificate), the
gateway allows the application to focus on transaction generation,
submission and response. It coordinates the transaction proposal,
ordering and notification processing between the different network
components.</p>
<p><img alt="image" src="../vscode-images/papernet_magnetoissue.png" /></p>
<p><strong>14.</strong> Since we have created an identity for MagnetoCorp, let's also
create Balaji from DigiBank. To do so, we will need a third command line
tab. We can add another command line tab by clicking on
<code>File -&gt; New Tab.</code> This will create a new tab in the terminal from the
exact folder directory we were in from our second command line tab. This
third tab will act as DigiBank.</p>
<p><strong>15.</strong> We now need to switch to a new directory, specifically the
application folder of DigiBank. <strong>NOTE:</strong> scroll over to see the entire
command below:</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/magnetocorp/application$ cd ../../digibank/application/</span>
<span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/digibank/application$</span>
</code></pre></div>

<p><strong>16.</strong> Within VSCode, navigate to the application folder of DigiBank :</p>
<div class="codehilite"><pre><span></span><code><span class="err">fabric-samples-cp -&gt; commercial-paper -&gt; organization -&gt; digibank -&gt; application</span>
</code></pre></div>

<p><strong>17.</strong> Similarly, you will see <code>&lt;PUT_PRIVATE_KEY_HERE&gt;</code> in the
<code>addtoWallet.js</code> file within the <code>application</code> folder. On line 25, you
should see what is below :</p>
<div class="codehilite"><pre><span></span><code><span class="k">const</span> <span class="n">key</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">readFileSync</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">credPath</span><span class="p">,</span> <span class="s1">&#39;/msp/keystore/&lt;PUT_PRIVATE_KEY_HERE&gt;&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">toString</span><span class="p">();</span>
</code></pre></div>

<p><strong>18.</strong> To put in an actual private keys's file name, you can enter the command below
in your terminal application to find the key's file name. <strong>NOTE:</strong> scroll over
to see the entire key below:</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/digibank/application$ ls -l /home/tecadmin/.fabric-vscode/runtime/crypto-config/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp/keystore/</span>
<span class="err">-rw-------@ 1 tecadmin  tecadmin  241 Jun 11 08:57 4fd5a19cad827af71cf356d629f95c41f77e27db09d268a3c72aabdaead43737_sk</span>
</code></pre></div>

<p><strong>19.</strong> Now, copy your private key's file name,
<code>4fd5a19cad827af71cf356d629f95c41f77e27db09d268a3c72aabdaead43737_sk</code> in our example- yours will differ- 
and paste in the field asking for your private key. For example, line 25
looks like this now. <strong>NOTE:</strong> scroll over to see the entire file name below:</p>
<div class="codehilite"><pre><span></span><code><span class="k">const</span> <span class="n">key</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">readFileSync</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">credPath</span><span class="p">,</span> <span class="s1">&#39;/msp/keystore/4fd5a19cad827af71cf356d629f95c41f77e27db09d268a3c72aabdaead43737_sk&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">toString</span><span class="p">();</span>
</code></pre></div>

<p><strong>NOTE:</strong> It is of the upmost importance that you are doing this from the
<code>digibank/application</code> folder and you save this file.</p>
<p><strong>20.</strong> Now we can install some dependencies that are required to create
our identity. To do this, enter the command that is below. <strong>NOTE:</strong>
scroll over to see the entire command below :</p>
<div class="codehilite"><pre><span></span><code><span class="n">tecadmin</span><span class="p">@</span><span class="nl">ubuntubase</span><span class="p">:</span><span class="o">~/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">samples</span><span class="o">-</span><span class="n">cp</span><span class="o">/</span><span class="n">commercial</span><span class="o">-</span><span class="n">paper</span><span class="o">/</span><span class="n">organization</span><span class="o">/</span><span class="n">digibank</span><span class="o">/</span><span class="n">application$</span> <span class="n">npm</span> <span class="n">install</span> 
<span class="p">.</span>
<span class="p">.</span> <span class="err">#</span> <span class="n">A</span> <span class="n">bunch</span> <span class="n">of</span> <span class="n">output</span><span class="p">,</span> <span class="n">with</span> <span class="n">some</span> <span class="n">of</span> <span class="n">the</span> <span class="n">output</span> <span class="n">repeating</span>
<span class="p">.</span>
<span class="n">node</span><span class="o">-</span><span class="n">pre</span><span class="o">-</span><span class="n">gyp</span> <span class="n">WARN</span> <span class="n">Using</span> <span class="n">request</span> <span class="k">for</span> <span class="n">node</span><span class="o">-</span><span class="n">pre</span><span class="o">-</span><span class="n">gyp</span> <span class="n">https</span> <span class="n">download</span> 
<span class="p">[</span><span class="n">grpc</span><span class="p">]</span> <span class="nl">Success</span><span class="p">:</span> <span class="s">&quot;/home/tecadmin/Desktop/fabric-samples/commercial-paper/organization/magnetocorp/application/node_modules/grpc/src/node/extension_binary/node-v57-darwin-x64-unknown/grpc_node.node&quot;</span> <span class="n">is</span> <span class="n">installed</span> <span class="n">via</span> <span class="n">remote</span>
<span class="n">npm</span> <span class="n">notice</span> <span class="n">created</span> <span class="n">a</span> <span class="n">lockfile</span> <span class="n">as</span> <span class="n">package</span><span class="o">-</span><span class="n">lock</span><span class="p">.</span><span class="n">json</span><span class="p">.</span> <span class="n">You</span> <span class="n">should</span> <span class="n">commit</span> <span class="n">this</span> <span class="n">file</span><span class="p">.</span>
<span class="n">npm</span> <span class="n">WARN</span> <span class="n">nodejs</span><span class="mf">@1.0.0</span> <span class="n">No</span> <span class="n">description</span>
<span class="n">npm</span> <span class="n">WARN</span> <span class="n">nodejs</span><span class="mf">@1.0.0</span> <span class="n">No</span> <span class="n">repository</span> <span class="n">field</span><span class="p">.</span>

<span class="n">added</span> <span class="mi">318</span> <span class="n">packages</span> <span class="k">in</span> <span class="mf">36.994</span><span class="n">s</span>
</code></pre></div>

<p><strong>21.</strong> Since we are in our command line, let's issue the following
command that will create Balaji. <strong>NOTE:</strong> scroll over to see the
entire command below:</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/digibank/application$ node addToWallet.js </span>
<span class="err">done</span>
</code></pre></div>

<p><strong>22.</strong> We will know it worked if we can execute the following command
successfully. <strong>NOTE:</strong> scroll over to see the entire command below :</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/digibank/application$ ls -l ../identity/user/balaji/wallet/</span>
<span class="err">total 0</span>
<span class="err">drwxr-xr-x  5 tecadmin  tecadmin  160 Jun 11 12:53 Admin@org1.example.com</span>
<span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/digibank/application$ ls -l ../identity/user/balaji/wallet/Admin@org1.example.com/</span>
<span class="err">total 24</span>
<span class="err">-rw-r--r--  1 tecadmin  tecadmin  1037 Jun 11 12:53 User1@org1.example.com</span>
<span class="err">-rw-r--r--  1 tecadmin  tecadmin   246 Jun 11 12:53 4fd5a19cad827af71cf356d629f95c41f77e27db09d268a3c72aabdaead43737-priv</span>
<span class="err">-rw-r--r--  1 tecadmin  tecadmin   182 Jun 11 12:53 4fd5a19cad827af71cf356d629f95c41f77e27db09d268a3c72aabdaead43737-pub</span>
</code></pre></div>

<p>Based on the picture below, we now have 2 participants in this network.
Obviously, this is MagnetoCorp (Isabella) and DigiBank (Balaji). Both
participants are allowed to interact with the commercial paper
blockchain network through their application.</p>
<p><img alt="image" src="../vscode-images/papernet_magnetodigi.png" /></p>
<p><strong>23.</strong> Since we have issued a paper from Isabella, let's go ahead and
submit a couple of transactions from Balaji and DigiBank. Go ahead and
get the latest status of our paper by entering the command below.
<strong>NOTE:</strong> scroll over to see the entire command below:</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/digibank/application$ node getPaper.js</span>
<span class="err">Connect to Fabric gateway.</span>
<span class="err">Use network channel: mychannel.</span>
<span class="err">Use org.papernet.commercialpaper smart contract.</span>
<span class="err">Submit commercial paper getPaper transaction.</span>
<span class="err">Process getPaper transaction response.</span>
<span class="err"> +--------- Paper Retrieved ---------+ </span>
<span class="err"> | Paper number: &quot;00001&quot;</span>
<span class="err"> | Paper is owned by: &quot;MagnetoCorp&quot;</span>
<span class="err"> | Paper is currently: &quot;ISSUED&quot;</span>
<span class="err"> | Paper face value: &quot;5000000&quot;</span>
<span class="err"> | Paper is issued by: &quot;MagnetoCorp&quot;</span>
<span class="err"> | Paper issue on: &quot;2020-05-31&quot;</span>
<span class="err"> | Paper matures on: &quot;2020-11-30&quot;</span>
<span class="err"> +-----------------------------------+ </span>
<span class="err">Transaction complete.</span>
<span class="err">Disconnect from Fabric gateway.</span>
<span class="err">getPaper program complete.</span>
</code></pre></div>

<p><strong>24.</strong> Now that we know the current status of our <code>00001</code> paper,
let's go ahead and buy and redeem the paper by entering the command
below. <strong>NOTE:</strong> scroll over to see the entire command below :</p>
<div class="codehilite"><pre><span></span><code><span class="n">tecadmin</span><span class="nv">@ubuntubase</span><span class="err">:</span><span class="o">~/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">samples</span><span class="o">-</span><span class="n">cp</span><span class="o">/</span><span class="n">commercial</span><span class="o">-</span><span class="n">paper</span><span class="o">/</span><span class="n">organization</span><span class="o">/</span><span class="n">digibank</span><span class="o">/</span><span class="n">application</span><span class="err">$</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="n">buy</span><span class="p">.</span><span class="n">js</span><span class="w"></span>
<span class="k">Connect</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">Fabric</span><span class="w"> </span><span class="n">gateway</span><span class="p">.</span><span class="w"></span>
<span class="k">Use</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="nl">channel</span><span class="p">:</span><span class="w"> </span><span class="n">mychannel</span><span class="p">.</span><span class="w"></span>
<span class="k">Use</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="n">papernet</span><span class="p">.</span><span class="n">commercialpaper</span><span class="w"> </span><span class="n">smart</span><span class="w"> </span><span class="n">contract</span><span class="p">.</span><span class="w"></span>
<span class="n">Submit</span><span class="w"> </span><span class="n">commercial</span><span class="w"> </span><span class="n">paper</span><span class="w"> </span><span class="n">buy</span><span class="w"> </span><span class="k">transaction</span><span class="p">.</span><span class="w"></span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">28</span><span class="nl">T19</span><span class="p">:</span><span class="mi">52</span><span class="err">:</span><span class="mf">17.372</span><span class="n">Z</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nl">info</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">TransactionEventHandler</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="nl">_strategySuccess</span><span class="p">:</span><span class="w"> </span><span class="n">strategy</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">transaction</span><span class="w"> </span><span class="ss">&quot;871e7743c58e406575d4e553330faae3711c0a65a2f677b6e6d398650069d81a&quot;</span><span class="w"></span>
<span class="n">Process</span><span class="w"> </span><span class="n">buy</span><span class="w"> </span><span class="k">transaction</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="w"></span>
<span class="n">MagnetoCorp</span><span class="w"> </span><span class="n">commercial</span><span class="w"> </span><span class="n">paper</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">00001</span><span class="w"> </span><span class="n">successfully</span><span class="w"> </span><span class="n">purchased</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">DigiBank</span><span class="w"></span>
<span class="k">Transaction</span><span class="w"> </span><span class="n">complete</span><span class="p">.</span><span class="w"></span>
<span class="k">Disconnect</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Fabric</span><span class="w"> </span><span class="n">gateway</span><span class="p">.</span><span class="w"></span>
<span class="n">Buy</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">complete</span><span class="p">.</span><span class="w"></span>
</code></pre></div>

<p><strong>25.</strong> We can finish the cycle of paper <code>00001</code> by doing a redeem
transaction. The command is below. <strong>NOTE:</strong> scroll over to see the
entire command below :</p>
<div class="codehilite"><pre><span></span><code><span class="n">tecadmin</span><span class="nv">@ubuntubase</span><span class="err">:</span><span class="o">~/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">samples</span><span class="o">-</span><span class="n">cp</span><span class="o">/</span><span class="n">commercial</span><span class="o">-</span><span class="n">paper</span><span class="o">/</span><span class="n">organization</span><span class="o">/</span><span class="n">digibank</span><span class="o">/</span><span class="n">application</span><span class="err">$</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="n">redeem</span><span class="p">.</span><span class="n">js</span><span class="w"> </span>
<span class="k">Connect</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">Fabric</span><span class="w"> </span><span class="n">gateway</span><span class="p">.</span><span class="w"></span>
<span class="k">Use</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="nl">channel</span><span class="p">:</span><span class="w"> </span><span class="n">mychannel</span><span class="p">.</span><span class="w"></span>
<span class="k">Use</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="n">papernet</span><span class="p">.</span><span class="n">commercialpaper</span><span class="w"> </span><span class="n">smart</span><span class="w"> </span><span class="n">contract</span><span class="p">.</span><span class="w"></span>
<span class="n">Submit</span><span class="w"> </span><span class="n">commercial</span><span class="w"> </span><span class="n">paper</span><span class="w"> </span><span class="n">redeem</span><span class="w"> </span><span class="k">transaction</span><span class="p">.</span><span class="w"></span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">28</span><span class="nl">T19</span><span class="p">:</span><span class="mi">52</span><span class="err">:</span><span class="mf">46.452</span><span class="n">Z</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nl">info</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">TransactionEventHandler</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="nl">_strategySuccess</span><span class="p">:</span><span class="w"> </span><span class="n">strategy</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">transaction</span><span class="w"> </span><span class="ss">&quot;c26ecbf1077d99a5ea025c339ffabd88eb22cf4e6ac5ff8d9b570cd6c38eb531&quot;</span><span class="w"></span>
<span class="n">Process</span><span class="w"> </span><span class="n">redeem</span><span class="w"> </span><span class="k">transaction</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="w"></span>
<span class="n">MagnetoCorp</span><span class="w"> </span><span class="n">commercial</span><span class="w"> </span><span class="n">paper</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">00001</span><span class="w"> </span><span class="n">successfully</span><span class="w"> </span><span class="n">redeemed</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">MagnetoCorp</span><span class="w"></span>
<span class="k">Transaction</span><span class="w"> </span><span class="n">complete</span><span class="p">.</span><span class="w"></span>
<span class="k">Disconnect</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Fabric</span><span class="w"> </span><span class="n">gateway</span><span class="p">.</span><span class="w"></span>
<span class="n">Redeem</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">complete</span><span class="w"></span>
</code></pre></div>

<p><strong>26.</strong> To confirm that we actually redeemed the paper, you can do a
<code>getPaper</code> transaction to see that it was, indeed, redeemed. <strong>NOTE:</strong>
scroll over to see the entire command below :</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/digibank/application$ node getPaper.js</span>
<span class="err">Connect to Fabric gateway.</span>
<span class="err">Use network channel: mychannel.</span>
<span class="err">Use org.papernet.commercialpaper smart contract.</span>
<span class="err">Submit commercial paper getPaper transaction.</span>
<span class="err">Process getPaper transaction response.</span>
<span class="err">+--------- Paper Retrieved ---------+ </span>
<span class="err">| Paper number: &quot;00001&quot;</span>
<span class="err">| Paper is owned by: &quot;MagnetoCorp&quot;</span>
<span class="err">| Paper is currently: &quot;REDEEMED&quot;</span>
<span class="err">| Paper face value: &quot;5000000&quot;</span>
<span class="err">| Paper is issued by: &quot;MagnetoCorp&quot;</span>
<span class="err">| Paper issue on: &quot;2020-05-31&quot;</span>
<span class="err">| Paper matures on: &quot;2020-11-30&quot;</span>
<span class="err">+-----------------------------------+ </span>
<span class="err">Transaction complete.</span>
<span class="err">Disconnect from Fabric gateway.</span>
<span class="err">getPaper program complete</span>
</code></pre></div>

<p>Now, we have run through the full lifecycle of one paper through the
command line interface (CLI). In the following sections we will use a
mixture of the CLI, the VSCode user interface, and a loopback API service
application.</p>
<h1 id="section-5-create-fabric-gateways-and-submit-transactions">Section 5: Create Fabric Gateways and Submit Transactions<a class="headerlink" href="#section-5-create-fabric-gateways-and-submit-transactions" title="Permanent link">&para;</a></h1>
<p>In the previous section, we created two identities -
<code>Isabella and Balaji</code> - and then completed a full lifecycle of one paper.
Let's create a fabric gateway for Isabella and Balaji and then submit
some more transactions.</p>
<p><strong>1.</strong> Within VSCode, go to the IBM Blockchain Platform Extension. One
of the sections you'll see is called <code>Fabric Gateways</code>. If you click on
the gear icon in the bottom left, select <code>Command Palette..</code>. You'll be
given a prompt and you can enter this command below :</p>
<div class="codehilite"><pre><span></span><code><span class="err">&gt;IBM Blockchain Platform: Add Gateway</span>
</code></pre></div>

<p><strong>2.</strong> For our first Gateway, let's create MagnetoCorp. So when it
prompts you for: <code>Enter a name for the gateway</code> enter the following
below :</p>
<div class="codehilite"><pre><span></span><code><span class="err">MagnetoCorp</span>
</code></pre></div>

<p><strong>3.</strong> Then it will prompt you for a path to the connection profile.
Click on browse and it will open a file window. Navigate to the path
below and select <code>networkConnection.yaml</code>. <strong>NOTE:</strong> scroll over to see
the entire file path below :</p>
<div class="codehilite"><pre><span></span><code><span class="err">Desktop -&gt; fabric-samples-cp -&gt; commercial-paper -&gt; organization -&gt; magnetocorp -&gt; gateway -&gt; networkConnection.yaml</span>
<span class="err">.</span>
</code></pre></div>

<p><strong>4.</strong> Then it will place that new gateway in the <code>Fabric Gateway</code>
section within the IBM Blockchain Platform Extension. Now that we have a
gateway, we need to create an identity to use this gateway. To do this,
hover your cursor over the <code>Fabric Wallets</code> section of the extension.
There you'll see a <code>+</code> icon. Click on that <code>+</code> icon to add a wallet.</p>
<p><strong>5.</strong> Then it will prompt you: <code>Choose a method to add a wallet</code> and
for that select <code>Specify an existing file system wallet</code>. We are
selecting this because we already have added Isabella as an identity and
she has a wallet folder.</p>
<p><strong>6.</strong> Then it will prompt you: <code>Enter file path to a wallet directory</code>
and then select <code>Browse</code>. It will then pop-up a file window. From there,
you can navigate to the following path below. <strong>NOTE:</strong> scroll over to
see the entire file path below:</p>
<div class="codehilite"><pre><span></span><code><span class="err">Desktop -&gt; fabric-samples-cp -&gt; commercial-paper -&gt; organization -&gt; magnetocorp -&gt; identity -&gt; user -&gt; isabella -&gt; wallet</span>
<span class="err">.</span>
</code></pre></div>

<p>Once you have selected <code>wallet</code>, click on <code>select</code> to choose this
option. Then it will add a wallet, called <code>wallet</code>, to our
<code>Fabric Wallets</code> section of the extension.</p>
<p><strong>7.</strong> Once you see the wallet called <code>wallet</code> in the <code>Fabric Wallet</code>
section, go ahead and right click on <code>wallet</code>. How many times can you
say <code>wallet</code> in a sentence. From there, select <code>Edit Wallet</code> and it will
open a <code>settings.json</code> file with your wallet name and wallet path
highlighted. Go ahead and <strong>only</strong> change the <code>wallet name</code> to
<code>MagnetoCorpWallet</code>. Look below to see the example:</p>
<div class="codehilite"><pre><span></span><code><span class="ss">&quot;name&quot;</span><span class="p">:</span> <span class="ss">&quot;wallet&quot;</span><span class="p">,</span>
<span class="ss">&quot;walletPath&quot;</span><span class="p">:</span> <span class="ss">&quot;/home/tecadmin/Desktop/fabric-samples-cp/commercial-paper/organization/magnetocorp/identity/user/isabella/wallet&quot;</span>

<span class="c1">---- CHANGE TO -----</span>

<span class="ss">&quot;name&quot;</span><span class="p">:</span> <span class="ss">&quot;MagnetoCorpWallet&quot;</span><span class="p">,</span>
<span class="ss">&quot;walletPath&quot;</span><span class="p">:</span> <span class="ss">&quot;/home/tecadmin/Desktop/fabric-samples-cp/commercial-paper/organization/magnetocorp/identity/user/isabella/wallet&quot;</span>
</code></pre></div>

<p><strong>8.</strong> Once you have made that change, go ahead and save this file by
doing a <code>File -&gt; Save</code> or <code>Control + S</code>. Also - leave this file open as
we will want to change the name for DigiBank once we create their
wallet.</p>
<p><strong>9.</strong> Speaking of DigiBank, we now need to do the same process for
them. So click on the gear icon in the bottom left, select
<code>Command Palette..</code>. You'll be given a prompt and you can enter this
command below:</p>
<div class="codehilite"><pre><span></span><code><span class="err">&gt;IBM Blockchain Platform: Add Gateway</span>
</code></pre></div>

<p><strong>10.</strong> For our second Gateway, let's create DigiBank. So when it
prompts you for: <code>Enter a name for the gateway</code> enter the following
below:</p>
<div class="codehilite"><pre><span></span><code><span class="err">DigiBank</span>
</code></pre></div>

<p><strong>11.</strong> Then it will prompt you for a path to the connection profile.
Click on browse and it will open a file window. Navigate to the path
below and select <code>networkConnection.yaml</code>. <strong>NOTE:</strong> scroll over to see
the entire file path below:</p>
<div class="codehilite"><pre><span></span><code><span class="err">Desktop -&gt; fabric-samples-cp -&gt; commercial-paper -&gt; organization -&gt; digibank -&gt; gateway -&gt; networkConnection.yaml</span>
<span class="err">.</span>
</code></pre></div>

<p><strong>12.</strong> Then it will place that new gateway in the <code>Fabric Gateway</code>
section within the IBM Blockchain Platform Extension. Now that we have a
gateway, we need to create an identity to use this gateway. To do this,
hover your cursor over the <code>Fabric Wallets</code> section of the extension.
There you'll see a <code>+</code> icon. Click on that <code>+</code> icon to add a wallet.</p>
<p><strong>13.</strong> Then it will prompt you: <code>Choose a method to add a wallet</code> and
for that select <code>Specify an existing file system wallet</code>. We are
selecting this because we already have added Isabella as an identity and
she has a wallet folder.</p>
<p><strong>14.</strong> Then it will prompt you: <code>Enter file path to a wallet directory</code>
and then select <code>Browse</code>. It will then pop-up a file window. From there,
you can navigate to the following path below. <strong>NOTE:</strong> scroll over to
see the entire file path below:</p>
<div class="codehilite"><pre><span></span><code><span class="err">Desktop -&gt; fabric-samples-cp -&gt; commercial-paper -&gt; organization -&gt; digibank -&gt; identity -&gt; user -&gt; balaji -&gt; wallet</span>
<span class="err">.</span>
</code></pre></div>

<p>Once you have selected <code>wallet</code>, click on <code>select</code> to choose this
option. Then it will add a wallet, called <code>wallet</code>, to our
<code>Fabric Wallets</code> section of the extension.</p>
<p><strong>15.</strong> Once you see the wallet called <code>wallet</code> in the <code>Fabric Wallet</code>
section, go ahead and right click on <code>wallet</code>. From there, select
<code>Edit Wallet</code> and it will open a <code>settings.json</code> file with your wallet
name and wallet path highlighted. Go ahead and <strong>only</strong> change the
<code>wallet name</code> to <code>DigiBankWallet</code>. Look below to see the example:</p>
<div class="codehilite"><pre><span></span><code><span class="ss">&quot;name&quot;</span><span class="p">:</span> <span class="ss">&quot;wallet&quot;</span><span class="p">,</span>
<span class="ss">&quot;walletPath&quot;</span><span class="p">:</span> <span class="ss">&quot;/home/tecadmin/Desktop/fabric-samples-cp/commercial-paper/organization/digibank/identity/user/balaji/wallet&quot;</span>

<span class="c1">---- CHANGE TO -----</span>

<span class="ss">&quot;name&quot;</span><span class="p">:</span> <span class="ss">&quot;DigiBankWallet&quot;</span><span class="p">,</span>
<span class="ss">&quot;walletPath&quot;</span><span class="p">:</span> <span class="ss">&quot;/home/tecadmin/Desktop/fabric-samples-cp/commercial-paper/organization/digibank/identity/user/balaji/wallet&quot;</span>
</code></pre></div>

<p><strong>16.</strong> Once you have made that change, go ahead and save this file by
doing a <code>File -&gt; Save</code> or <code>Control + S</code>. Now within your
<code>Fabric Wallets</code> section, you should have <code>MagnetCorpWallet</code> and
<code>DigiBankWallet</code> as our two custom wallets.</p>
<p><strong>17.</strong> Now that we have two wallets, we can associate our wallets to
our two gateways. To do this <code>right click</code> on <code>MagnetoCorp</code> within the
<code>Fabric Gateways</code> section. Then select <code>Associate A Wallet</code>. Then it
will prompt you for which wallet to associate with this gateway. You
will want to select <code>MagnetoCorpWallet</code>.</p>
<p>What this does is when you connect with a specific gateway, it will
automatically use that wallet you associated it with. For example,
whenever you click on MagnetoCorp within the <code>Fabric Gateway</code> section,
it will automatically use the <code>MagnetoCorpWallet</code> wallet without
prompting you.</p>
<p><strong>18.</strong> Do the same thing for DigiBank. <code>Right click</code> on <code>DigiBank</code>
within the <code>Fabric Gateways</code> section. Then select <code>Associate A Wallet</code>.
Then it will prompt you for which wallet to associate with this gateway.
You will want to select <code>DigiBankWallet</code>.</p>
<p><strong>19.</strong> To confirm that we have done this successfully, you can click on
both gateways. You'll see the identities it is using once you connect to
a specific gateway. To disconnect from a gateway, there is a <code>door</code> in
the <code>Fabric Gateways</code> section in which you can click on to leave.</p>
<p><img alt="image" src="../vscode-images/2-4-19.1.png" /></p>
<p><img alt="image" src="../vscode-images/2-4-19.2.png" /></p>
<p><strong>20.</strong> Now that we have our gateways figured out, let's do another
lifecycle of a commercial paper. To do this, we need to do an <code>issue</code>
transaction. First click on the <code>MagnetoCorp</code> gateway and untoggle till
you see the transactions within the <code>papercontract@0</code>. From there,
<code>right click</code> on the <code>issue</code> transaction and select
<code>Submit Transaction</code>. Within the brackets, place the text below:</p>
<div class="codehilite"><pre><span></span><code><span class="err">&quot;MagnetoCorp&quot;, &quot;00002&quot;, &quot;2020-05-31&quot;, &quot;2020-11-30&quot;, &quot;5000000&quot;</span>
</code></pre></div>

<p>You can hit enter again to bypass the next prompt asking for transient
data. That will execute the transaction and issue paper <code>00002</code></p>
<p><strong>21.</strong> To make sure we are all operating on the same paper number, we
need to change a few files. I have broken down the files we need to
change below within VSCode in the Editor perspective.</p>
<p>From <code>digibank/application</code> folder, within the <code>getPaper.js</code> file
on line <code>68</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="k">const</span> <span class="n">getPaperResponse</span> <span class="o">=</span> <span class="n">await</span> <span class="n">contract</span><span class="o">.</span><span class="n">evaluateTransaction</span><span class="p">(</span><span class="s1">&#39;getPaper&#39;</span><span class="p">,</span> <span class="s1">&#39;MagnetoCorp&#39;</span><span class="p">,</span> <span class="s1">&#39;00001&#39;</span><span class="p">);</span>

<span class="o">----</span> <span class="n">CHANGE</span> <span class="n">TO</span> <span class="o">----</span>

<span class="k">const</span> <span class="n">getPaperResponse</span> <span class="o">=</span> <span class="n">await</span> <span class="n">contract</span><span class="o">.</span><span class="n">evaluateTransaction</span><span class="p">(</span><span class="s1">&#39;getPaper&#39;</span><span class="p">,</span> <span class="s1">&#39;MagnetoCorp&#39;</span><span class="p">,</span> <span class="s1">&#39;00002&#39;</span><span class="p">);</span>
</code></pre></div>

<p><strong>Make sure you save this file.</strong></p>
<p>From <code>`digibank/application</code> folder, within the <code>redeem.js</code> file on
line <code>67</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="k">const</span> <span class="n">redeemResponse</span> <span class="o">=</span> <span class="n">await</span> <span class="n">contract</span><span class="o">.</span><span class="n">submitTransaction</span><span class="p">(</span><span class="s1">&#39;redeem&#39;</span><span class="p">,</span> <span class="s1">&#39;MagnetoCorp&#39;</span><span class="p">,</span> <span class="s1">&#39;00001&#39;</span><span class="p">,</span> <span class="s1">&#39;DigiBank&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-11-30&#39;</span><span class="p">);</span>

<span class="o">----</span> <span class="n">CHANGE</span> <span class="n">TO</span> <span class="o">----</span>

<span class="k">const</span> <span class="n">redeemResponse</span> <span class="o">=</span> <span class="n">await</span> <span class="n">contract</span><span class="o">.</span><span class="n">submitTransaction</span><span class="p">(</span><span class="s1">&#39;redeem&#39;</span><span class="p">,</span> <span class="s1">&#39;MagnetoCorp&#39;</span><span class="p">,</span> <span class="s1">&#39;00002&#39;</span><span class="p">,</span> <span class="s1">&#39;DigiBank&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-11-30&#39;</span><span class="p">);</span>
</code></pre></div>

<p><strong>Make sure you save this file.</strong></p>
<p><strong>22.</strong> Now we can execute more transactions. First, jump back to the
CLI and do a <code>getPaper.js</code> transaction. Below you will see what the
command is to execute the transaction. <strong>NOTE:</strong> scroll over to see the entire command below:</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/digibank/application$ node getPaper.js</span>
<span class="err">Connect to Fabric gateway.</span>
<span class="err">Use network channel: mychannel.</span>
<span class="err">Use org.papernet.commercialpaper smart contract.</span>
<span class="err">Submit commercial paper getPaper transaction.</span>
<span class="err">Process getPaper transaction response.</span>
<span class="err"> +--------- Paper Retrieved ---------+ </span>
<span class="err"> | Paper number: &quot;00002&quot;</span>
<span class="err"> | Paper is owned by: &quot;MagnetoCorp&quot;</span>
<span class="err"> | Paper is currently: &quot;ISSUED&quot;</span>
<span class="err"> | Paper face value: &quot;5000000&quot;</span>
<span class="err"> | Paper is issued by: &quot;MagnetoCorp&quot;</span>
<span class="err"> | Paper issue on: &quot;2020-05-31&quot;</span>
<span class="err"> | Paper matures on: &quot;2020-11-30&quot;</span>
<span class="err"> +-----------------------------------+ </span>
<span class="err">Transaction complete.</span>
<span class="err">Disconnect from Fabric gateway.</span>
<span class="err">getPaper program complete.</span>
</code></pre></div>

<p><strong>23.</strong> Within VSCode and the IBM Blockchain Platform, we can buy the
same paper. To do this, leave the <code>MagnetoCorp</code> gateway, and then click on the
<code>DigiBank</code> gateway.</p>
<p><strong>24.</strong> Now, untoggle till you see the <code>buy</code> transaction within the
<code>papercontract@0</code> smart contract. From there, <code>right click</code> on the <code>buy</code>
transaction and select <code>Submit Transaction</code>. Once it gives you a prompt,
enter the text below between the brackets:</p>
<div class="codehilite"><pre><span></span><code><span class="err">&quot;MagnetoCorp&quot;,&quot;00002&quot;,&quot;MagnetoCorp&quot;,&quot;DigiBank&quot;,&quot;4900000&quot;,&quot;2019-07-31&quot;</span>
</code></pre></div>

<p>Then hit <code>enter</code> to go to the next prompt. Hit <code>enter</code> once again to
bypass the transient data prompt. Then that will execute the <code>buy</code>
transaction.</p>
<p><strong>25.</strong> To confirm that the transaction worked (other than the log
messages in the output window), we can do a <code>getPaper</code> transaction from
the CLI again. <strong>NOTE:</strong> scroll over to see the entire command below:</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/digibank/application$ node getPaper.js</span>
<span class="err">Connect to Fabric gateway.</span>
<span class="err">Use network channel: mychannel.</span>
<span class="err">Use org.papernet.commercialpaper smart contract.</span>
<span class="err">Submit commercial paper getPaper transaction.</span>
<span class="err">Process getPaper transaction response.</span>
<span class="err">+--------- Paper Retrieved ---------+ </span>
<span class="err"> | Paper number: &quot;00002&quot;</span>
<span class="err"> | Paper is owned by: &quot;DigiBank&quot;</span>
<span class="err"> | Paper is currently: &quot;TRADING&quot;</span>
<span class="err"> | Paper face value: &quot;5000000&quot;</span>
<span class="err"> | Paper is issued by: &quot;MagnetoCorp&quot;</span>
<span class="err"> | Paper issue on: &quot;2020-05-31&quot;</span>
<span class="err"> | Paper matures on: &quot;2020-11-30&quot;</span>
<span class="err"> +-----------------------------------+ </span>
<span class="err">Transaction complete.</span>
<span class="err">Disconnect from Fabric gateway.</span>
<span class="err">getPaper program complete.</span>
</code></pre></div>

<p><strong>26.</strong> From the same CLI, we can do a <code>redeem.js</code> transaction. <strong>NOTE:</strong> scroll over to see the entire command below:</p>
<div class="codehilite"><pre><span></span><code><span class="n">tecadmin</span><span class="nv">@ubuntubase</span><span class="err">:</span><span class="o">~/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">samples</span><span class="o">/</span><span class="n">commercial</span><span class="o">-</span><span class="n">paper</span><span class="o">/</span><span class="n">organization</span><span class="o">/</span><span class="n">digibank</span><span class="o">/</span><span class="n">application</span><span class="err">$</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="n">redeem</span><span class="p">.</span><span class="n">js</span><span class="w"> </span>
<span class="k">Connect</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">Fabric</span><span class="w"> </span><span class="n">gateway</span><span class="p">.</span><span class="w"></span>
<span class="k">Use</span><span class="w"> </span><span class="n">network</span><span class="w"> </span><span class="nl">channel</span><span class="p">:</span><span class="w"> </span><span class="n">mychannel</span><span class="p">.</span><span class="w"></span>
<span class="k">Use</span><span class="w"> </span><span class="n">org</span><span class="p">.</span><span class="n">papernet</span><span class="p">.</span><span class="n">commercialpaper</span><span class="w"> </span><span class="n">smart</span><span class="w"> </span><span class="n">contract</span><span class="p">.</span><span class="w"></span>
<span class="n">Submit</span><span class="w"> </span><span class="n">commercial</span><span class="w"> </span><span class="n">paper</span><span class="w"> </span><span class="n">redeem</span><span class="w"> </span><span class="k">transaction</span><span class="p">.</span><span class="w"></span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">28</span><span class="nl">T19</span><span class="p">:</span><span class="mi">52</span><span class="err">:</span><span class="mf">46.452</span><span class="n">Z</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nl">info</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">TransactionEventHandler</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="nl">_strategySuccess</span><span class="p">:</span><span class="w"> </span><span class="n">strategy</span><span class="w"> </span><span class="n">success</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">transaction</span><span class="w"> </span><span class="ss">&quot;c26ecbf1077d99a5ea025c339ffabd88eb22cf4e6ac5ff8d9b570cd6c38eb531&quot;</span><span class="w"></span>
<span class="n">Process</span><span class="w"> </span><span class="n">redeem</span><span class="w"> </span><span class="k">transaction</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="w"></span>
<span class="n">MagnetoCorp</span><span class="w"> </span><span class="n">commercial</span><span class="w"> </span><span class="n">paper</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="mi">00002</span><span class="w"> </span><span class="n">successfully</span><span class="w"> </span><span class="n">redeemed</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">MagnetoCorp</span><span class="w"></span>
<span class="k">Transaction</span><span class="w"> </span><span class="n">complete</span><span class="p">.</span><span class="w"></span>
<span class="k">Disconnect</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">Fabric</span><span class="w"> </span><span class="n">gateway</span><span class="p">.</span><span class="w"></span>
<span class="n">Redeem</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">complete</span><span class="p">.</span><span class="w"></span>
</code></pre></div>

<p><strong>27.</strong> Again, we can confirm that this was recorded by doing another
<code>getPaper.js</code> transaction. <strong>NOTE:</strong> scroll over to see the entire
command below:</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/digibank/application$ node getPaper.js</span>
<span class="err">Connect to Fabric gateway.</span>
<span class="err">Use network channel: mychannel.</span>
<span class="err">Use org.papernet.commercialpaper smart contract.</span>
<span class="err">Submit commercial paper getPaper transaction.</span>
<span class="err">Process getPaper transaction response.</span>
<span class="err"> +--------- Paper Retrieved ---------+ </span>
<span class="err"> | Paper number: &quot;00002&quot;</span>
<span class="err"> | Paper is owned by: &quot;MagnetoCorp&quot;</span>
<span class="err"> | Paper is currently: &quot;REDEEMED&quot;</span>
<span class="err"> | Paper face value: &quot;5000000&quot;</span>
<span class="err"> | Paper is issued by: &quot;MagnetoCorp&quot;</span>
<span class="err"> | Paper issue on: &quot;2020-05-31&quot;</span>
<span class="err"> | Paper matures on: &quot;2020-11-30&quot;</span>
<span class="err"> +-----------------------------------+ </span>
<span class="err">Transaction complete.</span>
<span class="err">Disconnect from Fabric gateway.</span>
<span class="err">getPaper program complete.</span>
</code></pre></div>

<h1 id="section-6-lab-clean-up">Section 6: Lab Clean-Up<a class="headerlink" href="#section-6-lab-clean-up" title="Permanent link">&para;</a></h1>
<p>This lab has run its course, but now it is time to clean up. Don't worry, this is a very short section! </p>
<p><strong>1.</strong> Entering the following commands to stop and remove our docker containers. Then we can remove the images as well. Look at the following commands below
::</p>
<div class="codehilite"><pre><span></span><code><span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/digibank/application$ docker stop $(docker ps -a -q)</span>
<span class="err">*</span>
<span class="err">*</span>
<span class="err">* Docker container IDs</span>
<span class="err">*</span>
<span class="err">*</span>
<span class="err">tecadmin@ubuntubase:~/Desktop/fabric-samples-cp/commercial-paper/organization/digibank/application$ docker rm $(docker ps -a -q)</span>
<span class="err">*</span>
<span class="err">*</span>
<span class="err">* Docker container IDs</span>
<span class="err">*</span>
<span class="err">*</span>
</code></pre></div>

<p><strong>2.</strong> From within the IBM Blockchain Platform Extension in VSCode, find the <code>Local Fabric Ops</code> section and hover your cursor in that section. Within that section, click on the three dots (<code>...</code>) in the top right. Then select <code>Teardown Fabric Runtime</code>. This will clear the local Fabric cleanly.</p>
<p><strong>3.</strong> Once that has ran its course, click on the three dots (<code>...</code>) and select <code>Start Fabric Runtime</code>. This will start up a new local Fabric that we will use in the next part of the lab. </p>
<p>That's it!</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="../assets/javascripts/bundle.9554a270.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>