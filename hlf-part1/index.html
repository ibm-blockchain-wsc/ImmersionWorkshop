
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.2">
    
    
      
        <title>Hlf part1 - Blockchain Immersion Workshop</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f72e892.min.css">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#section-1-overview-of-hyperledger-fabric-smart-contract-installation-lab-part-1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="Blockchain Immersion Workshop" class="md-header-nav__button md-logo" aria-label="Blockchain Immersion Workshop">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Blockchain Immersion Workshop
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Hlf part1
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/ibm-blockchain-wsc/ImmersionWorkshop.git" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Blockchain Immersion Workshop" class="md-nav__button md-logo" aria-label="Blockchain Immersion Workshop">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Blockchain Immersion Workshop
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ibm-blockchain-wsc/ImmersionWorkshop.git" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../assignment/" class="md-nav__link">
      Skytap image assignments
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      IBM Blockchain Platform v2.5.0 on Linux on IBM Z Lab
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="IBM Blockchain Platform v2.5.0 on Linux on IBM Z Lab" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        IBM Blockchain Platform v2.5.0 on Linux on IBM Z Lab
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ibpconsole/" class="md-nav__link">
      Part 1 - Create a Blockchain Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ibpdeploy/" class="md-nav__link">
      Part 2 - Deploy Smart Contract
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../references/" class="md-nav__link">
      Additional Resources
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="section-1-overview-of-hyperledger-fabric-smart-contract-installation-lab-part-1">Section 1 - Overview of Hyperledger Fabric Smart Contract installation lab part 1<a class="headerlink" href="#section-1-overview-of-hyperledger-fabric-smart-contract-installation-lab-part-1" title="Permanent link">&para;</a></h1>
<p>In this lab, you will work with the Marbles demo application, which is
considered by many to be a de facto "hello world" application for
getting started with Hyperledger Fabric. Hyperledger Fabric is one of
several projects within the open-source Hyperledger collaborative effort
hosted by the Linux Foundation. Hyperledger Fabric provides the
distributed ledger, a.k.a. blockchain, technology that is the core of
IBM Blockchain solutions and services.</p>
<p>Below is a diagram that depicts the blockchain network you will build and operate:</p>
<p><img alt="Marbles HLF Network" src="../images/marbles-hlf-lab.png" /></p>
<p>You will use Docker Compose to bring up a Hyperledger Fabric network in
which two organizations will participate. There will be one orderer
service for the entire network, and each organization will use its own
certificate authority service and have two peer nodes. Each peer node
will use CouchDB for its ledger store. Each peer node's CouchDB will
run in a separate Docker container. That makes eleven Docker containers,
as follows:</p>
<ul>
<li>1 orderer service Docker container</li>
<li>2 certificate authority (CA) Docker containers (one for each
    organization)</li>
<li>4 peer node Docker containers (each of the two organizations has two
    peers)</li>
<li>4 CouchDB Docker containers (each peer node has its own separate
    CouchDB ledger store)</li>
</ul>
<p>You will also bring up a twelfth Docker container that we will call the
<em>cli</em> container. You will use it as a convenience to enter Hyperledger
Fabric commands targeted to specific peers. You will see how this is
done later in the lab.</p>
<p>The network you bring up will use Transport Layer Security (TLS) which
provides secure, encrypted communications between the peer nodes and the
orderer, just as most production implementations will require.</p>
<p>You will <strong>install</strong> the Marbles chaincode on the peer nodes,
<strong>instantiate</strong> the chaincode, and <strong>invoke</strong> functions of the
chaincode. I will explain later in the lab the difference between the
install and instantiate actions and what each one does.</p>
<h1 id="section-2-description-of-the-subsequent-sections-in-part-1">Section 2 - Description of the subsequent sections in Part 1<a class="headerlink" href="#section-2-description-of-the-subsequent-sections-in-part-1" title="Permanent link">&para;</a></h1>
<p>This section provides a brief description of the subsequent sections in Part 1 of the
lab, where you will get hands-on experience with the Hyperledger Fabric
command line interface (CLI). In most production implementations you
would perform many of these functions through other means, such as
programmatically through an Application Programming Interface (API)
provided by a Hyperledger Fabric Software Development Kit (SDK), which
the project provides for the Node.js, Java, Golang and Python
programming languages, or perhaps through a user interface such as the
one provided by the IBM Blockchain Platform. But using the CLI, as you
will in this lab, is a great way to learn about how Hyperledger Fabric
works.</p>
<ol>
<li>You will extract the artifacts necessary to run the lab in
    Section 3. All the artifacts necessary for the lab are provided in a
    compressed tarball- in essence, a zip file.</li>
<li>You will use Docker Compose in Section 4 to bring up the twelve
    Docker containers that comprise the Hyperledger Fabric network. You
    will see that all twelve Docker containers that I mentioned in
    Section 1 are brought up with a single <em>docker-compose</em> command, and
    I will explain some of the more interesting bits of what is going on
    under the covers.</li>
<li>You will create a channel in the Hyperledger Fabric network in
    Section 5. In Hyperledger Fabric, each channel is essentially its
    own blockchain.</li>
<li>You will instruct each peer node to join the channel in Section 6.
    We will join all four Peer nodes to the channel. Peer nodes can be
    members of more than one channel, but for this lab you are only
    creating one channel.</li>
<li>You will define an "anchor" peer for each organization in the
    channel in Section 7. An anchor peer for an organization is a peer
    that is known by all the other organizations in a channel. Not all
    peers for an organization need to be known by outside organizations.
    Peers not defined as anchor peers are visible only within their own
    organization.</li>
<li>You will install the chaincode on the peer nodes in Section 8.
    Installing chaincode simply puts the chaincode executable on the
    file system of the peer. It is a necessary step before you execute
    that chaincode on the peer, but the next step is also required.</li>
<li>You will instantiate the chaincode on the channel in Section 9. This
    step is a prerequisite to being able to run chaincode on a channel.
    It only needs to be performed on one peer that is a member of the
    channel. This causes a transaction to be recorded on the channel's
    blockchain to indicate that the chaincode can be run on the channel.</li>
<li>You will invoke functions on the chaincode that will create, read,
    update and delete (CRUD) data stored on the blockchain in
    Section 10. Blocks of transactions in a blockchain are always added
    (i.e., created), and they can be read, but they are never, in normal
    operations, updated or deleted. However, although the blocks in a
    chain are not updated or deleted, the transactions themselves
    operate on Key/Value pairs that can have all CRUD operations
    performed on them. This collection of Key/Value pairs is often
    referred to as state data.</li>
</ol>
<h1 id="section-3-extract-the-artifacts-necessary-to-run-the-lab">Section 3 - Extract the artifacts necessary to run the lab<a class="headerlink" href="#section-3-extract-the-artifacts-necessary-to-run-the-lab" title="Permanent link">&para;</a></h1>
<p>Log in to your assigned Linux on Z Ubuntu instance with the instructions
provided to you by your class instructor. If you are using Linux or
MacOS you will likely be using <em>ssh</em> to log in via a <em>Terminal</em> window.
If you are using Windows, you will most likely be using a <em>PuTTY</em>
terminal session. If you are trying this lab at home, I am assuming you
can figure out how to log in.</p>
<p>All of the following instructions in the lab assume that you have
successfully logged in to the Linux on Z Ubuntu instance assigned to
your team. As you proceed through the lab, you will have to be logged in
to more than one terminal session. When that becomes necessary, simply
follow the same procedure used to log in to your first terminal session.</p>
<p>Let's get started!</p>
<p><strong>Step 3.1:</strong> Navigate to the home directory by entering <em>cd ~</em> (the
"tilde" character, i.e., '<em>~</em>', represents the user's home directory in
Linux). This directory is also usually set in the $HOME environment
variable, so <em>cd $HOME</em> will also usually get you to your home
directory:</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~$ cd ~</span>
<span class="err">bcuser@ubuntu18042:~$</span>
</code></pre></div>

<p><em>Note:</em> You may already be in your home directory prior to entering <em>cd
~</em>, in which case you'll just stay there- not a problem.</p>
<p><strong>Step 3.2:</strong> Retrieve the zmarbles compressed tarball prepared for this
lab with the following command:</p>
<div class="codehilite"><pre><span></span><code><span class="n">bcuser</span><span class="nv">@ubuntu18042</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"> </span><span class="n">wget</span><span class="w"> </span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">ibm</span><span class="o">-</span><span class="n">blockchain</span><span class="o">-</span><span class="n">wsc</span><span class="o">/</span><span class="n">ImmersionWorkshop</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">zmarbles</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span><span class="w"></span>
<span class="o">--</span><span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">57</span><span class="err">:</span><span class="mi">58</span><span class="o">--</span><span class="w">  </span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">ibm</span><span class="o">-</span><span class="n">blockchain</span><span class="o">-</span><span class="n">wsc</span><span class="o">/</span><span class="n">ImmersionWorkshop</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">zmarbles</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span><span class="w"></span>
<span class="n">Resolving</span><span class="w"> </span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="p">(</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="p">)...</span><span class="w"> </span><span class="mf">151.101.200.133</span><span class="w"></span>
<span class="n">Connecting</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="p">(</span><span class="n">raw</span><span class="p">.</span><span class="n">githubusercontent</span><span class="p">.</span><span class="n">com</span><span class="p">)</span><span class="o">|</span><span class="mf">151.101.200.133</span><span class="o">|</span><span class="err">:</span><span class="mf">443.</span><span class="p">..</span><span class="w"> </span><span class="n">connected</span><span class="p">.</span><span class="w"></span>
<span class="n">HTTP</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">sent</span><span class="p">,</span><span class="w"> </span><span class="n">awaiting</span><span class="w"> </span><span class="n">response</span><span class="p">...</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">OK</span><span class="w"></span>
<span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">10272273</span><span class="w"> </span><span class="p">(</span><span class="mf">9.8</span><span class="n">M</span><span class="p">)</span><span class="w"> </span><span class="o">[</span><span class="n">application/octet-stream</span><span class="o">]</span><span class="w"></span>
<span class="n">Saving</span><span class="w"> </span><span class="k">to</span><span class="err">:</span><span class="w"> </span><span class="s1">&#39;zmarbles.tar.gz&#39;</span><span class="w"></span>

<span class="n">zmarbles</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span><span class="w">                </span><span class="mi">100</span><span class="o">%[</span><span class="n">===================================================&gt;</span><span class="o">]</span><span class="w">   </span><span class="mf">9.80</span><span class="n">M</span><span class="w">  </span><span class="o">--</span><span class="p">.</span><span class="o">-</span><span class="n">KB</span><span class="o">/</span><span class="n">s</span><span class="w">    </span><span class="ow">in</span><span class="w"> </span><span class="mf">0.1</span><span class="n">s</span><span class="w"></span>

<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span><span class="w"> </span><span class="mi">14</span><span class="err">:</span><span class="mi">57</span><span class="err">:</span><span class="mi">58</span><span class="w"> </span><span class="p">(</span><span class="mf">77.3</span><span class="w"> </span><span class="n">MB</span><span class="o">/</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="s1">&#39;zmarbles.tar.gz&#39;</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="o">[</span><span class="n">10272273/10272273</span><span class="o">]</span><span class="w"></span>

<span class="n">bcuser</span><span class="nv">@ubuntu18042</span><span class="err">:</span><span class="o">~</span><span class="err">$</span><span class="w"></span>
</code></pre></div>

<p><strong>Step 3.3:</strong> The <em>zmarbles</em> directory should not yet exist. Prove it
with this <em>ls</em> command:</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~$ ls zmarbles </span>
<span class="c">ls: cannot access &#39;zmarbles&#39;: No such file or directory</span>
<span class="err">bcuser@ubuntu18042:~$</span>
</code></pre></div>

<p><strong>Step 3.4:</strong> Extract the <em>zmarbles.tar.gz</em> file which will create the
missing directory (and lots of subdirectories). If you want to see the
name of all of the files and directories that are extracted, add the
"<em>v</em>" switch into the options in the command below. That is, use <em>-xzvf</em>
instead of <em>-xzf</em>. So, enter the <em>tar</em> command below as shown, feeling
free to substitute <em>-xzvf</em> for <em>-xzf</em> in the command (the "<em>v</em>" is for
"<em>verbose</em>") :</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~$ tar -xzf zmarbles.tar.gz</span>
<span class="err">bcuser@ubuntu18042:~$</span>
</code></pre></div>

<p><strong>Step 3.5:</strong> List the <em>zmarbles</em> directory with this command:</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~$ ls -l zmarbles</span>
<span class="err">total 64</span>
<span class="err">drwxr-xr-x 2 bcuser bcuser  4096 Apr 16 11:54 base</span>
<span class="err">drwxrwxr-x 2 bcuser bcuser  4096 Jan 14 07:54 bin</span>
<span class="err">drwxr-xr-x 2 bcuser bcuser  4096 Apr 16 12:24 channel-artifacts</span>
<span class="err">drwxrwxr-x 2 bcuser bcuser  4096 Jul  3  2018 config</span>
<span class="err">-rw-r--r-- 1 bcuser bcuser 12209 Jul 30  2018 configtx.yaml</span>
<span class="err">-rw-r--r-- 1 bcuser bcuser  4175 Jul 30  2018 crypto-config.yaml</span>
<span class="err">-rw-r--r-- 1 bcuser bcuser  6304 Apr 16 11:54 docker-compose-template.yaml</span>
<span class="err">drwxr-xr-x 3 bcuser bcuser  4096 Jun 18  2017 examples</span>
<span class="err">-rwxr-xr-x 1 bcuser bcuser  3587 Sep 24  2018 generateArtifacts.sh</span>
<span class="err">drwxr-xr-x 2 bcuser bcuser  4096 Oct  1  2017 hostScripts</span>
<span class="err">drwxrwxr-x 9 bcuser bcuser  4096 Apr 16 12:24 marblesUI</span>
<span class="err">drwxr-xr-x 2 bcuser bcuser  4096 Jan 19 14:58 scripts</span>
<span class="err">bcuser@ubuntu18042:~$</span>
</code></pre></div>

<p>An explanation of the purpose of each of these files and directories is
given here:</p>
<p>The <em>base</em> directory contains Docker Compose files that are included in
the <em>docker-compose-template.yaml</em> file with the <em>extends</em> directive.</p>
<p>The <em>bin</em> directory contains two executable programs, <em>cryptogen</em> and
<em>configtxgen</em>, that will be run later when you execute the
<em>generateArtifacts.sh</em> script.</p>
<p>The <em>channel-artifacts</em> directory is empty, but it must exist when the
<em>generateArtifacts.sh</em> script, which you will run later, invokes the
<em>configtxgen</em> utility. The <em>configtxgen</em> utility generates input to
channel configuration transactions, and it is expecting the
<em>channel-artifacts</em> directory to exist.</p>
<p>The <em>configtx.yaml</em> file is input to the <em>configtxgen</em> utility</p>
<p>The <em>cryto-config.yaml</em> file is input to the <em>cryptogen</em> utiity, which
is called by the <em>generateArtifacts.sh</em> script to create cryptographic
material (in the form of X.509 certificates and public and private key
pairs) used to identify peers, orderers, and administrative and regular
users of a Hyperledger Fabric network.</p>
<p>The <em>docker-compose-template.yaml</em> file is used as a template file that
the <em>generateArtifacts.sh</em> script will use to create the main Docker
Compose template file, <em>docker-compose.yaml</em>, which contains definitions
for all of the Docker containers that you will need.</p>
<p>The <em>examples</em> directory contains the actual Marbles chaincode within
its subdirectory structure.</p>
<p>The <em>generateArtifacts.sh</em> script is used to generate channel
configuration transaction input and to generate cryptographic material
and it also creates <em>docker-compose.yaml</em>, using
<em>docker-compose-template.yaml</em> as input.</p>
<p>The <em>hostScripts</em> directory is not used in this lab.</p>
<p>The <em>marblesUI</em> directory is used in Part 2 of this lab, in which you will be
working with the browser-based user interface (UI) for Marbles.</p>
<p>The <em>scripts</em> directory contains a script named <em>setpeer</em> that you will
be using throughout this lab from within the <em>cli</em> Docker container.
<em>setpeer</em> will be explained in <em>Section 5</em>.   </p>
<h1 id="section-4-bring-up-the-twelve-docker-containers-that-comprise-the-hyperledger-fabric-network">Section 4 - Bring up the twelve Docker containers that comprise the Hyperledger Fabric network<a class="headerlink" href="#section-4-bring-up-the-twelve-docker-containers-that-comprise-the-hyperledger-fabric-network" title="Permanent link">&para;</a></h1>
<p><strong>Step 4.1:</strong> Change to the <em>zmarbles</em> directory with the <em>cd</em> command:</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~$ cd zmarbles/ </span>
<span class="err">bcuser@ubuntu18042:~/zmarbles$</span>
</code></pre></div>

<p><strong>Step 4.2:</strong> You are going to run a script named <em>generateArtifacts.sh</em>
that will create some configuration information that is necessary to get
your Hyperledger Fabric network set up. There is one optional parameter
you may pass to the script, and that is the name of the channel you will
be creating. If you do not specify this parameter, the channel name
defaults to <em>mychannel</em>. You may choose to specify your own channel
name. E.g., if you wished to name your channel <em>tim</em>, then you would
enter <em>./generateArtifacts.sh tim</em> instead of just
<em>./generateArtifacts.sh</em> when directed below to enter the command.</p>
<div class="admonition warning">
<p class="admonition-title">Warning<p>If you pick your own channel name, it must start with a lowercase character, and only contain lowercase characters, numbers, or the dash ('-') character, or the period ('.').</p>
</p>
</div>
<p>So, enter the command below, optionally specifying a custom channel name
(not shown here) as the lone argument to the <em>generateArtifacts.sh</em>
script:</p>
<div class="codehilite"><pre><span></span><code><span class="n">bcuser</span><span class="err">@</span><span class="n">ubuntu18042</span><span class="p">:</span><span class="o">~/</span><span class="n">zmarbles</span><span class="o">$</span> <span class="n">source</span> <span class="o">./</span><span class="n">generateArtifacts</span><span class="o">.</span><span class="n">sh</span>    <span class="c1"># specify a custom channel name or accept the default value of &#39;mychannel&#39;</span>

<span class="n">Using</span> <span class="n">cryptogen</span> <span class="o">-&gt;</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bcuser</span><span class="o">/</span><span class="n">zmarbles</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">cryptogen</span>

<span class="c1">##########################################################</span>
<span class="c1">##### Generate certificates using cryptogen tool #########</span>
<span class="c1">##########################################################</span>
<span class="n">unitedmarbles</span><span class="o">.</span><span class="n">com</span>
<span class="n">marblesinc</span><span class="o">.</span><span class="n">com</span>

<span class="n">Using</span> <span class="n">configtxgen</span> <span class="o">-&gt;</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bcuser</span><span class="o">/</span><span class="n">zmarbles</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">configtxgen</span>
<span class="c1">##########################################################</span>
<span class="c1">#########  Generating Orderer Genesis block ##############</span>
<span class="c1">##########################################################</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">07.988</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="p">]</span> <span class="n">main</span> <span class="o">-&gt;</span> <span class="n">WARN</span> <span class="mi">001</span> <span class="n">Omitting</span> <span class="n">the</span> <span class="n">channel</span> <span class="n">ID</span> <span class="k">for</span> <span class="n">configtxgen</span> <span class="k">for</span> <span class="n">output</span> <span class="n">operations</span> <span class="k">is</span> <span class="n">deprecated</span><span class="o">.</span>  <span class="n">Explicitly</span> <span class="n">passing</span> <span class="n">the</span> <span class="n">channel</span> <span class="n">ID</span> <span class="n">will</span> <span class="n">be</span> <span class="n">required</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">future</span><span class="p">,</span> <span class="n">defaulting</span> <span class="n">to</span> <span class="s1">&#39;testchainid&#39;</span><span class="o">.</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">07.988</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="p">]</span> <span class="n">main</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">002</span> <span class="n">Loading</span> <span class="n">configuration</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.000</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="o">.</span><span class="n">localconfig</span><span class="p">]</span> <span class="n">completeInitialization</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">003</span> <span class="n">orderer</span> <span class="n">type</span><span class="p">:</span> <span class="n">solo</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.000</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="o">.</span><span class="n">localconfig</span><span class="p">]</span> <span class="n">Load</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">004</span> <span class="n">Loaded</span> <span class="n">configuration</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bcuser</span><span class="o">/</span><span class="n">zmarbles</span><span class="o">/</span><span class="n">configtx</span><span class="o">.</span><span class="n">yaml</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.012</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="o">.</span><span class="n">localconfig</span><span class="p">]</span> <span class="n">completeInitialization</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">005</span> <span class="n">orderer</span> <span class="n">type</span><span class="p">:</span> <span class="n">solo</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.012</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="o">.</span><span class="n">localconfig</span><span class="p">]</span> <span class="n">LoadTopLevel</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">006</span> <span class="n">Loaded</span> <span class="n">configuration</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bcuser</span><span class="o">/</span><span class="n">zmarbles</span><span class="o">/</span><span class="n">configtx</span><span class="o">.</span><span class="n">yaml</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.013</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="p">]</span> <span class="n">doOutputBlock</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">007</span> <span class="n">Generating</span> <span class="n">genesis</span> <span class="n">block</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.014</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="p">]</span> <span class="n">doOutputBlock</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">008</span> <span class="n">Writing</span> <span class="n">genesis</span> <span class="n">block</span>

<span class="c1">#################################################################</span>
<span class="c1">### Generating channel configuration transaction &#39;channel.tx&#39; ###</span>
<span class="c1">#################################################################</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.077</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="p">]</span> <span class="n">main</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">001</span> <span class="n">Loading</span> <span class="n">configuration</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.088</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="o">.</span><span class="n">localconfig</span><span class="p">]</span> <span class="n">Load</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">002</span> <span class="n">Loaded</span> <span class="n">configuration</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bcuser</span><span class="o">/</span><span class="n">zmarbles</span><span class="o">/</span><span class="n">configtx</span><span class="o">.</span><span class="n">yaml</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.102</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="o">.</span><span class="n">localconfig</span><span class="p">]</span> <span class="n">completeInitialization</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">003</span> <span class="n">orderer</span> <span class="n">type</span><span class="p">:</span> <span class="n">solo</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.102</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="o">.</span><span class="n">localconfig</span><span class="p">]</span> <span class="n">LoadTopLevel</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">004</span> <span class="n">Loaded</span> <span class="n">configuration</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bcuser</span><span class="o">/</span><span class="n">zmarbles</span><span class="o">/</span><span class="n">configtx</span><span class="o">.</span><span class="n">yaml</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.102</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="p">]</span> <span class="n">doOutputChannelCreateTx</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">005</span> <span class="n">Generating</span> <span class="n">new</span> <span class="n">channel</span> <span class="n">configtx</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.102</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="o">.</span><span class="n">encoder</span><span class="p">]</span> <span class="n">NewChannelGroup</span> <span class="o">-&gt;</span> <span class="n">WARN</span> <span class="mi">006</span> <span class="n">Default</span> <span class="n">policy</span> <span class="n">emission</span> <span class="k">is</span> <span class="n">deprecated</span><span class="p">,</span> <span class="n">please</span> <span class="n">include</span> <span class="n">policy</span> <span class="n">specifications</span> <span class="k">for</span> <span class="n">the</span> <span class="n">channel</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">configtx</span><span class="o">.</span><span class="n">yaml</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.103</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="o">.</span><span class="n">encoder</span><span class="p">]</span> <span class="n">NewChannelGroup</span> <span class="o">-&gt;</span> <span class="n">WARN</span> <span class="mi">007</span> <span class="n">Default</span> <span class="n">policy</span> <span class="n">emission</span> <span class="k">is</span> <span class="n">deprecated</span><span class="p">,</span> <span class="n">please</span> <span class="n">include</span> <span class="n">policy</span> <span class="n">specifications</span> <span class="k">for</span> <span class="n">the</span> <span class="n">channel</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">configtx</span><span class="o">.</span><span class="n">yaml</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.104</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="p">]</span> <span class="n">doOutputChannelCreateTx</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">008</span> <span class="n">Writing</span> <span class="n">new</span> <span class="n">channel</span> <span class="n">tx</span>

<span class="c1">#################################################################</span>
<span class="c1">#######    Generating anchor peer update for Org0MSP   ##########</span>
<span class="c1">#################################################################</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.170</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="p">]</span> <span class="n">main</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">001</span> <span class="n">Loading</span> <span class="n">configuration</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.181</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="o">.</span><span class="n">localconfig</span><span class="p">]</span> <span class="n">Load</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">002</span> <span class="n">Loaded</span> <span class="n">configuration</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bcuser</span><span class="o">/</span><span class="n">zmarbles</span><span class="o">/</span><span class="n">configtx</span><span class="o">.</span><span class="n">yaml</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.193</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="o">.</span><span class="n">localconfig</span><span class="p">]</span> <span class="n">completeInitialization</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">003</span> <span class="n">orderer</span> <span class="n">type</span><span class="p">:</span> <span class="n">solo</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.193</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="o">.</span><span class="n">localconfig</span><span class="p">]</span> <span class="n">LoadTopLevel</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">004</span> <span class="n">Loaded</span> <span class="n">configuration</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bcuser</span><span class="o">/</span><span class="n">zmarbles</span><span class="o">/</span><span class="n">configtx</span><span class="o">.</span><span class="n">yaml</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.193</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="p">]</span> <span class="n">doOutputAnchorPeersUpdate</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">005</span> <span class="n">Generating</span> <span class="n">anchor</span> <span class="n">peer</span> <span class="n">update</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.193</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="p">]</span> <span class="n">doOutputAnchorPeersUpdate</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">006</span> <span class="n">Writing</span> <span class="n">anchor</span> <span class="n">peer</span> <span class="n">update</span>

<span class="c1">#################################################################</span>
<span class="c1">#######    Generating anchor peer update for Org1MSP   ##########</span>
<span class="c1">#################################################################</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.255</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="p">]</span> <span class="n">main</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">001</span> <span class="n">Loading</span> <span class="n">configuration</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.266</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="o">.</span><span class="n">localconfig</span><span class="p">]</span> <span class="n">Load</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">002</span> <span class="n">Loaded</span> <span class="n">configuration</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bcuser</span><span class="o">/</span><span class="n">zmarbles</span><span class="o">/</span><span class="n">configtx</span><span class="o">.</span><span class="n">yaml</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.277</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="o">.</span><span class="n">localconfig</span><span class="p">]</span> <span class="n">completeInitialization</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">003</span> <span class="n">orderer</span> <span class="n">type</span><span class="p">:</span> <span class="n">solo</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.278</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="o">.</span><span class="n">localconfig</span><span class="p">]</span> <span class="n">LoadTopLevel</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">004</span> <span class="n">Loaded</span> <span class="n">configuration</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">bcuser</span><span class="o">/</span><span class="n">zmarbles</span><span class="o">/</span><span class="n">configtx</span><span class="o">.</span><span class="n">yaml</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.278</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="p">]</span> <span class="n">doOutputAnchorPeersUpdate</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">005</span> <span class="n">Generating</span> <span class="n">anchor</span> <span class="n">peer</span> <span class="n">update</span>
<span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span> <span class="mi">15</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mf">08.278</span> <span class="n">EDT</span> <span class="p">[</span><span class="n">common</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">configtxgen</span><span class="p">]</span> <span class="n">doOutputAnchorPeersUpdate</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mi">006</span> <span class="n">Writing</span> <span class="n">anchor</span> <span class="n">peer</span> <span class="n">update</span>

<span class="n">bcuser</span><span class="err">@</span><span class="n">ubuntu18042</span><span class="p">:</span><span class="o">~/</span><span class="n">zmarbles</span><span class="o">$</span>
</code></pre></div>

<p>This script calls two Hyperledger Fabric utilites- <em>cryptogen</em>, which
creates security material (certificates and keys) and <em>configtxgen</em>
(Configuration Transaction Generator), which is called four times, to
create four things:</p>
<ol>
<li>An <strong>orderer genesis block</strong> -- this will be the first block on the
    orderer's system channel. The location of this block is specified to
    the Orderer when it is started up via the
    ORDERER_GENERAL_GENESISFILE environment variable.</li>
<li>A <strong>channel transaction</strong> -- later in the lab, this is sent to the
    orderer and will cause a new channel to be created when you run the
    <strong>peer channel create</strong> command.</li>
<li>An <strong>anchor peer update</strong> for Org0MSP. An anchor peer is a peer that
    is set up so that peers from other organizations may communicate
    with it. The concept of anchor peers allows an organization to
    create multiple peers, perhaps to provide extra capacity or
    throughput or resilience (or all the above) but not have to
    advertise this to outside organizations.</li>
<li>An anchor peer update for Org1MSP. You will perform the anchor peer
    updates for both Org0MSP and Org1MSP later in the lab via <strong>peer
    channel create</strong> commands.</li>
</ol>
<p><strong>Step 4.3:</strong> Issue the following command which will show you all files
that were created by the <em>configtxgen</em> utility when it was called from
inside <em>generateArtifacts.sh</em>:</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~/zmarbles$ ls -ltr channel-artifacts</span>
<span class="err">total 28</span>
<span class="err">-rw-r--r-- 1 bcuser bcuser 12995 Apr 28 15:01 genesis.block</span>
<span class="err">-rw-r--r-- 1 bcuser bcuser   346 Apr 28 15:01 channel.tx</span>
<span class="err">-rw-r--r-- 1 bcuser bcuser   285 Apr 28 15:01 Org0MSPanchors.tx</span>
<span class="err">-rw-r--r-- 1 bcuser bcuser   282 Apr 28 15:01 Org1MSPanchors.tx</span>
<span class="err">bcuser@ubuntu18042:~/zmarbles$</span>
</code></pre></div>

<p><em>genesis.block</em> will be passed to the <em>orderer</em> at startup, and will be
used to configure the orderer's <em>system channel</em>. This file contains
the x.509 signing certificates for every organization defined within the
consortia that were specified within the <em>configtx.yaml</em> file when
<em>configtxgen</em> was run. The <em>system channel</em> contains other values such
as parameters defining when a block of transactions is cut- e.g., based
on time, number of transactions, or block size- and these values serve
as a template, that is, as defaults, for any additional channels that
might be created, if a new channel creation request does not provide its
own custom values.</p>
<p><em>channel.tx</em> is the input for a configuration transaction that will
create a channel. You will use this as input to a <em>peer channel create</em>
request in <em>Section 5</em>.</p>
<p><em>Org0MSPanchors.tx</em> and <em>Org1MSPanchors.tx</em> are inputs for configuration
transactions that will define an anchor peer for <em>Org0</em> and <em>Org1</em>
respectively. You will use these inputs in <em>Section 7</em>.</p>
<p><strong>Step 4.4:</strong> Issue the following command which will show you all files
that were created by the <em>cryptogen</em> utility when it was called from
inside <em>generateArtifacts.sh</em>. This command will show one screen at a
time and pause- press the space bar to scroll to the end, that is,
until you get your command prompt back:</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~/zmarbles$ ls -ltrR crypto-config | more</span>
<span class="err">  .</span>
<span class="err">  .  (output not shown here)</span>
<span class="err">  .</span>
</code></pre></div>

<p>Actually, these files were created <em>before</em> the files listed in the
prior step, <em>Step 4.3</em>, were created, because, among the many
cryptographic artifacts created are the x.509 signing certificates for
the organizations, which are baked into the <em>genesis.block</em> discussed in
the prior step.</p>
<p>You can see that there is a dizzying set of directories and files,
containing things like CA root certificates, signing certificates, TLS
certificates, corresponding private keys, and public keys, for
certificate authorities, organizations, administrative and general
users. A thorough discussion of them is beyond the scope of this lab.</p>
<div class="admonition note">
<p class="admonition-title">Note<p>This utiltity created crypto material for both organizations, including private keys that each organization would keep secret and never share with the other organizations. You have created this for both organizations on a single server for purposes of this lab, but in a production implementation each organization would create their own material separately so that they could indeed keep their private keys to themselves. Their public certificates, which are meant to be shared, are baked into the channel definitions for channels in which they participate. This allows peer nodes from all organizations in a channel to verify digital signatures of transaction requests and transaction endorsements from other organizations that are members of the channel.</p>
</p>
</div>
<p><strong>Step 4.5:</strong> You are going to look inside the Docker Compose
configuration file a little bit. Enter the following command:</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~/zmarbles$ vi -R docker-compose.yaml</span>
</code></pre></div>

<p>You can enter <code>Ctrl-f</code> to scroll forward in the file and <code>Ctrl-b</code> to
scroll back in the file. The <em>-R</em> flag opens the file in read-only mode,
so if you accidentally change something in the file, it's okay. It will
not be saved.</p>
<p>The statements within <em>docker-compose.yaml</em> are in a markup language
called <em>YAML</em>, which stands for <em>Y</em>et <em>A</em>nother <em>M</em>arkup <em>L</em>anguage.
(Who says nerds do not have a sense of humor). We will go over some
highlights here.</p>
<p>There are twelve "services", or Docker containers, defined within this
file. They all start in column 3 and have several statements to describe
them. For example, the first service defined is <strong>ca0</strong>, and there are
<em>image</em>, <em>environment</em>, <em>ports</em>, <em>command</em>, <em>volumes</em>, and
<em>container_name</em> statements that describe it. If you scroll down in the
file with <code>Ctrl-f</code> you will see all the services. Not every service has
the same statements describing it.</p>
<p>The twelve services are:</p>
<p><strong>ca0</strong> -- The certificate authority service for "Organization 0"
(unitedmarbles.com)</p>
<p><strong>ca1</strong> -- The certificate authority service for "Organization 1"
(marblesinc.com)</p>
<p><strong>orderer.blockchain.com</strong> -- The single ordering service that both
organizations will use</p>
<p><strong>peer0.unitedmarbles.com</strong> -- The first peer node for "Organization 0"</p>
<p><strong>peer1.unitedmarbles.com</strong> -- The second peer node for "Organization 0"</p>
<p><strong>peer0.marblesinc.com</strong> -- The first peer node for "Organization 1"</p>
<p><strong>peer1.marblesinc.com</strong> -- The second peer node for "Organization 1"</p>
<p><strong>couchdb0</strong> -- The CouchDB server for peer0.unitedmarbles.com</p>
<p><strong>couchdb1</strong> -- The CouchDB server for peer1.unitedmarbles.com</p>
<p><strong>couchdb2</strong> -- The CouchDB server for peer0.marblesinc.com</p>
<p><strong>couchdb3</strong> -- The CouchDB server for peer1.marblesinc.com</p>
<p><strong>cli</strong> -- The Docker container from which you will enter Hyperledger
Fabric command line interface (CLI) commands targeted towards a peer
node.</p>
<p>I will describe how several statements work within the file, but time
does not permit me to address every single line in the file!</p>
<p><em>image</em> statements define which Docker image file the Docker container
will be created from. Basically, the Docker image file is a static file
that, once created, is read-only. A Docker container is based on a
Docker image, and any changes to the file system within a Docker
container are stored within the container. So, multiple Docker
containers can be based on the same Docker image, and each Docker
container keeps track of its own changes. For example, the containers
built for the <strong>ca0</strong> and <strong>ca1</strong> service will both be based on the
<em>hyperledger/fabric-ca:1.4.1</em> Docker image because they both have this
statement in their definition:</p>
<div class="codehilite"><pre><span></span><code><span class="n">image</span><span class="o">:</span> <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">ca</span><span class="o">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>
</code></pre></div>

<p><em>environment</em> statements define environment variables that are available
to the Docker container. The Hyperledger Fabric processes make ample use
of environment variables. In general, you will see that the certificate
authority environment variables start with <em>FABRIC_CA</em>, the orderer's
environment variables start with <em>ORDERER_GENERAL</em>, and the peer node's
environment variables start with <em>CORE</em>. These variables control
behavior of the Hyperledger Fabric code, and, in many cases, will
override values that are specified in configuration files. 
All the peers and the orderer have an environment variable to specify
that TLS is enabled- <em>CORE_PEER_TLS_ENABLED=true</em> for the peers and
<em>ORDERER_GENERAL_TLS_ENABLED=true</em> for the orderer. You will notice
there are other TLS-related variables to specify private keys,
certificates and root certificates.</p>
<div class="admonition note">
<p class="admonition-title">Note<p>Most of the TLS-related environment variables for the peer and orderer are specified in separate files that are brought in via the <em>extends</em> statement. Specifically, <em>base/docker-compose.yaml</em> for the orderer and <em>base/peer-base.yaml</em> for the peers. We'll discuss the <em>extends</em> statement shortly.</p>
</p>
</div>
<p><em>ports</em> statements map ports on our Linux on IBM Z host to ports within
the Docker container. The syntax is <em>&lt;host port&gt;:&lt;Docker container port&gt;</em>. 
For example, the service for <strong>ca1</strong> has this port statement:</p>
<div class="codehilite"><pre><span></span><code><span class="c">ports:</span>
<span class="c">  - &quot;8054:7054&quot;</span>
</code></pre></div>

<p>This says that port 7054 in the Docker container for the <strong>ca1</strong> node
will be mapped to port 8054 on your Linux on IBM Z host. This is how you
can run two CA nodes in two Docker containers and four peer nodes in
four Docker containers and keep things straight- within each CA node
they are both using port 7054, and within each peer node Docker
container, they are all using port 7051 for the same thing, but if you
want to get to one of the peers from your host or even the outside
world, you would target the appropriate host-mapped port. <strong>Note:</strong> To
see the port mappings for the peers you have to look in
<em>base/docker-compose.yaml</em>. See if you can figure out why.</p>
<p><em>container_name</em> statements are used to create hostnames that the
Docker containers spun up by the docker-compose command use to
communicate with each other. A separate, private network will be created
by Docker where the 12 Docker containers can communicate with each other
via the names specified by <em>container_name</em>. So, they do not need to
worry about the port mappings from the <em>ports</em> statements- those are
used for trying to get to the Docker containers from outside the private
network created by Docker.</p>
<p><em>volumes</em> statements are used to map file systems on the host to file
systems within the Docker container. Just like with ports, the file
system on the host system is on the left and the file system name mapped
within the Docker container is on the right. For example, look at this
statement from the <strong>ca0</strong> service:</p>
<div class="codehilite"><pre><span></span><code><span class="c">volumes:</span>
<span class="c">  - ./crypto-config/peerOrganizations/unitedmarbles.com/ca/:/etc/hyperledger/fabric-ca-server-config</span>
</code></pre></div>

<p>The security-related files that were created from the previous step
where you ran <em>generateArtifacts.sh</em> were all within the <em>crypto-config</em>
directory on your Linux on IBM Z host. The prior <em>volumes</em> statement is
how this stuff is made accessible to the <strong>ca0</strong> service that will run
within the Docker container. Similar magic is done for the other
services as well, except for the CouchDB services.</p>
<p><em>extends</em> statements are used by the peer nodes. What this does is merge
in other statements from another file. For example, you may notice that
the peer nodes do not contain an images statement. How does Docker know
what Docker image file to base the container on? That is defined in the
file, <em>base/peer-base.yaml</em>, specified in the <em>extends</em> section of
<em>base/docker-compose.yaml</em>, which is specified in the <em>extends</em> section
of <em>docker-compose.yaml</em> for the peer nodes. </p>
<p><em>command</em> statements define what command is run when the Docker
container is started. This is how the actual Hyperledger Fabric
processes get started. You can define default commands when you create
the Docker image. This is why you do not see <em>command</em> statements for
the <strong>cli</strong> service or for the CouchDB services. For the peer nodes, the
command statement is specified in the <em>base/peer-base.yaml</em> file.</p>
<p><em>working_dir</em> statements define what directory the Docker container
will be in when its startup commands are run. Again, defaults for this
can be defined when the Docker image is created.</p>
<p>When you are done reviewing the <em>docker-compose.yaml</em> file, exit the
<em>vi</em> session by typing <code>:q!</code> (that's "colon", "q", "exclamation point")
which will exit the file and discard any changes you may have
accidentally made while browsing through the file. If <code>:q!</code> doesn't work
right away, you may have to hit the escape key first before trying it.
If that still doesn't work, ask an instructor for help- <em>vi</em> can be
tricky if you are not used to it.</p>
<p>If you would like to see what is in the <em>base/docker-compose-base.yaml</em>
and <em>base/peer-base.yaml</em> files I mentioned, take a quick peek with
<code>vi -R base/docker-compose-base.yaml</code> and <code>vi -R base/peer-base.yaml</code>
and exit with the <code>:q!</code> key sequence when you have had enough.</p>
<p><strong>Step 4.6:</strong> Start the Hyperledger Fabric network by entering the
command shown below:</p>
<div class="codehilite"><pre><span></span><code><span class="n">bcuser</span><span class="err">@</span><span class="n">ubuntu18042</span><span class="p">:</span><span class="o">~/</span><span class="n">zmarbles</span><span class="o">$</span> <span class="n">docker</span><span class="o">-</span><span class="n">compose</span> <span class="n">up</span> <span class="o">--</span><span class="n">detach</span>
<span class="n">Creating</span> <span class="n">network</span> <span class="s2">&quot;zmarbles_default&quot;</span> <span class="n">with</span> <span class="n">the</span> <span class="n">default</span> <span class="n">driver</span>
<span class="n">Pulling</span> <span class="n">orderer</span><span class="o">.</span><span class="n">blockchain</span><span class="o">.</span><span class="n">com</span> <span class="p">(</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">orderer</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span><span class="o">...</span>
<span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span><span class="p">:</span> <span class="n">Pulling</span> <span class="n">from</span> <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">orderer</span>
<span class="mi">39653445334</span><span class="n">d</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="mi">329</span><span class="n">bdf3df601</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="n">e1af42922173</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="mi">4</span><span class="n">b9e5154055d</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="mi">8</span><span class="n">ed6225295fd</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="mi">11</span><span class="n">c7fddfdc0f</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="n">Pulling</span> <span class="n">ca1</span> <span class="p">(</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">ca</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span><span class="o">...</span>
<span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span><span class="p">:</span> <span class="n">Pulling</span> <span class="n">from</span> <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">ca</span>
<span class="mi">39653445334</span><span class="n">d</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="mi">329</span><span class="n">bdf3df601</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="n">e1af42922173</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="n">a5b6cc1abc77</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="mi">1</span><span class="n">d0fabac8892</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="mi">6</span><span class="n">eae46c3b75a</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="n">ce86d957bb82</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="n">a089155eb52f</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="n">Pulling</span> <span class="n">ca0</span> <span class="p">(</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">ca</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span><span class="o">...</span>
<span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span><span class="p">:</span> <span class="n">Pulling</span> <span class="n">from</span> <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">ca</span>
<span class="n">Pulling</span> <span class="n">couchdb0</span> <span class="p">(</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">couchdb</span><span class="p">:</span><span class="n">s390x</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">15</span><span class="p">)</span><span class="o">...</span>
<span class="n">s390x</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">15</span><span class="p">:</span> <span class="n">Pulling</span> <span class="n">from</span> <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">couchdb</span>
<span class="mi">39653445334</span><span class="n">d</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="mi">329</span><span class="n">bdf3df601</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="n">e1af42922173</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="mi">38375</span><span class="n">a01635c</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="n">e0c199f48fe8</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="mi">32</span><span class="n">ba5a82959e</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="mf">7e91</span><span class="n">f8f93642</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="mi">17039674</span><span class="n">b6c5</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="mi">2</span><span class="n">ff3f86b6c77</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="n">ce5364742c8c</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="mf">8202e4590853</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="mi">2</span><span class="n">f293014c84a</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="mf">9779e3</span><span class="n">b3aa0f</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="n">c78880840b57</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="mi">66</span><span class="n">b99fceb3c4</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="n">abe937827dde</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="n">ad4c12835ee0</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="n">Pulling</span> <span class="n">peer0</span><span class="o">.</span><span class="n">unitedmarbles</span><span class="o">.</span><span class="n">com</span> <span class="p">(</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">peer</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span><span class="o">...</span>
<span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span><span class="p">:</span> <span class="n">Pulling</span> <span class="n">from</span> <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">peer</span>
<span class="mi">39653445334</span><span class="n">d</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="mi">329</span><span class="n">bdf3df601</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="n">e1af42922173</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="mi">4</span><span class="n">b9e5154055d</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="mi">22</span><span class="n">c8eabb9c48</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="n">b536383fde82</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="n">Pulling</span> <span class="n">cli</span> <span class="p">(</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">tools</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span><span class="p">)</span><span class="o">...</span>
<span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span><span class="p">:</span> <span class="n">Pulling</span> <span class="n">from</span> <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">tools</span>
<span class="mi">39653445334</span><span class="n">d</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="mi">329</span><span class="n">bdf3df601</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="n">e1af42922173</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="mi">38375</span><span class="n">a01635c</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="n">e0c199f48fe8</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="mi">32</span><span class="n">ba5a82959e</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="mf">7e91</span><span class="n">f8f93642</span><span class="p">:</span> <span class="n">Already</span> <span class="n">exists</span>
<span class="mi">5</span><span class="n">bcfc5abd027</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="mi">3</span><span class="n">ff8871c88b1</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="mi">9</span><span class="n">a7a331d670e</span><span class="p">:</span> <span class="n">Pull</span> <span class="n">complete</span>
<span class="n">Creating</span> <span class="n">couchdb0</span>               <span class="o">...</span> <span class="n">done</span>
<span class="n">Creating</span> <span class="n">orderer</span><span class="o">.</span><span class="n">blockchain</span><span class="o">.</span><span class="n">com</span>  <span class="o">...</span> <span class="n">done</span>
<span class="n">Creating</span> <span class="n">couchdb3</span>                <span class="o">...</span> <span class="n">done</span>
<span class="n">Creating</span> <span class="n">ca_Org1</span>                 <span class="o">...</span> <span class="n">done</span>
<span class="n">Creating</span> <span class="n">couchdb2</span>                <span class="o">...</span> <span class="n">done</span>
<span class="n">Creating</span> <span class="n">ca_Org0</span>                 <span class="o">...</span> <span class="n">done</span>
<span class="n">Creating</span> <span class="n">couchdb1</span>                <span class="o">...</span> <span class="n">done</span>
<span class="n">Creating</span> <span class="n">peer0</span><span class="o">.</span><span class="n">unitedmarbles</span><span class="o">.</span><span class="n">com</span> <span class="o">...</span> <span class="n">done</span>
<span class="n">Creating</span> <span class="n">peer1</span><span class="o">.</span><span class="n">marblesinc</span><span class="o">.</span><span class="n">com</span>    <span class="o">...</span> <span class="n">done</span>
<span class="n">Creating</span> <span class="n">peer1</span><span class="o">.</span><span class="n">unitedmarbles</span><span class="o">.</span><span class="n">com</span> <span class="o">...</span> <span class="n">done</span>
<span class="n">Creating</span> <span class="n">peer0</span><span class="o">.</span><span class="n">marblesinc</span><span class="o">.</span><span class="n">com</span>    <span class="o">...</span> <span class="n">done</span>
<span class="n">Creating</span> <span class="n">cli</span>                     <span class="o">...</span> <span class="n">done</span>
<span class="n">bcuser</span><span class="err">@</span><span class="n">ubuntu18042</span><span class="p">:</span><span class="o">~/</span><span class="n">zmarbles</span><span class="o">$</span>
</code></pre></div>

<p><strong>Note:</strong> Depending upon the circumstances under which you run this lab,
the Hyperledger Fabric Docker images required may already exist on your system, in which case you may not observe
the messages shown above that show the progress of the downloads.</p>
<p><strong>Step 4.7:</strong> Verify that all twelve services are <em>Up</em> and none of them
say <em>Exited</em>. The <em>Exited</em> status means something went wrong, and you
should check with an instructor for help if you see any of them in
<em>Exited</em> status.</p>
<p>If, however, all twelve of your Docker containers are in <em>Up</em> status, as
in the output below, you are ready to proceed to the next section:</p>
<div class="codehilite"><pre><span></span><code><span class="n">bcuser</span><span class="err">@</span><span class="n">ubuntu18042</span><span class="p">:</span><span class="o">~/</span><span class="n">zmarbles</span><span class="o">$</span> <span class="n">docker</span> <span class="n">ps</span> <span class="o">--</span><span class="n">all</span>
<span class="n">CONTAINER</span> <span class="n">ID</span>        <span class="n">IMAGE</span>                                     <span class="n">COMMAND</span>                  <span class="n">CREATED</span>             <span class="n">STATUS</span>              <span class="n">PORTS</span>                                                                       <span class="n">NAMES</span>
<span class="mi">84</span><span class="n">b6c0ee74aa</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">tools</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>            <span class="s2">&quot;bash&quot;</span>                   <span class="mi">2</span> <span class="n">minutes</span> <span class="n">ago</span>       <span class="n">Up</span> <span class="mi">2</span> <span class="n">minutes</span>                                                                                    <span class="n">cli</span>
<span class="n">e6eabd9fd96d</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">peer</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>             <span class="s2">&quot;peer node start&quot;</span>        <span class="mi">2</span> <span class="n">minutes</span> <span class="n">ago</span>       <span class="n">Up</span> <span class="mi">2</span> <span class="n">minutes</span>        <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">9051</span><span class="o">-&gt;</span><span class="mi">7051</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">9052</span><span class="o">-&gt;</span><span class="mi">7052</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">9053</span><span class="o">-&gt;</span><span class="mi">7053</span><span class="o">/</span><span class="n">tcp</span>      <span class="n">peer0</span><span class="o">.</span><span class="n">marblesinc</span><span class="o">.</span><span class="n">com</span>
<span class="mi">8174</span><span class="n">f3021744</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">peer</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>             <span class="s2">&quot;peer node start&quot;</span>        <span class="mi">2</span> <span class="n">minutes</span> <span class="n">ago</span>       <span class="n">Up</span> <span class="mi">2</span> <span class="n">minutes</span>        <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8051</span><span class="o">-&gt;</span><span class="mi">7051</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8052</span><span class="o">-&gt;</span><span class="mi">7052</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8053</span><span class="o">-&gt;</span><span class="mi">7053</span><span class="o">/</span><span class="n">tcp</span>      <span class="n">peer1</span><span class="o">.</span><span class="n">unitedmarbles</span><span class="o">.</span><span class="n">com</span>
<span class="mi">1</span><span class="n">a22b9eb5be5</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">peer</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>             <span class="s2">&quot;peer node start&quot;</span>        <span class="mi">2</span> <span class="n">minutes</span> <span class="n">ago</span>       <span class="n">Up</span> <span class="mi">2</span> <span class="n">minutes</span>        <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">10051</span><span class="o">-&gt;</span><span class="mi">7051</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">10052</span><span class="o">-&gt;</span><span class="mi">7052</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">10053</span><span class="o">-&gt;</span><span class="mi">7053</span><span class="o">/</span><span class="n">tcp</span>   <span class="n">peer1</span><span class="o">.</span><span class="n">marblesinc</span><span class="o">.</span><span class="n">com</span>
<span class="mi">11423</span><span class="n">ca89763</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">peer</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>             <span class="s2">&quot;peer node start&quot;</span>        <span class="mi">2</span> <span class="n">minutes</span> <span class="n">ago</span>       <span class="n">Up</span> <span class="mi">2</span> <span class="n">minutes</span>        <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">7051</span><span class="o">-</span><span class="mi">7053</span><span class="o">-&gt;</span><span class="mi">7051</span><span class="o">-</span><span class="mi">7053</span><span class="o">/</span><span class="n">tcp</span>                                            <span class="n">peer0</span><span class="o">.</span><span class="n">unitedmarbles</span><span class="o">.</span><span class="n">com</span>
<span class="mi">18</span><span class="n">b9e5efbfc9</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">couchdb</span><span class="p">:</span><span class="n">s390x</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">15</span>   <span class="s2">&quot;tini -- /docker-ent…&quot;</span>   <span class="mi">2</span> <span class="n">minutes</span> <span class="n">ago</span>       <span class="n">Up</span> <span class="mi">2</span> <span class="n">minutes</span>        <span class="mi">4369</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mi">9100</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">6984</span><span class="o">-&gt;</span><span class="mi">5984</span><span class="o">/</span><span class="n">tcp</span>                                  <span class="n">couchdb1</span>
<span class="mi">77288</span><span class="n">f8c0060</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">couchdb</span><span class="p">:</span><span class="n">s390x</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">15</span>   <span class="s2">&quot;tini -- /docker-ent…&quot;</span>   <span class="mi">2</span> <span class="n">minutes</span> <span class="n">ago</span>       <span class="n">Up</span> <span class="mi">2</span> <span class="n">minutes</span>        <span class="mi">4369</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mi">9100</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">7984</span><span class="o">-&gt;</span><span class="mi">5984</span><span class="o">/</span><span class="n">tcp</span>                                  <span class="n">couchdb2</span>
<span class="mi">43214</span><span class="n">da184da</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">ca</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>               <span class="s2">&quot;sh -c &#39;fabric-ca-se…&quot;</span>   <span class="mi">2</span> <span class="n">minutes</span> <span class="n">ago</span>       <span class="n">Up</span> <span class="mi">2</span> <span class="n">minutes</span>        <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">7054</span><span class="o">-&gt;</span><span class="mi">7054</span><span class="o">/</span><span class="n">tcp</span>                                                      <span class="n">ca_Org0</span>
<span class="mi">1</span><span class="n">ea639c77a3a</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">ca</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>               <span class="s2">&quot;sh -c &#39;fabric-ca-se…&quot;</span>   <span class="mi">2</span> <span class="n">minutes</span> <span class="n">ago</span>       <span class="n">Up</span> <span class="mi">2</span> <span class="n">minutes</span>        <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8054</span><span class="o">-&gt;</span><span class="mi">7054</span><span class="o">/</span><span class="n">tcp</span>                                                      <span class="n">ca_Org1</span>
<span class="mi">07</span><span class="n">df27e35368</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">couchdb</span><span class="p">:</span><span class="n">s390x</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">15</span>   <span class="s2">&quot;tini -- /docker-ent…&quot;</span>   <span class="mi">2</span> <span class="n">minutes</span> <span class="n">ago</span>       <span class="n">Up</span> <span class="mi">2</span> <span class="n">minutes</span>        <span class="mi">4369</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mi">9100</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8984</span><span class="o">-&gt;</span><span class="mi">5984</span><span class="o">/</span><span class="n">tcp</span>                                  <span class="n">couchdb3</span>
<span class="mf">93e0465394</span><span class="n">b6</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">orderer</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>          <span class="s2">&quot;orderer&quot;</span>                <span class="mi">2</span> <span class="n">minutes</span> <span class="n">ago</span>       <span class="n">Up</span> <span class="mi">2</span> <span class="n">minutes</span>        <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">7050</span><span class="o">-&gt;</span><span class="mi">7050</span><span class="o">/</span><span class="n">tcp</span>                                                      <span class="n">orderer</span><span class="o">.</span><span class="n">blockchain</span><span class="o">.</span><span class="n">com</span>
<span class="mi">4201915</span><span class="n">cc3b2</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">couchdb</span><span class="p">:</span><span class="n">s390x</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">15</span>   <span class="s2">&quot;tini -- /docker-ent…&quot;</span>   <span class="mi">2</span> <span class="n">minutes</span> <span class="n">ago</span>       <span class="n">Up</span> <span class="mi">2</span> <span class="n">minutes</span>        <span class="mi">4369</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mi">9100</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">5984</span><span class="o">-&gt;</span><span class="mi">5984</span><span class="o">/</span><span class="n">tcp</span>                                  <span class="n">couchdb0</span>
<span class="n">bcuser</span><span class="err">@</span><span class="n">ubuntu18042</span><span class="p">:</span><span class="o">~/</span><span class="n">zmarbles</span><span class="o">$</span>
</code></pre></div>

<p><strong>Step 4.8:</strong> Try this variant of the <em>docker ps</em> command that uses the <em>--format</em>* option to show only a subset of the information shown in the previous caommand:</p>
<div class="codehilite"><pre><span></span><code><span class="x">bcuser@ubuntu18042:~/zmarbles$ docker ps --all --format &#39;</span><span class="cp">{{</span><span class="nv">.Names</span><span class="cp">}}</span><span class="x">\t\t </span><span class="cp">{{</span><span class="nv">.Status</span><span class="cp">}}</span><span class="x">&#39;</span>
<span class="x">cli      Up About a minute</span>
<span class="x">peer1.unitedmarbles.com      Up About a minute</span>
<span class="x">peer0.marblesinc.com         Up About a minute</span>
<span class="x">peer0.unitedmarbles.com      Up 2 minutes</span>
<span class="x">peer1.marblesinc.com         Up About a minute</span>
<span class="x">couchdb1         Up About a minute</span>
<span class="x">couchdb2         Up About a minute</span>
<span class="x">ca_Org1      Up 2 minutes</span>
<span class="x">ca_Org0      Up 2 minutes</span>
<span class="x">orderer.blockchain.com       Up 2 minutes</span>
<span class="x">couchdb3         Up 2 minutes</span>
<span class="x">couchdb0         Up 2 minutes</span>
</code></pre></div>

<h1 id="section-5-create-a-channel-in-the-hyperledger-fabric-network">Section 5 - Create a channel in the Hyperledger Fabric network<a class="headerlink" href="#section-5-create-a-channel-in-the-hyperledger-fabric-network" title="Permanent link">&para;</a></h1>
<p>In a Hyperledger Fabric v1.4.1 network, multiple channels can be created.
Each channel can have its own policies for things such as requirements
for endorsement and what organizations may join the channel. This allows
for a subset of network participants to participate in their own
channel.</p>
<p>Imagine a scenario where OrgA, OrgB and OrgC are three organizations
participating in the network. You could set up a channel in which all
three organizations participate. You could also set up a channel where
only OrgA and OrgB participate. In this case, the peers in OrgC would
not see the transactions occurring in that channel. OrgA could
participate in another channel with only OrgC, in which case OrgB does
not have visibility. And so on.</p>
<p>You could create channels with the same participants, but have different
policies. For example, perhaps one channel with OrgA, OrgB, and OrgC
could require all three organizations to endorse a transaction proposal,
but another channel with OrgA, OrgB and OrgC could require just two, or
even just one, of the three organizations to endorse a transaction
proposal.</p>
<div class="admonition note">
<p class="admonition-title">Note<p>A use case where only one organization would need to endorse a transaction proposal would be unusual, as the whole point of blockchain is for multiple organizations to agree on what is valid transaction, and allowing just one organization to consider a transaction valid sort of goes against the grain of that type of thinking, but I never say never (oops! I just said it twice) but it is technically possible. Most trust models would probably call for a majority, a super-majority (e.g.  two-thirds), or even unanimous consent (100%) of the organizations in the channel to endorse a transaction proposal.</p>
</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note<p>A policy of requiring unanimous consent implies that each member organization should build an available and resilient infrastructure since if even one organization's peers are unavailable, then additions to the blockchain for that channel would grind to a halt.  Then again, who runs in production without an available and resilient infrastructure anyway?</p>
</p>
</div>
<p>The decision on how many channels to create and what policies they have
will usually be driven by the requirements of the particular business
problem being solved.</p>
<p><strong>Step 5.1:</strong> Access the <em>cli</em> Docker container:</p>
<div class="codehilite"><pre><span></span><code><span class="n">bcuser</span><span class="p">@</span><span class="nl">ubuntu18042</span><span class="p">:</span><span class="o">~/</span><span class="n">zmarbles$</span> <span class="n">docker</span> <span class="n">exec</span> <span class="o">--</span><span class="n">interactive</span> <span class="o">--</span><span class="n">tty</span> <span class="n">cli</span> <span class="n">bash</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p>Observe that your command prompt changes when you enter the Docker
container's shell.</p>
<p>The <em>docker exec</em> command runs a command against an existing Docker
container. The <em>--interactive</em> and <em>--tty</em> arguments basically work
together to say, "we want an interactive terminal session with this
Docker container". <em>cli</em> is the name of the Docker container (this came
from the <em>container_name</em> statement in the <em>docker-compose.yaml</em> file
for the <em>cli</em> service). <em>bash</em> is the name of the command you want to
enter. In other words, you are entering a Bash shell within the <em>cli</em>
Docker container. For most of the rest of the lab, you will be entering
commands within this Bash shell.</p>
<p>Instead of working as user <em>bcuser</em> on the ubuntu18042 server in the
<em>~/zmarbles</em> directory, you are now inside the Docker container with ID
<em>aaaaf5aa2798</em> (your ID will differ), working in the
<em>/opt/gopath/src/github.com/hyperledger/fabric/peer</em> directory. It is no
coincidence that that directory is the value of the <em>working_dir</em>
statement for the <em>cli</em> service in your <em>docker-compose.yaml</em> file.</p>
<p><strong>Step 5.2:</strong> There is no command to enter in this step, but read this explanation of convenience script that you will use repeatedly to point to a
particular peer from the <em>cli</em> Docker container. Within the <em>cli</em>
container, a convenience script named <em>setpeer</em> is provided in the
<em>scripts</em> subdirectory of your current working directory. This script
will set the environment variables to the values necessary to point to a
particular peer. The script takes two arguments. The first argument is
either 0 or 1 for Organization 0 or Organization 1 respectively, and the
second argument is for either Peer 0 or Peer 1 of the organization
selected by the first argument. Therefore, throughout the remainder of
this lab, before sending commands to a peer, you will enter one of the
following four valid combinations from within the <em>cli</em> Docker
container, depending on which peer you want to run the command on:</p>
<p><em>source scripts/setpeer 0 0</em> # to target Org 0, peer 0
(peer0.unitedmarbles.com)</p>
<p><em>source scripts/setpeer 0 1</em> # to target Org 0, peer 1 (peer1.united
marbles.com)</p>
<p><em>source scripts/setpeer 1 0</em> # to target Org 1, peer 0
(peer0.marblesinc.com)</p>
<p><em>source scripts/setpeer 1 1</em> # to target Org 1, peer 1
(peer1.marblesinc.com)</p>
<p><strong>Step 5.3:</strong> Choose your favorite peer and use one of the four <em>source
scripts/setpeer</em> commands listed in the prior step. Although you are
going to join all four peers to our channel, you only need to issue the
channel creation command once. You can issue it from any of the four
peers, so pick your favorite peer and issue the source command. In this
screen snippet, I have chosen Org 1, peer 1. Issue the command below,
leaving the arguments '1 1' as is, or change it to one of the other
valid combinations as described in the previous step:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">source</span> <span class="n">scripts</span><span class="o">/</span><span class="n">setpeer</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="n">CORE_PEER_TLS_KEY_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">key</span>
<span class="n">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="n">Org1MSP</span>
<span class="n">CORE_PEER_TLS_ENABLED</span><span class="o">=</span><span class="nb">true</span>
<span class="n">CORE_PEER_TLS_CERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ID</span><span class="o">=</span><span class="n">cli</span>
<span class="n">CORE_PEER_MSPCONFIGPATH</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">Admin</span><span class="p">@</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">msp</span>
<span class="n">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer1</span><span class="p">.</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">ca</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ADDRESS</span><span class="o">=</span><span class="n">peer1</span><span class="p">.</span><span class="n">marblesinc</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7051</span>
<span class="n">CORE_VM_ENDPOINT</span><span class="o">=</span><span class="nl">unix</span><span class="p">:</span><span class="c1">///host/var/run/docker.sock</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p>The next to last environment variable listed, <em>CORE_PEER_ADDRESS</em>, determines
to which peer your commands will be routed.</p>
<p><strong>Step 5.4:</strong> The Hyperledger Fabric network is configured to require
TLS, so when you enter your peer commands, you need to add a flag that
indicates TLS is enabled, and you need to add an argument that points to
the root signer certificate of the certificate authority for the orderer
service.</p>
<p>Fortunately, an environment variable has been set for you within the CLI
container that sets the flag (<em>--tls</em> argument) and points to the
appropriate certificate (the <em>--cafile</em> argument) so that you can
simply pass both arguments by specifying the single short environment
variable name instead of having to enter the two arguments and the
tediously long argument value for <em>--cafile</em>.</p>
<p>Enter this command now to see the value of this environment variable,
and thank me later for setting this up for you:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">echo</span> <span class="n">$FABRIC_TLS</span> 
<span class="o">--</span><span class="n">tls</span> <span class="o">--</span><span class="n">cafile</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">ordererOrganizations</span><span class="o">/</span><span class="n">blockchain</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">orderers</span><span class="o">/</span><span class="n">orderer</span><span class="p">.</span><span class="n">blockchain</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">msp</span><span class="o">/</span><span class="n">tlscacerts</span><span class="o">/</span><span class="n">tlsca</span><span class="p">.</span><span class="n">blockchain</span><span class="p">.</span><span class="n">com</span><span class="o">-</span><span class="n">cert</span><span class="p">.</span><span class="n">pem</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 5.5:</strong> Now enter this command:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">channel</span> <span class="n">create</span> <span class="o">-</span><span class="n">o</span> <span class="n">orderer</span><span class="p">.</span><span class="n">blockchain</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7050</span>  <span class="o">-</span><span class="n">f</span> <span class="n">channel</span><span class="o">-</span><span class="n">artifacts</span><span class="o">/</span><span class="n">channel</span><span class="p">.</span><span class="n">tx</span>  <span class="n">$FABRIC_TLS</span> <span class="o">-</span><span class="n">c</span> <span class="n">$CHANNEL_NAME</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="mf">13.144</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Endorser</span> <span class="n">and</span> <span class="n">orderer</span> <span class="n">connections</span> <span class="n">initialized</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">12</span><span class="o">:</span><span class="mf">13.180</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">cli</span><span class="p">.</span><span class="n">common</span><span class="p">]</span> <span class="n">readBlock</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">002</span> <span class="n">Received</span> <span class="nl">block</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p>The last line before you get your command prompt back will contain the
words "Received block: 0". This indicates that your channel creation
was successful, and the peer received the initial, or <em>genesis</em> block
for the channel, which is block 0. Programmers love to start counting
things at zero instead of one- it makes them feel special.</p>
<p>Proceed to the next section where you will join each peer to the
channel.   </p>
<h1 id="section-6-instruct-each-peer-node-to-join-the-channel">Section 6 - Instruct each peer node to join the channel<a class="headerlink" href="#section-6-instruct-each-peer-node-to-join-the-channel" title="Permanent link">&para;</a></h1>
<p>In the last section, you issued the <em>peer channel create</em> command from
one of the peers. Now any peer that you want to join the channel may
join- you will issue the <em>peer channel join</em> command from each peer.</p>
<p>For a peer to be eligible to join a channel, it must be a member of an
organization that is authorized to join the channel. When you created
your channel, you authorized <em>Org0MSP</em> and <em>Org1MSP</em> to join the
channel. Each of your four peers belongs to one of those two
organizations- two peers for each one- so they will be able to join
successfully. If someone from an organization other than <em>Org0MSP</em> or
<em>Org1MSP</em> attempted to join their peers to this channel, the attempt
would fail.</p>
<p>You are going to repeat the following steps for each of the four peer
nodes, in order to show that the peer successfully joined the channel:</p>
<ol>
<li>Use the <em>scripts/setpeer</em> script to point the CLI to the peer</li>
<li>Use the <em>peer channel list</em> command to show that the peer is not
    joined to any channels</li>
<li>Use the <em>peer channel join</em> command to join the peer to your channel</li>
<li>Use the <em>peer channel list</em> command again to see that the peer has
    joined your channel</li>
</ol>
<p><strong>Step 6.1:</strong> Point the <em>cli</em> to <em>peer0</em> for <em>Org0MSP</em>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">source</span> <span class="n">scripts</span><span class="o">/</span><span class="n">setpeer</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="n">CORE_PEER_TLS_KEY_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">key</span>
<span class="n">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="n">Org0MSP</span>
<span class="n">CORE_PEER_TLS_ENABLED</span><span class="o">=</span><span class="nb">true</span>
<span class="n">CORE_PEER_TLS_CERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ID</span><span class="o">=</span><span class="n">cli</span>
<span class="n">CORE_PEER_MSPCONFIGPATH</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">Admin</span><span class="p">@</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">msp</span>
<span class="n">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">ca</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ADDRESS</span><span class="o">=</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7051</span>
<span class="n">CORE_VM_ENDPOINT</span><span class="o">=</span><span class="nl">unix</span><span class="p">:</span><span class="c1">///host/var/run/docker.sock</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 6.2:</strong> Enter <em>peer channel list</em> and observe that no channels are
returned at the end of the output:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">channel</span> <span class="n">list</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">13</span><span class="o">:</span><span class="mf">27.080</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Endorser</span> <span class="n">and</span> <span class="n">orderer</span> <span class="n">connections</span> <span class="n">initialized</span>
<span class="n">Channels</span> <span class="n">peers</span> <span class="n">has</span> <span class="nl">joined</span><span class="p">:</span> 
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 6.3:</strong> Issue <em>peer channel join -b $CHANNEL_NAME.block</em> to join
the channel you set up when you ran <em>generateArtifacts.sh</em> a little
while ago. Among the many things that script did, it exported an
environment variable named $CHANNEL_NAME set to the channel name you
specified (or <em>mychannel</em> if you did not specify your own name), and
then the Docker Compose file is set up to pass this environment variable
to the <em>cli</em> container. If you are still on the happy path, your output
will look similar to this:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">channel</span> <span class="n">join</span> <span class="o">-</span><span class="n">b</span> <span class="n">$CHANNEL_NAME</span><span class="p">.</span><span class="n">block</span> 
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">13</span><span class="o">:</span><span class="mf">58.536</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Endorser</span> <span class="n">and</span> <span class="n">orderer</span> <span class="n">connections</span> <span class="n">initialized</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">13</span><span class="o">:</span><span class="mf">58.618</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">executeJoin</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">002</span> <span class="n">Successfully</span> <span class="n">submitted</span> <span class="n">proposal</span> <span class="n">to</span> <span class="n">join</span> <span class="n">channel</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 6.4:</strong> Repeat the <em>peer channel list</em> command and now you should
see your channel listed in the output:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">channel</span> <span class="n">list</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">14</span><span class="o">:</span><span class="mf">23.186</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Endorser</span> <span class="n">and</span> <span class="n">orderer</span> <span class="n">connections</span> <span class="n">initialized</span>
<span class="n">Channels</span> <span class="n">peers</span> <span class="n">has</span> <span class="nl">joined</span><span class="p">:</span> 
<span class="n">mychannel</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 6.5:</strong> Point the <em>cli</em> to <em>peer1</em> for <em>Org0MSP</em>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">source</span> <span class="n">scripts</span><span class="o">/</span><span class="n">setpeer</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="n">CORE_PEER_TLS_KEY_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">key</span>
<span class="n">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="n">Org0MSP</span>
<span class="n">CORE_PEER_TLS_ENABLED</span><span class="o">=</span><span class="nb">true</span>
<span class="n">CORE_PEER_TLS_CERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ID</span><span class="o">=</span><span class="n">cli</span>
<span class="n">CORE_PEER_MSPCONFIGPATH</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">Admin</span><span class="p">@</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">msp</span>
<span class="n">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer1</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">ca</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ADDRESS</span><span class="o">=</span><span class="n">peer1</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7051</span>
<span class="n">CORE_VM_ENDPOINT</span><span class="o">=</span><span class="nl">unix</span><span class="p">:</span><span class="c1">///host/var/run/docker.sock</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 6.6:</strong> Enter <em>peer channel list</em> and observe that no channels are
returned at the end of the output:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">channel</span> <span class="n">list</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">21.894</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Endorser</span> <span class="n">and</span> <span class="n">orderer</span> <span class="n">connections</span> <span class="n">initialized</span>
<span class="n">Channels</span> <span class="n">peers</span> <span class="n">has</span> <span class="nl">joined</span><span class="p">:</span> 
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 6.7:</strong> Issue <em>peer channel join -b $CHANNEL_NAME.block</em> to join
your channel. Your output should look similar to this:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">channel</span> <span class="n">join</span> <span class="o">-</span><span class="n">b</span> <span class="n">$CHANNEL_NAME</span><span class="p">.</span><span class="n">block</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">53.751</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Endorser</span> <span class="n">and</span> <span class="n">orderer</span> <span class="n">connections</span> <span class="n">initialized</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">53.851</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">executeJoin</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">002</span> <span class="n">Successfully</span> <span class="n">submitted</span> <span class="n">proposal</span> <span class="n">to</span> <span class="n">join</span> <span class="n">channel</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 6.8:</strong> Repeat the <em>peer channel list</em> command and now you should
see your channel listed:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">channel</span> <span class="n">list</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">16</span><span class="o">:</span><span class="mf">19.287</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Endorser</span> <span class="n">and</span> <span class="n">orderer</span> <span class="n">connections</span> <span class="n">initialized</span>
<span class="n">Channels</span> <span class="n">peers</span> <span class="n">has</span> <span class="nl">joined</span><span class="p">:</span> 
<span class="n">mychannel</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 6.9:</strong> Point the <em>cli</em> to <em>peer0</em> for <em>Org1MSP</em>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">source</span> <span class="n">scripts</span><span class="o">/</span><span class="n">setpeer</span> <span class="mi">1</span> <span class="mi">0</span>
<span class="n">CORE_PEER_TLS_KEY_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">key</span>
<span class="n">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="n">Org1MSP</span>
<span class="n">CORE_PEER_TLS_ENABLED</span><span class="o">=</span><span class="nb">true</span>
<span class="n">CORE_PEER_TLS_CERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ID</span><span class="o">=</span><span class="n">cli</span>
<span class="n">CORE_PEER_MSPCONFIGPATH</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">Admin</span><span class="p">@</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">msp</span>
<span class="n">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">ca</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ADDRESS</span><span class="o">=</span><span class="n">peer0</span><span class="p">.</span><span class="n">marblesinc</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7051</span>
<span class="n">CORE_VM_ENDPOINT</span><span class="o">=</span><span class="nl">unix</span><span class="p">:</span><span class="c1">///host/var/run/docker.sock</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 6.10:</strong> Enter <em>peer channel list</em> and observe that no channels
are returned at the end of the output:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">channel</span> <span class="n">list</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">17</span><span class="o">:</span><span class="mf">20.354</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Endorser</span> <span class="n">and</span> <span class="n">orderer</span> <span class="n">connections</span> <span class="n">initialized</span>
<span class="n">Channels</span> <span class="n">peers</span> <span class="n">has</span> <span class="nl">joined</span><span class="p">:</span> 
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 6.11:</strong> Issue <em>peer channel join -b $CHANNEL_NAME.block</em> to
join your channel. Your output should look similar to this:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">channel</span> <span class="n">join</span> <span class="o">-</span><span class="n">b</span> <span class="n">$CHANNEL_NAME</span><span class="p">.</span><span class="n">block</span> 
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">17</span><span class="o">:</span><span class="mf">45.129</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Endorser</span> <span class="n">and</span> <span class="n">orderer</span> <span class="n">connections</span> <span class="n">initialized</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">17</span><span class="o">:</span><span class="mf">45.212</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">executeJoin</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">002</span> <span class="n">Successfully</span> <span class="n">submitted</span> <span class="n">proposal</span> <span class="n">to</span> <span class="n">join</span> <span class="n">channel</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 6.12:</strong> Repeat the <em>peer channel list</em> command and now you should
see your channel listed in the output:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">channel</span> <span class="n">list</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span><span class="mf">14.491</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Endorser</span> <span class="n">and</span> <span class="n">orderer</span> <span class="n">connections</span> <span class="n">initialized</span>
<span class="n">Channels</span> <span class="n">peers</span> <span class="n">has</span> <span class="nl">joined</span><span class="p">:</span> 
<span class="n">mychannel</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 6.13:</strong> Point the <em>cli</em> to <em>peer1</em> for <em>Org1MSP</em>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">source</span> <span class="n">scripts</span><span class="o">/</span><span class="n">setpeer</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="n">CORE_PEER_TLS_KEY_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">key</span>
<span class="n">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="n">Org1MSP</span>
<span class="n">CORE_PEER_TLS_ENABLED</span><span class="o">=</span><span class="nb">true</span>
<span class="n">CORE_PEER_TLS_CERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ID</span><span class="o">=</span><span class="n">cli</span>
<span class="n">CORE_PEER_MSPCONFIGPATH</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">Admin</span><span class="p">@</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">msp</span>
<span class="n">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer1</span><span class="p">.</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">ca</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ADDRESS</span><span class="o">=</span><span class="n">peer1</span><span class="p">.</span><span class="n">marblesinc</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7051</span>
<span class="n">CORE_VM_ENDPOINT</span><span class="o">=</span><span class="nl">unix</span><span class="p">:</span><span class="c1">///host/var/run/docker.sock</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 6.14:</strong> Enter <em>peer channel list</em> and observe that no channels
are returned at the end of the output:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">channel</span> <span class="n">list</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">19</span><span class="o">:</span><span class="mf">32.055</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Endorser</span> <span class="n">and</span> <span class="n">orderer</span> <span class="n">connections</span> <span class="n">initialized</span>
<span class="n">Channels</span> <span class="n">peers</span> <span class="n">has</span> <span class="nl">joined</span><span class="p">:</span> 
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 6.15:</strong> Issue <em>peer channel join -b $CHANNEL_NAME.block</em> to
join your channel. (Am I being redundant? Am I repeating myself? Am I
saying the same thing over and over again?) Your output should look
similar to this:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">channel</span> <span class="n">join</span> <span class="o">-</span><span class="n">b</span> <span class="n">$CHANNEL_NAME</span><span class="p">.</span><span class="n">block</span> 
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">19</span><span class="o">:</span><span class="mf">51.856</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Endorser</span> <span class="n">and</span> <span class="n">orderer</span> <span class="n">connections</span> <span class="n">initialized</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">19</span><span class="o">:</span><span class="mf">51.953</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">executeJoin</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">002</span> <span class="n">Successfully</span> <span class="n">submitted</span> <span class="n">proposal</span> <span class="n">to</span> <span class="n">join</span> <span class="n">channel</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 6.16:</strong> Repeat the <em>peer channel list</em> command and now you should
see your channel listed in the output:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">channel</span> <span class="n">list</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mf">20.791</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Endorser</span> <span class="n">and</span> <span class="n">orderer</span> <span class="n">connections</span> <span class="n">initialized</span>
<span class="n">Channels</span> <span class="n">peers</span> <span class="n">has</span> <span class="nl">joined</span><span class="p">:</span> 
<span class="n">mychannel</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span><span class="n">s</span> <span class="n">has</span> <span class="nl">joined</span><span class="p">:</span> 
    <span class="n">mychannel</span>
</code></pre></div>

<h1 id="section-7-define-an-anchor-peer-for-each-organization-in-the-channel">Section 7 - Define an "anchor" peer for each organization in the channel<a class="headerlink" href="#section-7-define-an-anchor-peer-for-each-organization-in-the-channel" title="Permanent link">&para;</a></h1>
<p>An anchor peer for an organization is a peer that can be known by all
the other organizations in a channel. Not all peers for an organization
need to be defined as anchor peers. Peers from other organizations will
reach out to anchor peers which can then make information about the
other peers available.</p>
<p>In a production environment, an organization will typically define more
than one peer as an anchor peer for availability and resilience. In our
lab, we will just define one of the two peers for each organization as
an anchor peer.</p>
<p>The definition of an anchor peer took place back in section 4 when you
ran the <em>generateArtifacts.sh</em> script. Two of the output files from that
step were <em>Org0MSPanchors.tx</em> and <em>Org1MSPanchors.tx.</em> These are input
files to define the anchor peers for Org0MSP and Org1MSP respectively.
After the channel is created, each organization needs to run this
command. You will do that now- this process is a little bit confusing in
that the command to do this starts with <em>peer channel create ...</em> but
the command will actually <em>update</em> the existing channel with the
information about the desired anchor peer. Think of <em>peer channel
create</em> here as meaning, "create an update transaction for a channel".</p>
<p><strong>Step 7.1:</strong> Switch to <em>peer0</em> for <em>Org0MSP</em>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">source</span> <span class="n">scripts</span><span class="o">/</span><span class="n">setpeer</span> <span class="mi">0</span> <span class="mi">0</span>   <span class="err">#</span> <span class="n">to</span> <span class="k">switch</span> <span class="n">to</span> <span class="n">Peer</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">Org0MSP</span>
<span class="n">CORE_PEER_TLS_KEY_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">key</span>
<span class="n">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="n">Org0MSP</span>
<span class="n">CORE_PEER_TLS_ENABLED</span><span class="o">=</span><span class="nb">true</span>
<span class="n">CORE_PEER_TLS_CERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ID</span><span class="o">=</span><span class="n">cli</span>
<span class="n">CORE_PEER_MSPCONFIGPATH</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">Admin</span><span class="p">@</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">msp</span>
<span class="n">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">ca</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ADDRESS</span><span class="o">=</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7051</span>
<span class="n">CORE_VM_ENDPOINT</span><span class="o">=</span><span class="nl">unix</span><span class="p">:</span><span class="c1">///host/var/run/docker.sock</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 7.2:</strong> Issue this command to create the anchor peer for
<em>Org0MSP</em>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">channel</span> <span class="n">create</span> <span class="o">-</span><span class="n">o</span> <span class="n">orderer</span><span class="p">.</span><span class="n">blockchain</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7050</span> <span class="o">-</span><span class="n">f</span> <span class="n">channel</span><span class="o">-</span><span class="n">artifacts</span><span class="o">/</span><span class="n">Org0MSPanchors</span><span class="p">.</span><span class="n">tx</span> <span class="n">$FABRIC_TLS</span> <span class="o">-</span><span class="n">c</span> <span class="n">$CHANNEL_NAME</span> 
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mf">09.479</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Endorser</span> <span class="n">and</span> <span class="n">orderer</span> <span class="n">connections</span> <span class="n">initialized</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">23</span><span class="o">:</span><span class="mf">09.495</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">cli</span><span class="p">.</span><span class="n">common</span><span class="p">]</span> <span class="n">readBlock</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">002</span> <span class="n">Received</span> <span class="nl">block</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 7.3:</strong> Switch to <em>peer0</em> for <em>Org1MSP</em>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">source</span> <span class="n">scripts</span><span class="o">/</span><span class="n">setpeer</span> <span class="mi">1</span> <span class="mi">0</span>
<span class="n">CORE_PEER_TLS_KEY_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">key</span>
<span class="n">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="n">Org1MSP</span>
<span class="n">CORE_PEER_TLS_ENABLED</span><span class="o">=</span><span class="nb">true</span>
<span class="n">CORE_PEER_TLS_CERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ID</span><span class="o">=</span><span class="n">cli</span>
<span class="n">CORE_PEER_MSPCONFIGPATH</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">Admin</span><span class="p">@</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">msp</span>
<span class="n">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">ca</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ADDRESS</span><span class="o">=</span><span class="n">peer0</span><span class="p">.</span><span class="n">marblesinc</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7051</span>
<span class="n">CORE_VM_ENDPOINT</span><span class="o">=</span><span class="nl">unix</span><span class="p">:</span><span class="c1">///host/var/run/docker.sock</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 7.4:</strong> Issue this command to create the anchor peer for
<em>Org1MSP</em>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">channel</span> <span class="n">create</span> <span class="o">-</span><span class="n">o</span> <span class="n">orderer</span><span class="p">.</span><span class="n">blockchain</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7050</span> <span class="o">-</span><span class="n">f</span> <span class="n">channel</span><span class="o">-</span><span class="n">artifacts</span><span class="o">/</span><span class="n">Org1MSPanchors</span><span class="p">.</span><span class="n">tx</span> <span class="n">$FABRIC_TLS</span> <span class="o">-</span><span class="n">c</span> <span class="n">$CHANNEL_NAME</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">24</span><span class="o">:</span><span class="mf">21.903</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">channelCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Endorser</span> <span class="n">and</span> <span class="n">orderer</span> <span class="n">connections</span> <span class="n">initialized</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">24</span><span class="o">:</span><span class="mf">21.914</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">cli</span><span class="p">.</span><span class="n">common</span><span class="p">]</span> <span class="n">readBlock</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">002</span> <span class="n">Received</span> <span class="nl">block</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<h1 id="section-8-install-the-chaincode-on-the-peer-nodes">Section 8 - Install the chaincode on the peer nodes<a class="headerlink" href="#section-8-install-the-chaincode-on-the-peer-nodes" title="Permanent link">&para;</a></h1>
<p>Installing chaincode on the peer nodes puts the chaincode binary
executable on a peer node. If you want the peer to be an endorser on a
channel for a chaincode, then you must install the chaincode on that
peer. If you only want the peer to be a committer on a channel for a
chaincode, then you do not have to install the chaincode on that peer.
In this section, you will install the chaincode on two of your peers.</p>
<p><strong>Step 8.1:</strong> Switch to <em>peer0</em> in <em>Org0MSP</em>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">source</span> <span class="n">scripts</span><span class="o">/</span><span class="n">setpeer</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="n">CORE_PEER_TLS_KEY_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">key</span>
<span class="n">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="n">Org0MSP</span>
<span class="n">CORE_PEER_TLS_ENABLED</span><span class="o">=</span><span class="nb">true</span>
<span class="n">CORE_PEER_TLS_CERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ID</span><span class="o">=</span><span class="n">cli</span>
<span class="n">CORE_PEER_MSPCONFIGPATH</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">Admin</span><span class="p">@</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">msp</span>
<span class="n">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">ca</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ADDRESS</span><span class="o">=</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7051</span>
<span class="n">CORE_VM_ENDPOINT</span><span class="o">=</span><span class="nl">unix</span><span class="p">:</span><span class="c1">///host/var/run/docker.sock</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 8.2:</strong> Try this command to list the chaincodes installed on the
peer. It will return an empty list, as you haven't yet installed any
chaincode on any of the peers:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">chaincode</span> <span class="n">list</span> <span class="o">--</span><span class="n">installed</span>
<span class="n">Get</span> <span class="n">installed</span> <span class="n">chaincodes</span> <span class="n">on</span> <span class="nl">peer</span><span class="p">:</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 8.3:</strong> Install the marbles chaincode on Peer0 in Org0MSP. You are
looking for a message near the end of the output similar to what is
shown here:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">chaincode</span> <span class="n">install</span> <span class="o">-</span><span class="n">n</span> <span class="n">marbles</span> <span class="o">-</span><span class="n">v</span> <span class="mf">1.0</span> <span class="o">-</span><span class="n">p</span> <span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">chaincode</span><span class="o">/</span><span class="n">go</span><span class="o">/</span><span class="n">marbles</span> 
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">59.811</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">checkChaincodeCmdParams</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Using</span> <span class="k">default</span> <span class="n">escc</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">59.811</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">checkChaincodeCmdParams</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">002</span> <span class="n">Using</span> <span class="k">default</span> <span class="n">vscc</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">00.040</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">install</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">003</span> <span class="n">Installed</span> <span class="n">remotely</span> <span class="nl">response</span><span class="p">:</span><span class="o">&lt;</span><span class="nl">status</span><span class="p">:</span><span class="mi">200</span> <span class="nl">payload</span><span class="p">:</span><span class="s">&quot;OK&quot;</span> <span class="o">&gt;</span> 
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 8.4:</strong> Repeat the command from <em>Step 8.2:</em> - Tip: you could
probably use the up arrow key a couple of times to retrieve that command
as an alternative to doing a copy-and-paste here, but I'll leave it up
to you:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">chaincode</span> <span class="n">list</span> <span class="o">--</span><span class="n">installed</span>
<span class="n">Get</span> <span class="n">installed</span> <span class="n">chaincodes</span> <span class="n">on</span> <span class="nl">peer</span><span class="p">:</span>
<span class="nl">Name</span><span class="p">:</span> <span class="n">marbles</span><span class="p">,</span> <span class="nl">Version</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="nl">Path</span><span class="p">:</span> <span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">chaincode</span><span class="o">/</span><span class="n">go</span><span class="o">/</span><span class="n">marbles</span><span class="p">,</span> <span class="nl">Id</span><span class="p">:</span> <span class="mf">19776f</span><span class="mi">7</span><span class="n">d2a186d5188b748254a5767bd9689f3723672450c3fdd2daa62b4b746</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Note:</strong> I won't have you repeat the "before" and "after" <em>peer
chaincode list --installed</em> commands on any of the other peers on which
you install it, but I won't take extraordinary measures to stop you if
you insist on doing it.</p>
<p><strong>Step 8.5:</strong> Switch to <em>peer0</em> in <em>Org1MSP</em>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">source</span> <span class="n">scripts</span><span class="o">/</span><span class="n">setpeer</span> <span class="mi">1</span> <span class="mi">0</span>
<span class="n">CORE_PEER_TLS_KEY_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">key</span>
<span class="n">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="n">Org1MSP</span>
<span class="n">CORE_PEER_TLS_ENABLED</span><span class="o">=</span><span class="nb">true</span>
<span class="n">CORE_PEER_TLS_CERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ID</span><span class="o">=</span><span class="n">cli</span>
<span class="n">CORE_PEER_MSPCONFIGPATH</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">Admin</span><span class="p">@</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">msp</span>
<span class="n">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">ca</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ADDRESS</span><span class="o">=</span><span class="n">peer0</span><span class="p">.</span><span class="n">marblesinc</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7051</span>
<span class="n">CORE_VM_ENDPOINT</span><span class="o">=</span><span class="nl">unix</span><span class="p">:</span><span class="c1">///host/var/run/docker.sock</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 8.6:</strong> Install the marbles chaincode on Peer0 in Org1MSP. You are
looking for a message near the end of the output similar to what is
shown here:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">chaincode</span> <span class="n">install</span> <span class="o">-</span><span class="n">n</span> <span class="n">marbles</span> <span class="o">-</span><span class="n">v</span> <span class="mf">1.0</span> <span class="o">-</span><span class="n">p</span> <span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">chaincode</span><span class="o">/</span><span class="n">go</span><span class="o">/</span><span class="n">marbles</span> 
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mf">38.352</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">checkChaincodeCmdParams</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Using</span> <span class="k">default</span> <span class="n">escc</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mf">38.352</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">checkChaincodeCmdParams</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">002</span> <span class="n">Using</span> <span class="k">default</span> <span class="n">vscc</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">27</span><span class="o">:</span><span class="mf">38.570</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">install</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">003</span> <span class="n">Installed</span> <span class="n">remotely</span> <span class="nl">response</span><span class="p">:</span><span class="o">&lt;</span><span class="nl">status</span><span class="p">:</span><span class="mi">200</span> <span class="nl">payload</span><span class="p">:</span><span class="s">&quot;OK&quot;</span> <span class="o">&gt;</span> 
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p>An interesting thing to note is that for the <em>peer chaincode install</em>
command you did not need to specify the $FABRIC_TLS environment
variable. This is because this operation does not cause the peer to
communicate with the orderer. Also, you did not need to specify the
$CHANNEL_NAME environment variable. This is because the <em>peer
chaincode install</em> command only installs the chaincode on the peer node.
You only need to do this once per peer. That is, even if you wanted to
invoke the same chaincode on multiple channels on a peer, you only
install the chaincode once on that peer.</p>
<p>Installing chaincode on a peer is a necessary step, but not the only
step needed, in order to execute chaincode on that peer. The chaincode
must also be instantiated on a channel that the peer participates in.
You will do that in the next section.   </p>
<h1 id="section-9-instantiate-the-chaincode-on-the-channel">Section 9 - Instantiate the chaincode on the channel<a class="headerlink" href="#section-9-instantiate-the-chaincode-on-the-channel" title="Permanent link">&para;</a></h1>
<p>In the previous section, you installed chaincode on two of your four
peers. Chaincode installation is a peer-level operation. Chaincode
instantiation, however, is a channel-level operation. It only needs to
be performed once on the channel, no matter how many peers have joined
the channel. I'll try to prove it to you in this section.</p>
<p>Chaincode instantiation causes a transaction to occur on the channel, so
even if a peer on the channel does not have the chaincode installed, it
will be made aware of the instantiate transaction, and thus be aware
that the chaincode exists and be able to commit transactions from the
chaincode to the ledger- it just would not be able to endorse a
transaction on the chaincode.</p>
<p><strong>Step 9.1:</strong> You want to stay signed in to the <em>cli</em> Docker container;
however, you will also want to issue some Docker commands from your
Linux on IBM Z host, so at this time open up a second terminal session
and sign in to your Linux on IBM Z host. For the remainder of this lab,
I will refer to the session where you are in the <em>cli</em> Docker container
as <em>Terminal Session 1</em>, and this new session where you are at the Linux
on IBM Z host as <em>Terminal Session 2</em>. If you are running this lab from
a Windows laptop you probably are using PuTTY. If you are running this
lab from Linux or MacOS you are probably using terminal sessions and
using <em>ssh</em>.</p>
<p><strong>Step 9.2:</strong> You are going to confirm that you do not have any
chaincode Docker images created, nor any Docker chaincode containers
running currently. From Terminal Session 2, enter this command and
observe that all of your images begin with <em>hyperledger</em>:</p>
<div class="codehilite"><pre><span></span><code><span class="n">bcuser</span><span class="err">@</span><span class="n">ubuntu18042</span><span class="p">:</span><span class="o">~$</span> <span class="n">docker</span> <span class="n">images</span>
<span class="n">REPOSITORY</span>                   <span class="n">TAG</span>                 <span class="n">IMAGE</span> <span class="n">ID</span>            <span class="n">CREATED</span>             <span class="n">SIZE</span>
<span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">ca</span>        <span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>               <span class="n">a836041637e8</span>        <span class="mi">2</span> <span class="n">weeks</span> <span class="n">ago</span>         <span class="mi">220</span><span class="n">MB</span>
<span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">tools</span>     <span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>               <span class="mi">330902566372</span>        <span class="mi">2</span> <span class="n">weeks</span> <span class="n">ago</span>         <span class="mf">1.52</span><span class="n">GB</span>
<span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">orderer</span>   <span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>               <span class="mi">1</span><span class="n">b709e319b2d</span>        <span class="mi">2</span> <span class="n">weeks</span> <span class="n">ago</span>         <span class="mi">148</span><span class="n">MB</span>
<span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">peer</span>      <span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>               <span class="mi">719392658</span><span class="n">c28</span>        <span class="mi">2</span> <span class="n">weeks</span> <span class="n">ago</span>         <span class="mi">154</span><span class="n">MB</span>
<span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">couchdb</span>   <span class="n">s390x</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">15</span>        <span class="mi">81</span><span class="n">ee917e0be2</span>        <span class="mi">5</span> <span class="n">weeks</span> <span class="n">ago</span>         <span class="mf">1.55</span><span class="n">GB</span>
<span class="n">bcuser</span><span class="err">@</span><span class="n">ubuntu18042</span><span class="p">:</span><span class="o">~$</span>
</code></pre></div>

<p>You should not have any images which begin with <em>dev-</em>, which is what
your Docker chaincode images will start with, and at this point in the
lab Docker chaincode images have not been created yet.</p>
<p><strong>Step 9.3:</strong> Now do essentially the same thing with <em>docker ps</em> and you
should see all of the Docker containers for the Hyperledger Fabric
processes and CouchDB, but no chaincode-related Docker containers:</p>
<div class="codehilite"><pre><span></span><code><span class="n">bcuser</span><span class="err">@</span><span class="n">ubuntu18042</span><span class="p">:</span><span class="o">~$</span> <span class="n">docker</span> <span class="n">ps</span> <span class="o">--</span><span class="n">all</span>
<span class="n">CONTAINER</span> <span class="n">ID</span>        <span class="n">IMAGE</span>                                     <span class="n">COMMAND</span>                  <span class="n">CREATED</span>             <span class="n">STATUS</span>              <span class="n">PORTS</span>                                                                       <span class="n">NAMES</span>
<span class="mi">84</span><span class="n">b6c0ee74aa</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">tools</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>            <span class="s2">&quot;bash&quot;</span>                   <span class="mi">23</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">23</span> <span class="n">minutes</span>                                                                                   <span class="n">cli</span>
<span class="n">e6eabd9fd96d</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">peer</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>             <span class="s2">&quot;peer node start&quot;</span>        <span class="mi">23</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">23</span> <span class="n">minutes</span>       <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">9051</span><span class="o">-&gt;</span><span class="mi">7051</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">9052</span><span class="o">-&gt;</span><span class="mi">7052</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">9053</span><span class="o">-&gt;</span><span class="mi">7053</span><span class="o">/</span><span class="n">tcp</span>      <span class="n">peer0</span><span class="o">.</span><span class="n">marblesinc</span><span class="o">.</span><span class="n">com</span>
<span class="mi">8174</span><span class="n">f3021744</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">peer</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>             <span class="s2">&quot;peer node start&quot;</span>        <span class="mi">23</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">23</span> <span class="n">minutes</span>       <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8051</span><span class="o">-&gt;</span><span class="mi">7051</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8052</span><span class="o">-&gt;</span><span class="mi">7052</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8053</span><span class="o">-&gt;</span><span class="mi">7053</span><span class="o">/</span><span class="n">tcp</span>      <span class="n">peer1</span><span class="o">.</span><span class="n">unitedmarbles</span><span class="o">.</span><span class="n">com</span>
<span class="mi">1</span><span class="n">a22b9eb5be5</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">peer</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>             <span class="s2">&quot;peer node start&quot;</span>        <span class="mi">23</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">23</span> <span class="n">minutes</span>       <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">10051</span><span class="o">-&gt;</span><span class="mi">7051</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">10052</span><span class="o">-&gt;</span><span class="mi">7052</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">10053</span><span class="o">-&gt;</span><span class="mi">7053</span><span class="o">/</span><span class="n">tcp</span>   <span class="n">peer1</span><span class="o">.</span><span class="n">marblesinc</span><span class="o">.</span><span class="n">com</span>
<span class="mi">11423</span><span class="n">ca89763</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">peer</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>             <span class="s2">&quot;peer node start&quot;</span>        <span class="mi">23</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">23</span> <span class="n">minutes</span>       <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">7051</span><span class="o">-</span><span class="mi">7053</span><span class="o">-&gt;</span><span class="mi">7051</span><span class="o">-</span><span class="mi">7053</span><span class="o">/</span><span class="n">tcp</span>                                            <span class="n">peer0</span><span class="o">.</span><span class="n">unitedmarbles</span><span class="o">.</span><span class="n">com</span>
<span class="mi">18</span><span class="n">b9e5efbfc9</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">couchdb</span><span class="p">:</span><span class="n">s390x</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">15</span>   <span class="s2">&quot;tini -- /docker-ent…&quot;</span>   <span class="mi">23</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">23</span> <span class="n">minutes</span>       <span class="mi">4369</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mi">9100</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">6984</span><span class="o">-&gt;</span><span class="mi">5984</span><span class="o">/</span><span class="n">tcp</span>                                  <span class="n">couchdb1</span>
<span class="mi">77288</span><span class="n">f8c0060</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">couchdb</span><span class="p">:</span><span class="n">s390x</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">15</span>   <span class="s2">&quot;tini -- /docker-ent…&quot;</span>   <span class="mi">23</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">23</span> <span class="n">minutes</span>       <span class="mi">4369</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mi">9100</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">7984</span><span class="o">-&gt;</span><span class="mi">5984</span><span class="o">/</span><span class="n">tcp</span>                                  <span class="n">couchdb2</span>
<span class="mi">43214</span><span class="n">da184da</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">ca</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>               <span class="s2">&quot;sh -c &#39;fabric-ca-se…&quot;</span>   <span class="mi">23</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">23</span> <span class="n">minutes</span>       <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">7054</span><span class="o">-&gt;</span><span class="mi">7054</span><span class="o">/</span><span class="n">tcp</span>                                                      <span class="n">ca_Org0</span>
<span class="mi">1</span><span class="n">ea639c77a3a</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">ca</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>               <span class="s2">&quot;sh -c &#39;fabric-ca-se…&quot;</span>   <span class="mi">23</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">23</span> <span class="n">minutes</span>       <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8054</span><span class="o">-&gt;</span><span class="mi">7054</span><span class="o">/</span><span class="n">tcp</span>                                                      <span class="n">ca_Org1</span>
<span class="mi">07</span><span class="n">df27e35368</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">couchdb</span><span class="p">:</span><span class="n">s390x</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">15</span>   <span class="s2">&quot;tini -- /docker-ent…&quot;</span>   <span class="mi">23</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">23</span> <span class="n">minutes</span>       <span class="mi">4369</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mi">9100</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">8984</span><span class="o">-&gt;</span><span class="mi">5984</span><span class="o">/</span><span class="n">tcp</span>                                  <span class="n">couchdb3</span>
<span class="mf">93e0465394</span><span class="n">b6</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">orderer</span><span class="p">:</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">1</span>          <span class="s2">&quot;orderer&quot;</span>                <span class="mi">23</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">23</span> <span class="n">minutes</span>       <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">7050</span><span class="o">-&gt;</span><span class="mi">7050</span><span class="o">/</span><span class="n">tcp</span>                                                      <span class="n">orderer</span><span class="o">.</span><span class="n">blockchain</span><span class="o">.</span><span class="n">com</span>
<span class="mi">4201915</span><span class="n">cc3b2</span>        <span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">-</span><span class="n">couchdb</span><span class="p">:</span><span class="n">s390x</span><span class="o">-</span><span class="mf">0.4</span><span class="o">.</span><span class="mi">15</span>   <span class="s2">&quot;tini -- /docker-ent…&quot;</span>   <span class="mi">23</span> <span class="n">minutes</span> <span class="n">ago</span>      <span class="n">Up</span> <span class="mi">23</span> <span class="n">minutes</span>       <span class="mi">4369</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mi">9100</span><span class="o">/</span><span class="n">tcp</span><span class="p">,</span> <span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">:</span><span class="mi">5984</span><span class="o">-&gt;</span><span class="mi">5984</span><span class="o">/</span><span class="n">tcp</span>                                  <span class="n">couchdb0</span>
<span class="n">bcuser</span><span class="err">@</span><span class="n">ubuntu18042</span><span class="p">:</span><span class="o">~$</span>
</code></pre></div>

<p><strong>Step 9.4:</strong> Entering this will make this fact stand out more as you
should only see column headers in your output. (The <em>--invert-match</em>
argument for <em>grep</em> says "do not show me anything that contains the
string "hyperledger"):</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~$ docker ps --all | grep --invert-match hyperledger</span>
<span class="err">CONTAINER ID        IMAGE                                     COMMAND                  CREATED             STATUS              PORTS                                                                       NAMES</span>
<span class="err">bcuser@ubuntu18042:~$</span>
</code></pre></div>

<p>Now that you have established that you have no chaincode-related Docker
images or containers present, try to instantiate the chaincode.</p>
<p><strong>Step 9.5:</strong> On Terminal Session 1, switch to Peer 0 of Org0MSP by
entering:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">source</span> <span class="n">scripts</span><span class="o">/</span><span class="n">setpeer</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="n">CORE_PEER_TLS_KEY_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">key</span>
<span class="n">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="n">Org0MSP</span>
<span class="n">CORE_PEER_TLS_ENABLED</span><span class="o">=</span><span class="nb">true</span>
<span class="n">CORE_PEER_TLS_CERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ID</span><span class="o">=</span><span class="n">cli</span>
<span class="n">CORE_PEER_MSPCONFIGPATH</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">Admin</span><span class="p">@</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">msp</span>
<span class="n">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">ca</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ADDRESS</span><span class="o">=</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7051</span>
<span class="n">CORE_VM_ENDPOINT</span><span class="o">=</span><span class="nl">unix</span><span class="p">:</span><span class="c1">///host/var/run/docker.sock</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 9.6:</strong> On Terminal Session 1, enter this command to list
instantiated chaincodes on your channel. Spoiler alert- there aren't
any, so you will get an empty list:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">chaincode</span> <span class="n">list</span> <span class="o">--</span><span class="n">instantiated</span> <span class="o">--</span><span class="n">channelID</span> <span class="n">$</span><span class="p">{</span><span class="n">CHANNEL_NAME</span><span class="p">}</span>
<span class="n">Get</span> <span class="n">instantiated</span> <span class="n">chaincodes</span> <span class="n">on</span> <span class="n">channel</span> <span class="nl">mychannel</span><span class="p">:</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 9.7:</strong> On Terminal Session 1, issue the command to instantiate
the chaincode on the channel:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">chaincode</span> <span class="n">instantiate</span> <span class="o">-</span><span class="n">o</span> <span class="n">orderer</span><span class="p">.</span><span class="n">blockchain</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7050</span> <span class="o">-</span><span class="n">n</span> <span class="n">marbles</span> <span class="o">-</span><span class="n">v</span> <span class="mf">1.0</span> <span class="o">-</span><span class="n">c</span> <span class="err">&#39;</span><span class="p">{</span><span class="s">&quot;Args&quot;</span><span class="o">:</span><span class="p">[</span><span class="s">&quot;init&quot;</span><span class="p">,</span><span class="s">&quot;1&quot;</span><span class="p">]}</span><span class="err">&#39;</span> <span class="o">-</span><span class="n">P</span> <span class="s">&quot;OR (&#39;Org0MSP.member&#39;,&#39;Org1MSP.member&#39;)&quot;</span> <span class="n">$FABRIC_TLS</span> <span class="o">-</span><span class="n">C</span> <span class="n">$CHANNEL_NAME</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">32</span><span class="o">:</span><span class="mf">27.208</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">checkChaincodeCmdParams</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Using</span> <span class="k">default</span> <span class="n">escc</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">32</span><span class="o">:</span><span class="mf">27.208</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">checkChaincodeCmdParams</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">002</span> <span class="n">Using</span> <span class="k">default</span> <span class="n">vscc</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<div class="admonition note">
<p class="admonition-title">Note<p>In your prior commands, when specifying the channel name, you used lowercase 'c' as the argument, e.g., <em>-c $CHANNEL_NAME</em>. In the <em>peer chaincode instantiate</em> command however, you use an uppercase 'C' as the argument to specify the channel name, e.g., <em>-C mychannel</em>, because -c is used to specify the arguments given to the chaincode. Why <em>c</em> for arguments you may ask? Well, the '<em>c</em>' is short for '<em>ctor</em>', which itself is an abbreviation for <em>constructor</em>, which is a fancy word object-oriented programmers use to refer to the initial arguments given when creating an object.</p>
</p>
</div>
<p><strong>Step 9.8:</strong> You may have noticed a longer than usual pause before you
got your command prompt back while that last command was being run. The
reason for this is that as part of the instantiate, a Docker image for
the chaincode is created and then a Docker container is started from the
image. To prove this to yourself, on Terminal Session 2, enter this to
see the new Docker image:</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~$ docker images dev-*</span>
<span class="err">REPOSITORY                                                                                                 TAG                 IMAGE ID            CREATED              SIZE</span>
<span class="err">dev-peer0.unitedmarbles.com-marbles-1.0-7e92f069adb7469939a96dcba723fa2019745461f05a562e81cec38e46424aa1   latest              d41acea306aa        About a minute ago   137MB</span>
<span class="err">bcuser@ubuntu18042:~$</span>
</code></pre></div>

<p><strong>Step 9.9:</strong> And enter this to see the Docker chaincode container
created from the new Docker image:</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~$ docker ps | grep --invert-match hyperledger</span>
<span class="err">CONTAINER ID        IMAGE                                                                                                      COMMAND                  CREATED              STATUS              PORTS                                                                       NAMES</span>
<span class="err">62a185d148d2        dev-peer0.unitedmarbles.com-marbles-1.0-7e92f069adb7469939a96dcba723fa2019745461f05a562e81cec38e46424aa1   &quot;chaincode -peer.add…&quot;   About a minute ago   Up About a minute                                                                               dev-peer0.unitedmarbles.com-marbles-1.0</span>
<span class="err">bcuser@ubuntu18042:~$</span>
</code></pre></div>

<p>The naming convention used by Hyperledger Fabric v1.4.1 for the Docker
images it creates for chaincode is
<em>HyperledgerFabricNetworkName-PeerName-ChaincodeName-ChaincodeVersion-SHA256Hash</em>.
In our case of <em>dev-peer0.unitedmarbles.com-marbles-1.0-</em>, the default
name of a Hyperledger Fabric network is <em>dev</em>, and you did not change
it. <em>peer0.unitedmarbles.com</em> is the peer name of peer0 of Org0MSP, and
you specified this via the CORE_PEER_ID environment variable in the
Docker Compose YAML file. <em>marbles</em> is the name you gave this chaincode
in the <em>-n</em> argument of the <em>peer chaincode install</em> command, and <em>1.0</em>
is the version of the chaincode you used in the <em>-v</em> argument of the
<em>peer chaincode install</em> command.</p>
<p>Note that a chaincode Docker container was only created for the peer on
which you entered the <em>peer chaincode instantiate</em> command. Docker
containers will not be created on the other peers until you run a <em>peer
chaincode invoke</em> or <em>peer chaincode query</em> command on that peer.</p>
<p><strong>Step 9.10:</strong> In Terminal Session 1 repeat the command from <em>Step 9.6</em>
to see that your instantiated chaincode on your channel is now listed:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">chaincode</span> <span class="n">list</span> <span class="o">--</span><span class="n">instantiated</span> <span class="o">--</span><span class="n">channelID</span> <span class="n">$</span><span class="p">{</span><span class="n">CHANNEL_NAME</span><span class="p">}</span>
<span class="n">Get</span> <span class="n">instantiated</span> <span class="n">chaincodes</span> <span class="n">on</span> <span class="n">channel</span> <span class="nl">mychannel</span><span class="p">:</span>
<span class="nl">Name</span><span class="p">:</span> <span class="n">marbles</span><span class="p">,</span> <span class="nl">Version</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="nl">Path</span><span class="p">:</span> <span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">chaincode</span><span class="o">/</span><span class="n">go</span><span class="o">/</span><span class="n">marbles</span><span class="p">,</span> <span class="nl">Escc</span><span class="p">:</span> <span class="n">escc</span><span class="p">,</span> <span class="nl">Vscc</span><span class="p">:</span> <span class="n">vscc</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 9.11:</strong> Remember when I said at the beginning of this section
that I would try to prove it to you that you only need to do the
<em>instantiate</em> once on a channel, and not on every peer in the channel?
Let's find out if I'm lying. You did the <em>instantiate</em> on peer "0
0". Switch to another peer:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">source</span> <span class="n">scripts</span><span class="o">/</span><span class="n">setpeer</span> <span class="mi">1</span> <span class="mi">1</span>
<span class="n">CORE_PEER_TLS_KEY_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">key</span>
<span class="n">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="n">Org1MSP</span>
<span class="n">CORE_PEER_TLS_ENABLED</span><span class="o">=</span><span class="nb">true</span>
<span class="n">CORE_PEER_TLS_CERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ID</span><span class="o">=</span><span class="n">cli</span>
<span class="n">CORE_PEER_MSPCONFIGPATH</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">Admin</span><span class="p">@</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">msp</span>
<span class="n">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer1</span><span class="p">.</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">ca</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ADDRESS</span><span class="o">=</span><span class="n">peer1</span><span class="p">.</span><span class="n">marblesinc</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7051</span>
<span class="n">CORE_VM_ENDPOINT</span><span class="o">=</span><span class="nl">unix</span><span class="p">:</span><span class="c1">///host/var/run/docker.sock</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 9.12:</strong> Repeat the command from <em>Step 9.10</em> on this peer, and
even though you did not run the <em>peer chaincode instantiate</em> on this
peer, you will see that this peer is aware of the instantiation:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">chaincode</span> <span class="n">list</span> <span class="o">--</span><span class="n">instantiated</span> <span class="o">--</span><span class="n">channelID</span> <span class="n">$</span><span class="p">{</span><span class="n">CHANNEL_NAME</span><span class="p">}</span>
<span class="n">Get</span> <span class="n">instantiated</span> <span class="n">chaincodes</span> <span class="n">on</span> <span class="n">channel</span> <span class="nl">mychannel</span><span class="p">:</span>
<span class="nl">Name</span><span class="p">:</span> <span class="n">marbles</span><span class="p">,</span> <span class="nl">Version</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="nl">Escc</span><span class="p">:</span> <span class="n">escc</span><span class="p">,</span> <span class="nl">Vscc</span><span class="p">:</span> <span class="n">vscc</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p>I would never lie to you.</p>
<h1 id="section-10-invoke-chaincode-functions">Section 10 - Invoke chaincode functions<a class="headerlink" href="#section-10-invoke-chaincode-functions" title="Permanent link">&para;</a></h1>
<p>You are now ready to invoke chaincode functions that will create, read,
update and delete data in the ledger.</p>
<p>In this section, you will enter <em>scripts/setpeer</em> and <em>peer chaincode
commands</em> in Terminal session 1, while you will enter <em>docker ps</em> and
<em>docker images</em> commands in Terminal session 2.</p>
<p><strong>Step 10.1:</strong> Switch to peer0 of Org0MSP:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">source</span> <span class="n">scripts</span><span class="o">/</span><span class="n">setpeer</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="n">CORE_PEER_TLS_KEY_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">key</span>
<span class="n">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="n">Org0MSP</span>
<span class="n">CORE_PEER_TLS_ENABLED</span><span class="o">=</span><span class="nb">true</span>
<span class="n">CORE_PEER_TLS_CERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ID</span><span class="o">=</span><span class="n">cli</span>
<span class="n">CORE_PEER_MSPCONFIGPATH</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">Admin</span><span class="p">@</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">msp</span>
<span class="n">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">ca</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ADDRESS</span><span class="o">=</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7051</span>
<span class="n">CORE_VM_ENDPOINT</span><span class="o">=</span><span class="nl">unix</span><span class="p">:</span><span class="c1">///host/var/run/docker.sock</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 10.2:</strong> You will use the marbles chaincode to create a new
Marbles owner named John. If you would like to use a different name than
John, that is fine but then there will be other places later where you
would need to use your "custom" name instead of John. And John's the
guy who first got this lab working about three years ago so I think he
deserves a marble, don't you, so if you do want to show off and change
the name then I'm going to let you figure out later where it might need
to be changed.</p>
<p>Enter this command in Terminal session 1:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">chaincode</span> <span class="n">invoke</span> <span class="o">-</span><span class="n">n</span> <span class="n">marbles</span> <span class="o">-</span><span class="n">c</span> <span class="err">&#39;</span><span class="p">{</span><span class="s">&quot;Args&quot;</span><span class="o">:</span><span class="p">[</span><span class="s">&quot;init_owner&quot;</span><span class="p">,</span> <span class="s">&quot;o0000000000001&quot;</span><span class="p">,</span><span class="s">&quot;John&quot;</span><span class="p">,</span><span class="s">&quot;Marbles Inc&quot;</span><span class="p">]}</span><span class="err">&#39;</span> <span class="n">$FABRIC_TLS</span> <span class="o">-</span><span class="n">C</span> <span class="n">$CHANNEL_NAME</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">37</span><span class="o">:</span><span class="mf">38.570</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Retrieved</span> <span class="n">channel</span> <span class="p">(</span><span class="n">mychannel</span><span class="p">)</span> <span class="n">orderer</span> <span class="nl">endpoint</span><span class="p">:</span> <span class="n">orderer</span><span class="p">.</span><span class="n">blockchain</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7050</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">37</span><span class="o">:</span><span class="mf">38.585</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">chaincodeInvokeOrQuery</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">002</span> <span class="n">Chaincode</span> <span class="n">invoke</span> <span class="n">successful</span><span class="p">.</span> <span class="nl">result</span><span class="p">:</span> <span class="nl">status</span><span class="p">:</span><span class="mi">200</span> 
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 10.3:</strong> Let's deconstruct the arguments to the chaincode:</p>
<div class="codehilite"><pre><span></span><code><span class="err">{“Args”:[“init_owner”, “o0000000000001”, “John”, “Marbles Inc”]}</span>
</code></pre></div>

<p>This is in JSON format. JSON stands for JavaScript Object Notation, and
is a very popular format for transmitting data in many languages, not
just with JavaScript. What is shown above is a single name/value pair.
The name is <em>Args</em> and the value is an array of four arguments. (The
square brackets "[" and "]" specify an array in JSON).</p>
<div class="admonition note">
<p class="admonition-title">Note<p>In the formal JSON definition the term '<em>name/value</em>' is used, but many programmers will also use the term '<em>key/value</em>' instead. You can consider these two terms as synonymous. (Many people use the phrase "the same" instead of the word "synonymous").</p>
</p>
</div>
<p>The <em>Args</em> name specifies the arguments passed to the chaincode
invocation. There is an interface layer, also called a "shim", that
gains control before passing it along to user-written chaincode
functions- it expects this <em>Args</em> name/value pair.</p>
<p>The shim also expects the first array value to be the name of the
user-written chaincode function that it will pass control to, and then
all remaining array values are the arguments to pass, in order, to that
user-written chaincode function.</p>
<p>So, in the command you just entered, the <em>init_owner</em> function is
called, and it is passed three arguments, <em>o0000000000001</em>, <em>John</em>, and
<em>Marbles Inc</em>.</p>
<p>It is logic within the <em>init_owner</em> function that cause updates to the
channel's ledger- subject to the transaction flow in Hyperledger Fabric
v1.4.1- that is, chaincode execution causes proposed updates to the
ledger, which are only committed at the end of the transaction flow if
everything is validated properly. But it all starts with function calls
inside the chaincode functions that ask for ledger state to be created
or updated.</p>
<p><strong>Step 10.4:</strong> Go to Terminal session 2, and enter this Docker command
and you will observe that you still only have a Docker image and a
Docker container for peer0 of Org0MSP:</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~$ docker images dev-*</span>
<span class="err">REPOSITORY                                                                                                 TAG                 IMAGE ID            CREATED             SIZE</span>
<span class="err">dev-peer0.unitedmarbles.com-marbles-1.0-7e92f069adb7469939a96dcba723fa2019745461f05a562e81cec38e46424aa1   latest              d41acea306aa        5 minutes ago       137MB</span>
<span class="err">bcuser@ubuntu18042:~$</span>
</code></pre></div>

<p><strong>Step 10.5:</strong> Enter this command to see information about the chaincode
container. I introduce here the <em>--no-trunc</em> option, which stands for
<em>no truncation</em>, so you can see more information about the container:</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~$ docker ps --no-trunc | grep dev-</span>
<span class="err">62a185d148d2a0ead43120ca50e3ed459a2a005b08b10ece0c4ae205bf1f016a   dev-peer0.unitedmarbles.com-marbles-1.0-7e92f069adb7469939a96dcba723fa2019745461f05a562e81cec38e46424aa1   &quot;chaincode -peer.address=peer0.unitedmarbles.com:7052&quot;                                                                                                                                                                                                                6 minutes ago       Up 6 minutes                                                                                    dev-peer0.unitedmarbles.com-marbles-1.0</span>
<span class="err">bcuser@ubuntu18042:~$</span>
</code></pre></div>

<p>The takeaway is that the chaincode execution has only run on peer0 of
Org0MSP so far, and this is also the peer on which you instantiated the
chaincode, so the Docker image for the chaincode, and the corresponding
Docker container based on the image, have been created for only this
peer. You will see soon that other peers will have their own chaincode
Docker image and Docker container built the first time they are needed.</p>
<p><strong>Step 10.6:</strong> You created a marble owner in the previous step. Now
create a marble belonging to this owner. Perform this from peer0 of
Org1, so from Terminal session 1, switch to Peer0 of Org1MSP:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">source</span> <span class="n">scripts</span><span class="o">/</span><span class="n">setpeer</span> <span class="mi">1</span> <span class="mi">0</span>
<span class="n">CORE_PEER_TLS_KEY_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">key</span>
<span class="n">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="n">Org1MSP</span>
<span class="n">CORE_PEER_TLS_ENABLED</span><span class="o">=</span><span class="nb">true</span>
<span class="n">CORE_PEER_TLS_CERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ID</span><span class="o">=</span><span class="n">cli</span>
<span class="n">CORE_PEER_MSPCONFIGPATH</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">Admin</span><span class="p">@</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">msp</span>
<span class="n">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">marblesinc</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">ca</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ADDRESS</span><span class="o">=</span><span class="n">peer0</span><span class="p">.</span><span class="n">marblesinc</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7051</span>
<span class="n">CORE_VM_ENDPOINT</span><span class="o">=</span><span class="nl">unix</span><span class="p">:</span><span class="c1">///host/var/run/docker.sock</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 10.7:</strong> Now enter the command to create a new marble for John:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">chaincode</span> <span class="n">invoke</span> <span class="o">-</span><span class="n">n</span> <span class="n">marbles</span> <span class="o">-</span><span class="n">c</span> <span class="err">&#39;</span><span class="p">{</span><span class="s">&quot;Args&quot;</span><span class="o">:</span><span class="p">[</span><span class="s">&quot;init_marble&quot;</span><span class="p">,</span><span class="s">&quot;m0000000000001&quot;</span><span class="p">,</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="s">&quot;35&quot;</span><span class="p">,</span><span class="s">&quot;o0000000000001&quot;</span><span class="p">,</span><span class="s">&quot;Marbles Inc&quot;</span><span class="p">]}</span><span class="err">&#39;</span> <span class="n">$FABRIC_TLS</span> <span class="o">-</span><span class="n">C</span> <span class="n">$CHANNEL_NAME</span> 
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mf">11.744</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Retrieved</span> <span class="n">channel</span> <span class="p">(</span><span class="n">mychannel</span><span class="p">)</span> <span class="n">orderer</span> <span class="nl">endpoint</span><span class="p">:</span> <span class="n">orderer</span><span class="p">.</span><span class="n">blockchain</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7050</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">40</span><span class="o">:</span><span class="mf">29.338</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">chaincodeInvokeOrQuery</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">002</span> <span class="n">Chaincode</span> <span class="n">invoke</span> <span class="n">successful</span><span class="p">.</span> <span class="nl">result</span><span class="p">:</span> <span class="nl">status</span><span class="p">:</span><span class="mi">200</span> 
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p>This time you called the <em>init_marble</em> function. Now you have created
one owner, and one marble.</p>
<p>The owner is <em>John</em> (or your custom name) and his id is
<em>o0000000000001</em>, and his marble has an id of <em>m0000000000001</em>. I
cleverly decided that the letter '<em>o</em>' stands for owner and the letter
'<em>m</em>' stands for marbles. I put 12 leading zeros in front of the number
1 in case you wanted to stay late and create trillions of marbles and
owners.</p>
<p><strong>Step 10.8:</strong> In Terminal session 2, issue the command to see that you
have two Docker chaincode images:</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~$  docker images dev-*</span>
<span class="err">REPOSITORY                                                                                                 TAG                 IMAGE ID            CREATED             SIZE</span>
<span class="err">dev-peer0.marblesinc.com-marbles-1.0-4077677f13838bacbfd8ff943e7348c00f3c4d6ca6e2838efd14204ca87ea12b      latest              ab7f5fa821ee        36 seconds ago      137MB</span>
<span class="err">dev-peer0.unitedmarbles.com-marbles-1.0-7e92f069adb7469939a96dcba723fa2019745461f05a562e81cec38e46424aa1   latest              d41acea306aa        8 minutes ago       137MB</span>
<span class="err">bcuser@ubuntu18042:~$</span>
</code></pre></div>

<p><strong>Step 10.9:</strong> In Terminal session 2, issue the command to see that you
have two Docker chaincode containers:</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~$ docker ps --no-trunc | grep dev-*</span>
<span class="err">a7d6b658a35a5f7f82d489f6f797a0463739cb7297cc083875cd6e232600a061   dev-peer0.marblesinc.com-marbles-1.0-4077677f13838bacbfd8ff943e7348c00f3c4d6ca6e2838efd14204ca87ea12b      &quot;chaincode -peer.address=peer0.marblesinc.com:7052&quot;                                                                                                                                                                                                                   About a minute ago   Up About a minute                                                                               dev-peer0.marblesinc.com-marbles-1.0</span>
<span class="err">62a185d148d2a0ead43120ca50e3ed459a2a005b08b10ece0c4ae205bf1f016a   dev-peer0.unitedmarbles.com-marbles-1.0-7e92f069adb7469939a96dcba723fa2019745461f05a562e81cec38e46424aa1   &quot;chaincode -peer.address=peer0.unitedmarbles.com:7052&quot;                                                                                                                                                                                                                8 minutes ago        Up 8 minutes                                                                                    dev-peer0.unitedmarbles.com-marbles-1.0</span>
<span class="err">bcuser@ubuntu18042:~$</span>
</code></pre></div>

<p><strong>Step 10.10:</strong> You will create a new owner now. From Terminal Session
1, try it on Peer 1 of Org0MSP:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">source</span> <span class="n">scripts</span><span class="o">/</span><span class="n">setpeer</span> <span class="mi">0</span> <span class="mi">1</span>
<span class="n">CORE_PEER_TLS_KEY_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">key</span>
<span class="n">CORE_PEER_LOCALMSPID</span><span class="o">=</span><span class="n">Org0MSP</span>
<span class="n">CORE_PEER_TLS_ENABLED</span><span class="o">=</span><span class="nb">true</span>
<span class="n">CORE_PEER_TLS_CERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer0</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">server</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ID</span><span class="o">=</span><span class="n">cli</span>
<span class="n">CORE_PEER_MSPCONFIGPATH</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">users</span><span class="o">/</span><span class="n">Admin</span><span class="p">@</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">msp</span>
<span class="n">CORE_PEER_TLS_ROOTCERT_FILE</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="o">/</span><span class="n">crypto</span><span class="o">/</span><span class="n">peerOrganizations</span><span class="o">/</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">peers</span><span class="o">/</span><span class="n">peer1</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">ca</span><span class="p">.</span><span class="n">crt</span>
<span class="n">CORE_PEER_ADDRESS</span><span class="o">=</span><span class="n">peer1</span><span class="p">.</span><span class="n">unitedmarbles</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7051</span>
<span class="n">CORE_VM_ENDPOINT</span><span class="o">=</span><span class="nl">unix</span><span class="p">:</span><span class="c1">///host/var/run/docker.sock</span>
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 10.11:</strong> </p>
<div class="admonition note">
<p class="admonition-title">Note<p><strong>The command in this step is intended to fail. Go ahead and enter it and then read on for why it failed and how to correct the failure</strong></p>
</p>
</div>
<p>Run this commnand to try to create a new owner:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">chaincode</span> <span class="n">invoke</span> <span class="o">-</span><span class="n">n</span> <span class="n">marbles</span> <span class="o">-</span><span class="n">c</span> <span class="err">&#39;</span><span class="p">{</span><span class="s">&quot;Args&quot;</span><span class="o">:</span><span class="p">[</span><span class="s">&quot;init_owner&quot;</span><span class="p">,</span><span class="s">&quot;o0000000000002&quot;</span><span class="p">,</span><span class="s">&quot;Barry&quot;</span><span class="p">,</span><span class="s">&quot;United Marbles&quot;</span><span class="p">]}</span><span class="err">&#39;</span> <span class="n">$FABRIC_TLS</span> <span class="o">-</span><span class="n">C</span> <span class="n">$CHANNEL_NAME</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mf">18.425</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Retrieved</span> <span class="n">channel</span> <span class="p">(</span><span class="n">mychannel</span><span class="p">)</span> <span class="n">orderer</span> <span class="nl">endpoint</span><span class="p">:</span> <span class="n">orderer</span><span class="p">.</span><span class="n">blockchain</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7050</span>
<span class="nl">Error</span><span class="p">:</span> <span class="n">endorsement</span> <span class="n">failure</span> <span class="n">during</span> <span class="n">invoke</span><span class="p">.</span> <span class="nl">response</span><span class="p">:</span> <span class="nl">status</span><span class="p">:</span><span class="mi">500</span> <span class="nl">message</span><span class="p">:</span><span class="s">&quot;cannot retrieve package for chaincode marbles/1.0, error open /var/hyperledger/production/chaincodes/marbles.1.0: no such file or directory&quot;</span> 
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p>What do you expect to happen when you enter this command?</p>
<p>If you have followed these instructions exactly so far, the <em>invoke</em>
will fail. It will fail because you have not yet installed the chaincode
on Peer 1 of Org0. Here is the output which shows the error:</p>
<div class="codehilite"><pre><span></span><code><span class="mi">2019</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">28</span><span class="w"> </span><span class="mi">19</span><span class="err">:</span><span class="mi">43</span><span class="err">:</span><span class="mf">18.425</span><span class="w"> </span><span class="n">UTC</span><span class="w"> </span><span class="o">[</span><span class="n">chaincodeCmd</span><span class="o">]</span><span class="w"> </span><span class="n">InitCmdFactory</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">INFO</span><span class="w"> </span><span class="mi">001</span><span class="w"> </span><span class="n">Retrieved</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="p">(</span><span class="n">mychannel</span><span class="p">)</span><span class="w"> </span><span class="n">orderer</span><span class="w"> </span><span class="nl">endpoint</span><span class="p">:</span><span class="w"> </span><span class="n">orderer</span><span class="p">.</span><span class="n">blockchain</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7050</span><span class="w"></span>
<span class="nl">Error</span><span class="p">:</span><span class="w"> </span><span class="n">endorsement</span><span class="w"> </span><span class="n">failure</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">invoke</span><span class="p">.</span><span class="w"> </span><span class="nl">response</span><span class="p">:</span><span class="w"> </span><span class="nl">status</span><span class="p">:</span><span class="mi">500</span><span class="w"> </span><span class="nl">message</span><span class="p">:</span><span class="ss">&quot;cannot retrieve package for chaincode marbles/1.0, error open /var/hyperledger/production/chaincodes/marbles.1.0: no such file or directory&quot;</span><span class="w"></span>
</code></pre></div>

<p>You must first <em>install</em> chaincode on a peer not only before you can do
an <em>instantiate</em> from that peer, but also before you can do an <em>invoke</em>
or <em>query</em> from that peer. If you want a peer to perform the endorsing
function for a transaction, the chaincode for that transaction must be
installed on that peer. If that peer is a member of the channel on which
the chaincode is instantiated, but has not had the chaincode installed
on it, it will still perform the committer function and update its copy
of the channel's ledger when it receives valid transactions from the
orderer, but it cannot endorse transaction proposals unless the
chaincode has been installed on it.</p>
<p><strong>Step 10.12</strong>: Correct things by installing the chaincode on peer1 of
Org0. In Terminal session 1, enter this command, which should look
familiar to you:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">chaincode</span> <span class="n">install</span> <span class="o">-</span><span class="n">n</span> <span class="n">marbles</span> <span class="o">-</span><span class="n">v1</span><span class="mf">.0</span> <span class="o">-</span><span class="n">p</span> <span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">chaincode</span><span class="o">/</span><span class="n">go</span><span class="o">/</span><span class="n">marbles</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">44</span><span class="o">:</span><span class="mf">56.984</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">checkChaincodeCmdParams</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Using</span> <span class="k">default</span> <span class="n">escc</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">44</span><span class="o">:</span><span class="mf">56.984</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">checkChaincodeCmdParams</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">002</span> <span class="n">Using</span> <span class="k">default</span> <span class="n">vscc</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">44</span><span class="o">:</span><span class="mf">57.189</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">install</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">003</span> <span class="n">Installed</span> <span class="n">remotely</span> <span class="nl">response</span><span class="p">:</span><span class="o">&lt;</span><span class="nl">status</span><span class="p">:</span><span class="mi">200</span> <span class="nl">payload</span><span class="p">:</span><span class="s">&quot;OK&quot;</span> <span class="o">&gt;</span> 
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 10.13:</strong> Now, in Terminal session 1, repeat the <em>peer chaincode
invoke</em> command from <em>Step 10.9</em>. It should work this time:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">peer</span> <span class="n">chaincode</span> <span class="n">invoke</span> <span class="o">-</span><span class="n">n</span> <span class="n">marbles</span> <span class="o">-</span><span class="n">c</span> <span class="err">&#39;</span><span class="p">{</span><span class="s">&quot;Args&quot;</span><span class="o">:</span><span class="p">[</span><span class="s">&quot;init_owner&quot;</span><span class="p">,</span><span class="s">&quot;o0000000000002&quot;</span><span class="p">,</span><span class="s">&quot;Barry&quot;</span><span class="p">,</span><span class="s">&quot;United Marbles&quot;</span><span class="p">]}</span><span class="err">&#39;</span> <span class="n">$FABRIC_TLS</span> <span class="o">-</span><span class="n">C</span> <span class="n">$CHANNEL_NAME</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">45</span><span class="o">:</span><span class="mf">34.761</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">InitCmdFactory</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">001</span> <span class="n">Retrieved</span> <span class="n">channel</span> <span class="p">(</span><span class="n">mychannel</span><span class="p">)</span> <span class="n">orderer</span> <span class="nl">endpoint</span><span class="p">:</span> <span class="n">orderer</span><span class="p">.</span><span class="n">blockchain</span><span class="p">.</span><span class="nl">com</span><span class="p">:</span><span class="mi">7050</span>
<span class="mi">2019</span><span class="mo">-04</span><span class="mi">-28</span> <span class="mi">19</span><span class="o">:</span><span class="mi">45</span><span class="o">:</span><span class="mf">51.745</span> <span class="n">UTC</span> <span class="p">[</span><span class="n">chaincodeCmd</span><span class="p">]</span> <span class="n">chaincodeInvokeOrQuery</span> <span class="o">-&gt;</span> <span class="n">INFO</span> <span class="mo">002</span> <span class="n">Chaincode</span> <span class="n">invoke</span> <span class="n">successful</span><span class="p">.</span> <span class="nl">result</span><span class="p">:</span> <span class="nl">status</span><span class="p">:</span><span class="mi">200</span> 
<span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span>
</code></pre></div>

<p><strong>Step 10.14:</strong> Go back to Terminal session 2 and enter the Docker
command that will show you that you now have your third
chaincode-related Docker image, the one just built for peer1 of Org0:</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~$ docker images dev-*</span>
<span class="err">REPOSITORY                                                                                                 TAG                 IMAGE ID            CREATED             SIZE</span>
<span class="err">dev-peer1.unitedmarbles.com-marbles-1.0-dea1aa08dc7c6f282a31dd498670173c21d3e75ef0ef1d170b95e1212fbacb77   latest              c0e41de218a2        30 seconds ago      137MB</span>
<span class="err">dev-peer0.marblesinc.com-marbles-1.0-4077677f13838bacbfd8ff943e7348c00f3c4d6ca6e2838efd14204ca87ea12b      latest              ab7f5fa821ee        5 minutes ago       137MB</span>
<span class="err">dev-peer0.unitedmarbles.com-marbles-1.0-7e92f069adb7469939a96dcba723fa2019745461f05a562e81cec38e46424aa1   latest              d41acea306aa        13 minutes ago      137MB</span>
<span class="err">bcuser@ubuntu18042:~$</span>
</code></pre></div>

<p><strong>Step 10.15:</strong> Enter the Docker command that will show you that you now
have your third chaincode-related Docker container, the one just built
for peer1 of Org0:</p>
<div class="codehilite"><pre><span></span><code><span class="err">bcuser@ubuntu18042:~$ docker ps --no-trunc | grep dev-</span>
<span class="err">1e5c05183d6f77f4ca1264bd26b996189c5665031ad007d3cdfa28fb5c1a81f9   dev-peer1.unitedmarbles.com-marbles-1.0-dea1aa08dc7c6f282a31dd498670173c21d3e75ef0ef1d170b95e1212fbacb77   &quot;chaincode -peer.address=peer1.unitedmarbles.com:7052&quot;                                                                                                                                                                                                                59 seconds ago      Up 57 seconds                                                                                   dev-peer1.unitedmarbles.com-marbles-1.0</span>
<span class="err">a7d6b658a35a5f7f82d489f6f797a0463739cb7297cc083875cd6e232600a061   dev-peer0.marblesinc.com-marbles-1.0-4077677f13838bacbfd8ff943e7348c00f3c4d6ca6e2838efd14204ca87ea12b      &quot;chaincode -peer.address=peer0.marblesinc.com:7052&quot;                                                                                                                                                                                                                   6 minutes ago       Up 6 minutes                                                                                    dev-peer0.marblesinc.com-marbles-1.0</span>
<span class="err">62a185d148d2a0ead43120ca50e3ed459a2a005b08b10ece0c4ae205bf1f016a   dev-peer0.unitedmarbles.com-marbles-1.0-7e92f069adb7469939a96dcba723fa2019745461f05a562e81cec38e46424aa1   &quot;chaincode -peer.address=peer0.unitedmarbles.com:7052&quot;                                                                                                                                                                                                                14 minutes ago      Up 14 minutes                                                                                   dev-peer0.unitedmarbles.com-marbles-1.0</span>
<span class="err">bcuser@ubuntu18042:~$</span>
</code></pre></div>

<p><strong>Step 10.16:</strong> Try some additional chaincode invocations. You have had
enough experience switching between peers with <em>source scripts/setpeer</em>
and issuing the <em>peer chaincode invoke</em> command that I will not show the
output, nor tell you from which peer you should enter your command. I
will just list several more commands you can run against the marbles
chaincode. Feel free to switch amongst the four peers as you see fit
before you enter each command. Note however, that you have only
installed the chaincode on three of the four peers, so if you choose
that fourth peer, you will need to install the chaincode there first. I
won't tell you which peer does not currently have the chaincode
installed, but if you need a hint, it is the one that does not have a
Docker image built yet for its chaincode. (Note that checking for the
absence of a Docker image for a peer is not, by itself,proof that you
have not installed the chaincode on that peer- the Docker image is not
built until you first invoke a function against the chaincode on that
peer).</p>
<p>If you are ambitious and want to install the chaincode on that fourth
peer, try the useful Docker commands I have shown you from Terminal Session
2 to see that the chaincode's Docker image and Docker container are
created when you invoke a transaction on that fourth peer.</p>
<p>Try some or all of these commands from Terminal session 1:</p>
<p>Create a marble for Barry, i.e., owner o0000000000002:</p>
<div class="codehilite"><pre><span></span><code><span class="err">peer chaincode invoke -n marbles -c &#39;{&quot;Args&quot;:[&quot;init_marble&quot;,&quot;m0000000000002&quot;,&quot;green&quot;,&quot;50&quot;,&quot;o0000000000002&quot;,&quot;United Marbles&quot;]}&#39; $FABRIC_TLS -C $CHANNEL_NAME</span>
</code></pre></div>

<p>Obtain all marble information- marbles and owners:</p>
<div class="codehilite"><pre><span></span><code><span class="err">peer chaincode invoke -n marbles -c &#39;{&quot;Args&quot;:[&quot;read_everything&quot;]}&#39; $FABRIC_TLS -C $CHANNEL_NAME</span>
</code></pre></div>

<p>Change marble ownership- 'Barry' is giving his marble to 'John':</p>
<div class="codehilite"><pre><span></span><code><span class="err">peer chaincode invoke -n marbles -c &#39;{&quot;Args&quot;:[&quot;set_owner&quot;,&quot;m0000000000002&quot;,&quot;o0000000000001&quot;,&quot;United Marbles&quot;]}&#39; $FABRIC_TLS -C $CHANNEL_NAME</span>
</code></pre></div>

<p>Get the history of marble 'm0000000000002':</p>
<div class="codehilite"><pre><span></span><code><span class="err">peer chaincode invoke -n marbles -c &#39;{&quot;Args&quot;:[&quot;getHistory&quot;,&quot;m0000000000002&quot;]}&#39; $FABRIC_TLS -C $CHANNEL_NAME</span>
</code></pre></div>

<p>Delete marble 'm0000000000002':</p>
<div class="codehilite"><pre><span></span><code><span class="err">peer chaincode invoke -n marbles -c &#39;{&quot;Args&quot;:[&quot;delete_marble&quot;,&quot;m0000000000002&quot;,&quot;Marbles Inc&quot;]}&#39; $FABRIC_TLS -C $CHANNEL_NAME</span>
</code></pre></div>

<p>Try again to get the history of marble 'm0000000000002' after you just
deleted it:</p>
<div class="codehilite"><pre><span></span><code><span class="err">peer chaincode invoke -n marbles -c &#39;{&quot;Args&quot;:[&quot;getHistory&quot;,&quot;m0000000000002&quot;]}&#39; $FABRIC_TLS -C $CHANNEL_NAME</span>
</code></pre></div>

<p>Obtain all marble information again. See if it matches your expectations
based on the commands you have entered:</p>
<div class="codehilite"><pre><span></span><code><span class="err">peer chaincode invoke -n marbles -c &#39;{&quot;Args&quot;:[&quot;read_everything&quot;]}&#39; $FABRIC_TLS -C $CHANNEL_NAME</span>
</code></pre></div>

<p><strong>Step 10.17:</strong> Exit the <em>cli</em> Docker container from Terminal session 1.
Your command prompt should change to reflect that you are now back at
your Linux on IBM Z host prompt and no longer in the Docker container:</p>
<div class="codehilite"><pre><span></span><code><span class="n">root</span><span class="mi">@84</span><span class="nl">b6c0ee74aa</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">gopath</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">fabric</span><span class="o">/</span><span class="n">peer</span><span class="err">#</span> <span class="n">exit</span>
<span class="n">exit</span>
<span class="n">bcuser</span><span class="p">@</span><span class="nl">ubuntu18042</span><span class="p">:</span><span class="o">~/</span><span class="n">zmarbles$</span>
</code></pre></div>

<p><strong>Step 10.18:</strong> Congratulations for making it through the treacherous
portion of the lab! </p>
<p>Stay logged in to your two terminal sessions and leave your Hyperledger
Fabric network and all the chaincode Docker containers up and running-
you will use what you created here in Part 2 of the lab where you will
install a front-end application offering a browser-based UI from which
you will interact with the marbles chaincode that you have installed in
here in Part 1.</p>
<p><strong>Continue to Part 2 of the lab now.</strong></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="../assets/javascripts/bundle.9554a270.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>