



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>Hlf part2 - Blockchain Immersion Workshop</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.30686662.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#section-1-lab-part-2-overview" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Blockchain Immersion Workshop" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Blockchain Immersion Workshop
            </span>
            <span class="md-header-nav__topic">
              
                Hlf part2
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/ibm-blockchain-wsc/ImmersionWorkshop.git" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Blockchain Immersion Workshop" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Blockchain Immersion Workshop
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/ibm-blockchain-wsc/ImmersionWorkshop.git" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      IBM Blockchain Platform v2.1.3 on Linux on IBM Z Lab
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        IBM Blockchain Platform v2.1.3 on Linux on IBM Z Lab
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../ibpconsole/" title="Part 1 - Create a Blockchain Network" class="md-nav__link">
      Part 1 - Create a Blockchain Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ibpdeploy/" title="Part 2 - Deploy Smart Contract" class="md-nav__link">
      Part 2 - Deploy Smart Contract
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../references/" title="Additional Resources" class="md-nav__link">
      Additional Resources
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="section-1-lab-part-2-overview">Section 1: Lab Part 2 Overview</h1>
<p>In this part of the lab, you will use the Hyperledger Fabric network that you
created in the Part 1 of the lab and configure the Marbles User Interface
(UI) web application so that it will integrate with the marbles
chaincode that you installed in the previous lab.</p>
<p>You will use two browser sessions to simulate acting as a user for each
of the two organizations in the network- <em>United Marbles</em> and <em>Marbles
Inc</em>.</p>
<p>Then you can explore the Marbles UI to execute chaincode transactions
and see some of the Hyperledger Fabric concepts in action.</p>
<h1 id="section-2-marbles-user-interface-setup">Section 2: Marbles user interface setup</h1>
<p><strong>Step 2.1:</strong> Switch to the <em>~/zmarbles/marblesUI</em> directory:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles$ cd ~/zmarbles/marblesUI
bcuser@ubuntu18042:~/zmarbles/marblesUI$
</code></pre>
<p><strong>Step 2.2:</strong> You will need to do an <em>npm install</em> to install the
packages needed by the Marbles user interface. First you will verify
that the <em>node_modules</em> directory does not exist. This directory will
be created when you run an npm <em>install</em> in the next step, so right now
it shouldn't exist:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles/marblesUI$ ls -l node_modules
ls: cannot access 'node_modules': No such file or directory
bcuser@ubuntu18042:~/zmarbles/marblesUI$
</code></pre>
<p><strong>Step 2.3:</strong> Now run the <em>npm install</em>:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles/marblesUI$ npm install
  .
  .  (output not shown here)
  .
</code></pre>
<p><strong>Step 2.4:</strong> When this command ends, list the <em>node_modules</em> directory
again. It is there now:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles/marblesUI$ ls -l node_modules
  .
  .  (output not shown here)
  .
bcuser@ubuntu18042:~/zmarbles/marblesUI$
</code></pre>
<p><strong>Step 2.5:</strong> Change to the <em>config</em> directory:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles/marblesUI$ cd config
bcuser@ubuntu18042:~/zmarbles/marblesUI/config$
</code></pre>
<p><strong>Step 2.6:</strong> There are four files in this directory:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles/marblesUI/config$ ls
connection_profile1.json  connection_profile2.json  marbles1.json  marbles2.json
bcuser@ubuntu18042:~/zmarbles/marblesUI/config$
</code></pre>
<p><strong>Step 2.7:</strong> There are two files for the first fictitious company,
<em>United Marbles</em>, and two files for the second fictitious company,
<em>Marbles Inc.</em> Look at the <em>marbles1.json</em> file with the <em>cat</em> command:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles/marblesUI/config$ cat marbles1.json 
{
    "cred_filename": "connection_profile1.json",
    "use_events": false,
    "keep_alive_secs": 120,
    "company": "United Marbles",
    "usernames": [
        "amy",
        "alice",
        "ava"
    ],
    "port": 3001,
    "last_startup_hash": ""
}
bcuser@ubuntu18042:~/zmarbles/marblesUI/config$
</code></pre>
<p><strong>Step 2.8:</strong> Notice that this file points to one of the other existing
files, <em>connection_profile1.json</em>, as the value of the <em>cred_filename</em>
name/value pair. You will look at that in a moment. Take a note of the
usernames array- <em>amy</em>, <em>alice</em>, and <em>ava</em>. If you are comfortable with
the <em>vi</em> editor you could change those names to your favorite names if
you would like. You can also use the <em>sed</em> command to change the name
inline without entering <em>vi</em>. Here is an example of a command to change
the name <em>alice</em> to <em>vincent</em>. <strong>This step is optional- you do not have
to do this is you prefer the name alice to vincent</strong>:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles/marblesUI/config$ sed -i "s/alice/vincent/" marbles1.json   # optional
bcuser@ubuntu18042:~/zmarbles/marblesUI/config$
</code></pre>
<p><strong>Step 2.9:</strong> Here is the file after I changed <em>alice</em> to <em>vincent</em> with
the previous sed command:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles/marblesUI/config$ cat marbles1.json 
{
    "cred_filename": "connection_profile1.json",
    "use_events": false,
    "keep_alive_secs": 120,
    "company": "United Marbles",
    "usernames": [
        "amy",
        "vincent",
        "ava"
    ],
    "port": 3001,
    "last_startup_hash": ""
}
bcuser@ubuntu18042:~/zmarbles/marblesUI/config$
</code></pre>
<p><strong>NOTE:</strong> Your file will look different if you choose to skip the
optional <em>Step 2.9</em> or if you made changes other than the example change
I showed. The purpose of this step is to ensure that your file changed
the way you intended it to (if it changed at all).</p>
<p>The other key thing to note is the port number. It is <em>3001</em> here. In
the <em>marbles2.json</em> file for <em>Marbles Inc</em>, port <em>3002</em> will be
specified. This is how, later in this lab, you will pretend to be a user
of one company or the other- by using port 3001 in the URL to pretend to
be a "United Marbles" user and by using port 3002 in the URL to pretend
to be a "Marbles Inc" user.</p>
<p><strong>Step 2.10:</strong> It is time to look at the main configuration file the
Marbles app uses. It is the file specified as the <em>cred_filename</em> value
in the <em>marbles1.json</em> file. This name <em>cred_filename</em> for the JSON
name/value pair and the filename, <em>blockchain_creds1.json</em>, indicate
that security credentials are specified in this file, and they are, but
actually information about the Hyperledger Fabric network itself is
specified in this file as well. This file is too large to fit in one
screen, so I will teach you one more Linux command, named <em>more</em>. (Pun
intended). Type this:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles/marblesUI/config$ more connection_profile1.json
  .
  .  (output not shown)
  .
bcuser@ubuntu18042:~/zmarbles/marblesUI/config$
</code></pre>
<p>This command will print as much of the file as it can on your screen but
will pause until you hit the space bar before displaying the rest of the file's
contents. Here are the complete contents of this file:</p>
<pre><code>{
   "name": "Docker Compose Network",
   "x-networkId": "not-important",
   "x-type": "hlfv1",
   "description": "Connection Profile for an IBM Blockchain Network",
   "version": "1.0.0",
   "client": {
       "organization": "Org0MSP"
   },
   "channels": {
       "mychannel": {
           "orderers": [
               "fabric-orderer"
           ],
           "peers": {  
               "fabric-peer-org1" : {
                                   "x-chaincode": {}
                                }
           },
           "chaincodes": [
               "marbles:v4"
           ],
           "x-blockDelay": 1000
       }
   },
   "organizations": {
       "Org0MSP": {
           "mspid": "Org0MSP",
           "peers": [
               "fabric-peer-org1"
           ],
           "certificateAuthorities": [
               "fabric-ca-org1"
           ]
       }
   },
   "orderers": {
       "fabric-orderer": {
           "url": "grpcs://localhost:7050",
           "grpcOptions": {
               "ssl-target-name-override": "orderer.blockchain.com",
               "grpc.http2.keepalive_time": 300,
               "grpc.keepalive_time_ms": 300000,
               "grpc.http2.keepalive_timeout": 35,
               "grpc.keepalive_timeout_ms": 3500
           },
           "tlsCACerts": {
               "path": "../../crypto-config/ordererOrganizations/blockchain.com/orderers/orderer.blockchain.com/tls/ca.crt"
           }
       }

   },
   "peers": {
       "fabric-peer-org1": {
           "url": "grpcs://localhost:7051",
           "eventUrl": "grpcs://localhost:7053",
           "grpcOptions": {
               "ssl-target-name-override": "peer0.unitedmarbles.com",
               "grpc.http2.keepalive_time": 300,
               "grpc.keepalive_time_ms": 300000,
               "grpc.http2.keepalive_timeout": 35,
               "grpc.keepalive_timeout_ms": 3500
           },
           "tlsCACerts": {
               "path": "../../crypto-config/peerOrganizations/unitedmarbles.com/peers/peer0.unitedmarbles.com/tls/ca.crt"
           }
       }
   },
   "certificateAuthorities": {
       "fabric-ca-org1": {
           "url": "https://localhost:7054",
           "httpOptions": {
               "ssl-target-name-override": "ca.unitedmarbles.com",
               "verify": true
           },
           "tlsCACerts": {
               "path": "../../crypto-config/peerOrganizations/unitedmarbles.com/ca/ca.unitedmarbles.com-cert.pem"
           },
           "registrar": [
               {
                   "enrollId": "admin",
                   "enrollSecret": "adminpw"
               }
           ],
           "caName": "ca-org0"
       }
   }
}
</code></pre>
<p>This is a standard Hyperledger Fabric connection profile. This lab does
not use Hyperledger Composer, but I think the Hyperledger Composer team
did a nice job describing Hyperledger Fabric connection profiles, as
they use them too. See
<a href="https://hyperledger.github.io/composer/latest/reference/connectionprofile">https://hyperledger.github.io/composer/latest/reference/connectionprofile</a>
for their description. They also reference a link in the Hyperledger
Fabric Node.js SDK documentation at
<a href="https://fabric-sdk-node.github.io/tutorial-network-config.html">https://fabric-sdk-node.github.io/tutorial-network-config.html</a> which
is a little more advanced, and it describes the profile in YAML form
versus the JSON form that this Marbles demo app uses.</p>
<div class="admonition important">
<p class="admonition-title">Important<p>If you used a channel name other than the default of mychannel, you must change this value from mychannel to the value you used.<strong> Either use the <em>vi</em> editor if you are comfortable with that, or, you could use <em>sed</em>. For example, below there is a <em>sed</em> command, to change the channel name from <em>mychannel</em> to <em>tim</em>, along with "before" and "after" <em>grep</em> commands to show the changes </strong>(These commands are examples and only needed if you did not use the default channel name of mychannel)** </p>
</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning<p>This step is necessary only if you did not use this lab's default channel name of <em>mychannel</em>
earlier in Part 1 of this lab. And of course, this example shows the steps for changing the
channel name to <em>tim</em>, so tailor the command shown here according to whatever <em>non-default</em> 
channel name you may have chosen.</p>
</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning<p>Unlike most steps in this lab, there are three commands to enter in this step, two <em>greps</em> and a <em>sed</em> (hey, that sounds like a good name for a television show).  But, again, and I can't emphasize this enough, don't run the commands in this step if you kept your channel name as the default value of <em>mychannel</em>.</p>
</p>
</div>
<pre><code>
    bcuser@ubuntu18042:~/zmarbles/marblesUI/config$ grep mychannel connection_profile[12].json 
    blockchain_creds1.json:            &quot;channel_id&quot;: &quot;mychannel&quot;,
    blockchain_creds2.json:            &quot;channel_id&quot;: &quot;mychannel&quot;, 
    bcuser@ubuntu18042:~/zmarbles/marblesUI/config$ sed -i &quot;s/mychannel/tim/&quot; connection_profile[12].json 
    bcuser@ubuntu18042:~/zmarbles/marblesUI/config$ grep -1 channels connection_profile[12].json 
    connection_profile1.json-  },
    connection_profile1.json:  &quot;channels&quot;: {
    connection_profile1.json-      &quot;tim&quot;: {
    --
    connection_profile2.json-  },
    connection_profile2.json:  &quot;channels&quot;: {
    connection_profile2.json-      &quot;tim&quot;: {
    bcuser@ubuntu18042:~/zmarbles/marblesUI/config$ 

</code></pre>

<p><strong>Step 2.11:</strong> The considerations for <em>marbles2.json</em> and
<em>connection_profile2.json</em> are the same as for <em>marbles1.json</em> and
<em>connection_profile1.json</em> except that they apply to "Marbles Inc."
instead of "United Marbles". If you would like to compare the
differences between <em>connection_profile1.json</em> and
<em>connection_profile2.json</em>, try the <em>diff</em> command and observe its
output. This command lists sections of the two files that it finds
different. The lines from the first file, <em>blockchain_creds1.json</em>,
start with '&lt;' (added by the diff command output, not in the actual
file), and the lines from the second file, <em>blockchain_creds2.json</em>,
start with '>':</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles/marblesUI/config$ diff connection_profile1.json connection_profile2.json 
8c8
&lt;       "organization": "Org0MSP"
---
&gt;       "organization": "Org1MSP"
16c16
&lt;               "fabric-peer-org1" : {
---
&gt;               "fabric-peer-org2" : {
27,28c27,28
&lt;       "Org0MSP": {
&lt;           "mspid": "Org0MSP",
---
&gt;       "Org1MSP": {
&gt;           "mspid": "Org1MSP",
30c30
&lt;               "fabric-peer-org1"
---
&gt;               "fabric-peer-org2"
33c33
&lt;               "fabric-ca-org1"
---
&gt;               "fabric-ca-org2"
54,56c54,56
&lt;       "fabric-peer-org1": {
&lt;           "url": "grpcs://localhost:7051",
&lt;           "eventUrl": "grpcs://localhost:7053",
---
&gt;       "fabric-peer-org2": {
&gt;           "url": "grpcs://localhost:9051",
&gt;           "eventUrl": "grpcs://localhost:9053",
58c58
&lt;               "ssl-target-name-override": "peer0.unitedmarbles.com",
---
&gt;               "ssl-target-name-override": "peer0.marblesinc.com",
65c65
&lt;               "path": "../../crypto-config/peerOrganizations/unitedmarbles.com/peers/peer0.unitedmarbles.com/tls/ca.crt"
---
&gt;               "path": "../../crypto-config/peerOrganizations/marblesinc.com/peers/peer0.marblesinc.com/tls/ca.crt"
70,71c70,71
&lt;       "fabric-ca-org1": {
&lt;           "url": "https://localhost:7054",
---
&gt;       "fabric-ca-org2": {
&gt;           "url": "https://localhost:8054",
73c73
&lt;               "ssl-target-name-override": "ca.unitedmarbles.com",
---
&gt;               "ssl-target-name-override": "ca.marblesinc.com",
77c77
&lt;               "path": "../../crypto-config/peerOrganizations/unitedmarbles.com/ca/ca.unitedmarbles.com-cert.pem"
---
&gt;               "path": "../../crypto-config/peerOrganizations/marblesinc.com/ca/ca.marblesinc.com-cert.pem"
81,82c81,82
&lt;                   "enrollId": "admin",
&lt;                   "enrollSecret": "adminpw"
---
&gt;                   "enrollId": "admin2",
&gt;                   "enrollSecret": "adminpw2"
85c85
&lt;           "caName": "ca-org0"
---
&gt;           "caName": "ca-org1"
bcuser@ubuntu18042:~/zmarbles/marblesUI/config$
</code></pre>
<h1 id="section-3-start-the-marbles-user-interface">Section 3: Start the Marbles user interface</h1>
<p>In this section, you will use the Marbles user interface. You will start
two browser sessions- one will be as a "United Marbles" user, and the
other as a "Marbles Inc" user. Here in this lab, you are serving both
companies' applications from the same server, so you will differentiate
between the two companies by the port number. You will connect to port
3001 when acting as a United Marbles user, and you will connect to port
3002 when acting as a Marbles Inc user. In the real world, each of the
two companies would probably either serve the user interface from their
own server, or perhaps both companies would log in to a server provided
by a service provider- think "Blockchain-as-a-service". The chosen
topology is use-case dependent and beyond the scope of this lab.</p>
<p><strong>Step 3.1:</strong> You are now ready to start the server for UnitedMarbles.
Back up to the <em>~/zmarbles/marblesUI</em> directory:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles/marblesUI/config$ cd ..
bcuser@ubuntu18042:~/zmarbles/marblesUI$
</code></pre>
<p><strong>Step 3.2:</strong> You will now use <em>gulp</em> to start up the server, with this
command:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles/marblesUI$ gulp marbles1
[16:02:03] Using gulpfile ~/zmarbles/marblesUI/gulpfile.js
[16:02:03] Starting 'env_tls'...
[16:02:03] Finished 'env_tls' after 50 μs
[16:02:03] Starting 'build-sass'...
[16:02:03] Finished 'build-sass' after 6.07 ms
[16:02:03] Starting 'watch-sass'...
[16:02:03] Finished 'watch-sass' after 6.36 ms
[16:02:03] Starting 'watch-server'...
[16:02:03] Finished 'watch-server' after 1.98 ms
[16:02:03] Starting 'server'...
info: Checking connection profile is done
info: Loaded config file /home/bcuser/zmarbles/marblesUI/config/marbles1.json
info: Loaded connection profile file /home/bcuser/zmarbles/marblesUI/config/connection_profile1.json



Connection Profile Lib Functions:()
  getNetworkName()
  getNetworkCredFileName()
  buildTlsOpts()
  getFirstChannelId()
  getChannelId()
  loadPem()
  getMarblesField()
  getChaincodeId()
  getChaincodeVersion()
  getFirstCaName()
  getCA()
  getCasUrl()
  getAllCaUrls()
  getCaName()
  getCaTlsCertOpts()
  getEnrollObj()
  getFirstPeerName()
  getPeer()
  getPeersUrl()
  getAllPeerUrls()
  getPeerEventUrl()
  getPeerTlsCertOpts()
  getMarbleUsernamesConfig()
  getCompanyNameFromFile()
  getMarblesPort()
  getEventsSetting()
  getKeepAliveMs()
  getFirstOrdererName()
  getOrderer()
  getOrderersUrl()
  getOrdererTlsCertOpts()
  getBlockDelay()
  getKvsPath()
  getFirstOrg()
  getClientsOrgName()
  getClientOrg()
  getMarbleUsernames()
  getOrgsMSPid()
  getAdminPrivateKeyPEM()
  getAdminSignedCertPEM()


----------------------------------- Server Up - localhost:3001 -----------------------------------
Welcome aboard:  United Marbles
Channel:     mychannel
Org:         Org0MSP
CA:      fabric-ca-org1
Orderer:     fabric-orderer
Peer:        fabric-peer-org1
Chaincode ID:    marbles
Chaincode Version:  v4
------------------------------------------ Websocket Up ------------------------------------------


debug: loading pem from a path: /home/bcuser/zmarbles/crypto-config/peerOrganizations/unitedmarbles.com/ca/ca.unitedmarbles.com-cert.pem
debug: loading pem from a path: /home/bcuser/zmarbles/crypto-config/ordererOrganizations/blockchain.com/orderers/orderer.blockchain.com/tls/ca.crt
debug: loading pem from a path: /home/bcuser/zmarbles/crypto-config/peerOrganizations/unitedmarbles.com/peers/peer0.unitedmarbles.com/tls/ca.crt
info: [fcw] Going to enroll peer_urls=[grpcs://localhost:7051], channel_id=mychannel, uuid=marblesDockerComposeNetworkmychannelOrg0MSPfabricpeerorg1, ca_url=https://localhost:7054, orderer_url=grpcs://localhost:7050, enroll_id=admin, enroll_secret=adminpw, msp_id=Org0MSP, kvs_path=/home/bcuser/.hfc-key-store/marblesDockerComposeNetworkmychannelOrg0MSPfabricpeerorg1
debug: enroll id: "admin", secret: "adminpw"
debug: msp_id:  Org0MSP ca_name: ca-org0
info: [fcw] Successfully enrolled user 'admin'
debug: added peer grpcs://localhost:7051
debug: [fcw] Successfully got enrollment marblesDockerComposeNetworkmychannelOrg0MSPfabricpeerorg1
info: Success enrolling admin
debug: loading pem from a path: /home/bcuser/zmarbles/crypto-config/peerOrganizations/unitedmarbles.com/ca/ca.unitedmarbles.com-cert.pem
debug: loading pem from a path: /home/bcuser/zmarbles/crypto-config/ordererOrganizations/blockchain.com/orderers/orderer.blockchain.com/tls/ca.crt
debug: loading pem from a path: /home/bcuser/zmarbles/crypto-config/peerOrganizations/unitedmarbles.com/peers/peer0.unitedmarbles.com/tls/ca.crt
debug: Checking if chaincode is already instantiated or not 1

info: Checking for chaincode...
debug: [fcw] Querying Chaincode: read()
debug: [fcw] Sending query req: chaincodeId=marbles, fcn=read, args=[selftest], txId=null
debug: [fcw] Peer Query Response - len: 1 type: number
debug: [fcw] Successful query transaction.

----------------------------- Chaincode found on channel "mychannel" -----------------------------


info: Checking chaincode and ui compatibility...
debug: [fcw] Querying Chaincode: read()
debug: [fcw] Sending query req: chaincodeId=marbles, fcn=read, args=[marbles_ui], txId=null
warn: [fcw] warning - query resp is not json, might be okay: string 4.0.1
debug: [fcw] Successful query transaction.
info: Chaincode version is good
info: Checking ledger for marble owners listed in the config file

info: Fetching EVERYTHING...
debug: [fcw] Querying Chaincode: read_everything()
debug: [fcw] Sending query req: chaincodeId=marbles, fcn=read_everything, args=[], txId=null
debug: [fcw] Peer Query Response - len: 529 type: object
debug: [fcw] Successful query transaction.
debug: This company has registered marble owners
debug: Looking for marble owner: amy
debug: Did not find marble username: amy
info: We need to make marble owners


- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
info: Detected that we have NOT launched successfully yet
debug: Open your browser to http://localhost:3001 and login as "admin" to initiate startup
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</code></pre>
<p>The first line of the output just listed reads:</p>
<pre><code>[16:02:03] Using gulpfile ~/zmarbles/marblesUI/gulpfile.js
</code></pre>
<p>I am not going to go into detail on the <em>gulp</em> tool here, but if you are
curious, if you look into the <em>gulpfile.js</em> file (you would have to use
another PuTTY or SSH session as this one is now tied up) you would find
that a <em>marbles1</em> task (<em>marbles1</em> being your argument to the <em>gulp</em>
command) is defined:</p>
<pre><code>gulp.task('marbles1', ['env_tls', 'watch-sass', 'watch-server', 'server']);
</code></pre>
<p>The <em>marbles1</em> task specifies four more tasks to run, the first of which
is <em>env_tls</em>. This task is adding a value to a map named <em>env</em>. This
value points to the <em>marbles1.json</em> file:</p>
<pre><code>gulp.task('env_tls', function () {
       env['creds_filename'] = 'marbles1.json';
});
</code></pre>
<p>The last of the tasks, <em>server</em>, when it is started, is receiving this
map named <em>env</em> as part of its invocation:</p>
<pre><code>gulp.task('server', function(a, b) {
        if(node) node.kill();
        node = spawn('node', ['app.js'], {env: env, stdio: 'inherit'}); //command, file, options
});
</code></pre>
<p>The syntax is a bit arcane, and this is not a course in JavaScript, but
there is a line in the main file for the server, <em>app.js</em>, that reads
this <em>creds_filename</em> value:</p>
<pre><code>var cp = require(__dirname + '/utils/connection_profile_lib/index.js')(process.env.creds_filename, logger);
</code></pre>
<p>Then within <em>utils/connection_profile_lib/index.js</em> is where all the
magic, a.k.a. code, happens to make use of the values specified in that
file.</p>
<p>You did not need to know all this to run the application, but you might
need to know where to start looking when your boss asks you to tailor
the marbles application because she wants a return on the time and money
you spent taking this lab- assuming you don't get off the hook when you
tell her that nowhere was JavaScript mentioned on the agenda.</p>
<p><strong>Step 3.3:</strong> Open up a web browser window or tab and point to
<em>http://&lt;your_IP_goes_here>:3001</em>. Substitute your team's assigned 
IP address instead of <em>&lt;your_IP_goes_here></em>. 
You should see a window pop up that looks like this:</p>
<p><img alt="image" src="../images/lab3/2019-01-20_13-13-53_UserChoice.png" /></p>
<p><strong>Step 3.4:</strong> You are given a choice between <em>Express</em> and <em>Guided</em> for
setting up the demo. Don't short-change yourself- pick <em>Guided</em>,
you'll learn more. After you click <em>Guided</em>, you will see this:</p>
<p><img alt="image" src="../images/lab3/2019-01-20_13-18-31_GuidedStep1.png" /></p>
<p>Read the text in the window to see what's going on.</p>
<p><strong>Step 3.5:</strong> If you do not see <em>Step 1 Complete</em>, ask an instructor for
help. Otherwise, click <em>Next Step</em> and you should see this:</p>
<p><img alt="image" src="../images/lab3/2019-01-20_13-19-49_GuidedStep2.png" /></p>
<p>Click the '+' sign if you wish to see the settings used to contact the
Fabric Certificate Authority.</p>
<p><strong>Step 3.6:</strong> If you do not see <em>Step 2 Complete</em>, ask an instructor for
help. Otherwise, click <em>Next Step</em> and you should see this:</p>
<p><img alt="image" src="../images/lab3/2019-01-20_13-20-56_GuidedStep3.png" /></p>
<p>Click the '+' sign to see information about your environment and your
marbles chaincode.</p>
<p><strong>Step 3.7:</strong> If you do not see <em>Step 3 Complete</em>, ask an instructor for
help. Otherwise, click <em>Next Step</em> and you should see this:</p>
<p><img alt="image" src="../images/lab3/2019-01-20_13-22-12_GuidedStep4-010.png" /></p>
<p><strong>Step 3.8:</strong> Unlike the first three steps, which did not require
further input from you to complete, this step will not proceed until you
click the <em>Create</em> button. Before you do that you have an opportunity to
review and change the names that you use for new marbles owners in
addition to the owner named 'Barry' that should already exist (though
not evident from this screen) if you created it in the first part of
this lab.</p>
<p>Click the <em>Create</em> button when you are ready and after several seconds
you should see <em>Step 4 Complete</em> on the screen:</p>
<p><img alt="image" src="../images/lab3/2019-01-20_13-24-08_GuidedStep4-020.png" /></p>
<p><strong>Step 3.9:</strong> If you do not see <em>Step 4 Complete</em>, ask an instructor for
help. Otherwise, click <em>Next Step</em> and you should see this:</p>
<p><img alt="image" src="../images/lab3/2019-01-20_13-25-29_GuidedStep5.png" /></p>
<p>This should just give you a smiley face and a message saying that setup
is complete.</p>
<p><strong>Step 3.10:</strong> Click <em>Enter</em> and you should be returned to a screen that
looks similar to this (your names may differ):</p>
<p><img alt="image" src="../images/lab3/UnitedMarblesMainPage.png" /></p>
<p><strong>Step 3.11:</strong> What about John's marble for Marbles Inc.? You only
started up the server for United Marbles, so why does Marbles Inc show
up and why is John so lonely? When you did the previous lab, the first
two commands I had you do were an <em>init_owner</em> for John, tying him to
Marbles Inc, and then an <em>init_marble</em>, giving him a marble. Remember,
the "blockchain" is shared among all participants of the channel, so
United Marbles and Marbles Inc both see the same chain- they see each
other's marbles.</p>
<p>But the user names specified in <em>config/marbles2.json</em> are not created
until you start the server for <em>marbles2</em> and log in the first time.
List the contents of <em>marbles2.json</em> file (switch to a free terminal
session or start a new one), e.g.:</p>
<pre><code>bcuser@ubuntu18042:~$ cd ~/zmarbles/marblesUI
bcuser@ubuntu18042:~/zmarbles/marblesUI$ cat config/marbles2.json 
{
    "cred_filename": "connection_profile2.json",
    "use_events": false,
    "keep_alive_secs": 120,
    "company": "Marbles Inc",
    "usernames": [
        "cliff",
        "cody",
        "chuck"
    ],
    "port": 3002,
    "last_startup_hash": ""
}
bcuser@ubuntu18042:~/zmarbles/marblesUI$
</code></pre>
<p><strong>Step 3.12:</strong> Start the second server, the one for Marbles Inc:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles/marblesUI$ gulp marbles2
[16:07:49] Using gulpfile ~/zmarbles/marblesUI/gulpfile.js
[16:07:49] Starting 'env_tls2'...
[16:07:49] Finished 'env_tls2' after 50 μs
[16:07:49] Starting 'build-sass'...
[16:07:49] Finished 'build-sass' after 7.9 ms
[16:07:49] Starting 'watch-sass'...
[16:07:49] Finished 'watch-sass' after 6.38 ms
[16:07:49] Starting 'watch-server'...
[16:07:49] Finished 'watch-server' after 1.9 ms
[16:07:49] Starting 'server'...
info: Checking connection profile is done
info: Loaded config file /home/bcuser/zmarbles/marblesUI/config/marbles2.json
info: Loaded connection profile file /home/bcuser/zmarbles/marblesUI/config/connection_profile2.json



Connection Profile Lib Functions:()
  getNetworkName()
  getNetworkCredFileName()
  buildTlsOpts()
  getFirstChannelId()
  getChannelId()
  loadPem()
  getMarblesField()
  getChaincodeId()
  getChaincodeVersion()
  getFirstCaName()
  getCA()
  getCasUrl()
  getAllCaUrls()
  getCaName()
  getCaTlsCertOpts()
  getEnrollObj()
  getFirstPeerName()
  getPeer()
  getPeersUrl()
  getAllPeerUrls()
  getPeerEventUrl()
  getPeerTlsCertOpts()
  getMarbleUsernamesConfig()
  getCompanyNameFromFile()
  getMarblesPort()
  getEventsSetting()
  getKeepAliveMs()
  getFirstOrdererName()
  getOrderer()
  getOrderersUrl()
  getOrdererTlsCertOpts()
  getBlockDelay()
  getKvsPath()
  getFirstOrg()
  getClientsOrgName()
  getClientOrg()
  getMarbleUsernames()
  getOrgsMSPid()
  getAdminPrivateKeyPEM()
  getAdminSignedCertPEM()


----------------------------------- Server Up - localhost:3002 -----------------------------------
Welcome aboard:  Marbles Inc
Channel:     mychannel
Org:         Org1MSP
CA:      fabric-ca-org2
Orderer:     fabric-orderer
Peer:        fabric-peer-org2
Chaincode ID:    marbles
Chaincode Version:  v4
------------------------------------------ Websocket Up ------------------------------------------


debug: loading pem from a path: /home/bcuser/zmarbles/crypto-config/peerOrganizations/marblesinc.com/ca/ca.marblesinc.com-cert.pem
debug: loading pem from a path: /home/bcuser/zmarbles/crypto-config/ordererOrganizations/blockchain.com/orderers/orderer.blockchain.com/tls/ca.crt
debug: loading pem from a path: /home/bcuser/zmarbles/crypto-config/peerOrganizations/marblesinc.com/peers/peer0.marblesinc.com/tls/ca.crt
info: [fcw] Going to enroll peer_urls=[grpcs://localhost:9051], channel_id=mychannel, uuid=marblesDockerComposeNetworkmychannelOrg1MSPfabricpeerorg2, ca_url=https://localhost:8054, orderer_url=grpcs://localhost:7050, enroll_id=admin2, enroll_secret=adminpw2, msp_id=Org1MSP, kvs_path=/home/bcuser/.hfc-key-store/marblesDockerComposeNetworkmychannelOrg1MSPfabricpeerorg2
debug: enroll id: "admin2", secret: "adminpw2"
debug: msp_id:  Org1MSP ca_name: ca-org1
info: [fcw] Successfully enrolled user 'admin2'
debug: added peer grpcs://localhost:9051
debug: [fcw] Successfully got enrollment marblesDockerComposeNetworkmychannelOrg1MSPfabricpeerorg2
info: Success enrolling admin
debug: loading pem from a path: /home/bcuser/zmarbles/crypto-config/peerOrganizations/marblesinc.com/ca/ca.marblesinc.com-cert.pem
debug: loading pem from a path: /home/bcuser/zmarbles/crypto-config/ordererOrganizations/blockchain.com/orderers/orderer.blockchain.com/tls/ca.crt
debug: loading pem from a path: /home/bcuser/zmarbles/crypto-config/peerOrganizations/marblesinc.com/peers/peer0.marblesinc.com/tls/ca.crt
debug: Checking if chaincode is already instantiated or not 1

info: Checking for chaincode...
debug: [fcw] Querying Chaincode: read()
debug: [fcw] Sending query req: chaincodeId=marbles, fcn=read, args=[selftest], txId=null
debug: [fcw] Peer Query Response - len: 1 type: number
debug: [fcw] Successful query transaction.

----------------------------- Chaincode found on channel "mychannel" -----------------------------


info: Checking chaincode and ui compatibility...
debug: [fcw] Querying Chaincode: read()
debug: [fcw] Sending query req: chaincodeId=marbles, fcn=read, args=[marbles_ui], txId=null
warn: [fcw] warning - query resp is not json, might be okay: string 4.0.1
debug: [fcw] Successful query transaction.
info: Chaincode version is good
info: Checking ledger for marble owners listed in the config file

info: Fetching EVERYTHING...
debug: [fcw] Querying Chaincode: read_everything()
debug: [fcw] Sending query req: chaincodeId=marbles, fcn=read_everything, args=[], txId=null
debug: [fcw] Peer Query Response - len: 2291 type: object
debug: [fcw] Successful query transaction.
debug: This company has registered marble owners
debug: Looking for marble owner: cliff
debug: Did not find marble username: cliff
info: We need to make marble owners


- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
info: Detected that we have NOT launched successfully yet
debug: Open your browser to http://localhost:3002 and login as "admin" to initiate startup
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</code></pre>
<p>If you peek at your browser session from United Marbles, (port 3001),
you will not notice any changes yet.</p>
<p><strong>Step 3.13:</strong> Open a browser tab or window and navigate to
<em>http://&lt;your_IP_here>:3002</em>. You will again be given a choice of
<em>Express</em> or <em>Guided</em> and feel free to choose whichever path suits your
fancy. If you choose <em>Express</em>, everything should hopefully sail through
until you see a screen with all Marbles Inc. owners and marbles, as well
as all United Marbles owners and marbles:</p>
<p><img alt="image" src="../images/lab3/MarblesIncUpdatedPage.png" /></p>
<p><strong>Step 3.14:</strong> If you go back to your screen for United Marbles (port
3001) you should observe that it has been updated to show the owners and
marbles for Marbles Inc. in addition to United Marbles' own owners and
marbles:</p>
<p><img alt="image" src="../images/lab3/UnitedMarblesUpdatedPage.png" /></p>
<p>Remember, you are looking at the United Marbles session but you see all
the new users and marbles created by the Marbles Inc administrator.</p>
<p><strong>Step 3.15:</strong> Play with your marbles!! Here are some things you can do.
When you do things as one user, e.g. as the United Marbles admin, go to
the other user's screen to see that the changes one organization makes
are visible to the other organization:</p>
<ul>
<li>On two different browser sessions, you should be logged in as the
    administrator for each of the two fictitious companies. When you are
    the United Marbles administrator, you can create marbles for you or
    anybody in United Marbles. You can delete marbles for you or anybody
    in United Marbles. You can take marbles from anybody in United
    Marbles and give them to anybody in the network, even to Marbles Inc
    people. (And vice versa when you are a Marbles Inc administrator).</li>
<li>Try clicking on the little magnifying glass to the left of the
    browser window and follow the directions</li>
<li>Right click on a marble (Hint: this is the same as using the
    magnifying glass)</li>
<li>Click on the <strong>Settings</strong> button and <strong>Enable</strong> story mode. Try an
    action that is allowed, and try an action that shouldn't be allowed,
    such as trying to steal a marble from the other company. <strong>Disable</strong>
    story mode when it gets too tedious, which shouldn't take long.</li>
</ul>
<p><strong>Step 3.16:</strong> If you want that extra rush, try these optional advanced
assignments:</p>
<ul>
<li>Break out the previous lab's material and enter the <em>cli</em> container
    and issue some commands to create, update or delete marbles. See if
    the Marbles UI reflects your changes</li>
<li>Look at some of the marbles chaincode container logs while you work
    with the Marbles UI - <strong>Hint:</strong> <em>docker logs [-f] container_name</em>
    will show a container's log. Try it without the optional <em>-f</em>
    argument first and then try it with it. <em>-f</em> ties up your terminal
    session but then shows new log messages as they are created. Press
    <strong>Ctrl-c</strong> to get out of it.</li>
<li>Look at the peer or orderer logs while you work with the Marbles UI</li>
<li>Click the <strong>Start Up Help</strong> button in the upper left in the Marbles
    UI and then number <em>4</em> in the window that pops up. Edit the list of
    names at the bottom and click <strong>Create</strong>. Do your new users show up in
    both companies' sessions? What happens if you add a name that exists
    already? </li>
</ul>
<h1 id="section-4-lab-cleanup">Section 4: Lab cleanup</h1>
<p><strong>Step 4.1:</strong> In both of your terminals sessions that were used to start
each Web UI, press <em>Crtl-c</em> to end the Web UI process. You can also close
the tabs in your browser that were displaying the Web UI.</p>
<p><strong>Step 4.2:</strong> Navigate to the <em>zmarbles</em> directory:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles/marblesUI$ cd ~/zmarbles
bcuser@ubuntu18042:~/zmarbles$
</code></pre>
<p><strong>Step 4.3:</strong> Enter this Docker command to show the running Docker containers
that make up your Hyperledger Fabric network:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles$ docker ps
CONTAINER ID        IMAGE                                                                                                      COMMAND                  CREATED             STATUS              PORTS                                                                       NAMES
1e5c05183d6f        dev-peer1.unitedmarbles.com-marbles-1.0-dea1aa08dc7c6f282a31dd498670173c21d3e75ef0ef1d170b95e1212fbacb77   "chaincode -peer.add…"   26 minutes ago      Up 26 minutes                                                                                   dev-peer1.unitedmarbles.com-marbles-1.0
a7d6b658a35a        dev-peer0.marblesinc.com-marbles-1.0-4077677f13838bacbfd8ff943e7348c00f3c4d6ca6e2838efd14204ca87ea12b      "chaincode -peer.add…"   31 minutes ago      Up 31 minutes                                                                                   dev-peer0.marblesinc.com-marbles-1.0
62a185d148d2        dev-peer0.unitedmarbles.com-marbles-1.0-7e92f069adb7469939a96dcba723fa2019745461f05a562e81cec38e46424aa1   "chaincode -peer.add…"   39 minutes ago      Up 39 minutes                                                                                   dev-peer0.unitedmarbles.com-marbles-1.0
84b6c0ee74aa        hyperledger/fabric-tools:1.4.1                                                                             "bash"                   About an hour ago   Up About an hour                                                                                cli
e6eabd9fd96d        hyperledger/fabric-peer:1.4.1                                                                              "peer node start"        About an hour ago   Up About an hour    0.0.0.0:9051-&gt;7051/tcp, 0.0.0.0:9052-&gt;7052/tcp, 0.0.0.0:9053-&gt;7053/tcp      peer0.marblesinc.com
8174f3021744        hyperledger/fabric-peer:1.4.1                                                                              "peer node start"        About an hour ago   Up About an hour    0.0.0.0:8051-&gt;7051/tcp, 0.0.0.0:8052-&gt;7052/tcp, 0.0.0.0:8053-&gt;7053/tcp      peer1.unitedmarbles.com
1a22b9eb5be5        hyperledger/fabric-peer:1.4.1                                                                              "peer node start"        About an hour ago   Up About an hour    0.0.0.0:10051-&gt;7051/tcp, 0.0.0.0:10052-&gt;7052/tcp, 0.0.0.0:10053-&gt;7053/tcp   peer1.marblesinc.com
11423ca89763        hyperledger/fabric-peer:1.4.1                                                                              "peer node start"        About an hour ago   Up About an hour    0.0.0.0:7051-7053-&gt;7051-7053/tcp                                            peer0.unitedmarbles.com
18b9e5efbfc9        hyperledger/fabric-couchdb:s390x-0.4.15                                                                    "tini -- /docker-ent…"   About an hour ago   Up About an hour    4369/tcp, 9100/tcp, 0.0.0.0:6984-&gt;5984/tcp                                  couchdb1
77288f8c0060        hyperledger/fabric-couchdb:s390x-0.4.15                                                                    "tini -- /docker-ent…"   About an hour ago   Up About an hour    4369/tcp, 9100/tcp, 0.0.0.0:7984-&gt;5984/tcp                                  couchdb2
43214da184da        hyperledger/fabric-ca:1.4.1                                                                                "sh -c 'fabric-ca-se…"   About an hour ago   Up About an hour    0.0.0.0:7054-&gt;7054/tcp                                                      ca_Org0
1ea639c77a3a        hyperledger/fabric-ca:1.4.1                                                                                "sh -c 'fabric-ca-se…"   About an hour ago   Up About an hour    0.0.0.0:8054-&gt;7054/tcp                                                      ca_Org1
07df27e35368        hyperledger/fabric-couchdb:s390x-0.4.15                                                                    "tini -- /docker-ent…"   About an hour ago   Up About an hour    4369/tcp, 9100/tcp, 0.0.0.0:8984-&gt;5984/tcp                                  couchdb3
93e0465394b6        hyperledger/fabric-orderer:1.4.1                                                                           "orderer"                About an hour ago   Up About an hour    0.0.0.0:7050-&gt;7050/tcp                                                      orderer.blockchain.com
4201915cc3b2        hyperledger/fabric-couchdb:s390x-0.4.15                                                                    "tini -- /docker-ent…"   About an hour ago   Up About an hour    4369/tcp, 9100/tcp, 0.0.0.0:5984-&gt;5984/tcp                                  couchdb0
bcuser@ubuntu18042:~/zmarbles$
</code></pre>
<p><strong>Step 4.4:</strong> Enter this command to bring down your Hyperledger Fabric network:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles$ docker-compose down
WARNING: The CHANNEL_NAME variable is not set. Defaulting to a blank string.
Stopping cli                     ... done
Stopping peer0.marblesinc.com    ... done
Stopping peer1.unitedmarbles.com ... done
Stopping peer1.marblesinc.com    ... done
Stopping peer0.unitedmarbles.com ... done
Stopping couchdb1                ... done
Stopping couchdb2                ... done
Stopping ca_Org0                 ... done
Stopping ca_Org1                 ... done
Stopping couchdb3                ... done
Stopping orderer.blockchain.com  ... done
Stopping couchdb0                ... done
Removing cli                     ... done
Removing peer0.marblesinc.com    ... done
Removing peer1.unitedmarbles.com ... done
Removing peer1.marblesinc.com    ... done
Removing peer0.unitedmarbles.com ... done
Removing couchdb1                ... done
Removing couchdb2                ... done
Removing ca_Org0                 ... done
Removing ca_Org1                 ... done
Removing couchdb3                ... done
Removing orderer.blockchain.com  ... done
Removing couchdb0                ... done
Removing network zmarbles_default
bcuser@ubuntu18042:~/zmarbles$
</code></pre>
<p><strong>Step 4.5:</strong> Enter this and you should not see any running Docker containers:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles$ docker ps
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
bcuser@ubuntu18042:~/zmarbles$
</code></pre>
<p><strong>Step 4.6:</strong> Add the <em>--all</em> argument to the prior command and you will see some
<em>Exited</em> Docker containers:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles$ docker ps --all
CONTAINER ID        IMAGE                                                                                                      COMMAND                  CREATED             STATUS                          PORTS               NAMES
1e5c05183d6f        dev-peer1.unitedmarbles.com-marbles-1.0-dea1aa08dc7c6f282a31dd498670173c21d3e75ef0ef1d170b95e1212fbacb77   "chaincode -peer.add…"   28 minutes ago      Exited (0) About a minute ago                       dev-peer1.unitedmarbles.com-marbles-1.0
a7d6b658a35a        dev-peer0.marblesinc.com-marbles-1.0-4077677f13838bacbfd8ff943e7348c00f3c4d6ca6e2838efd14204ca87ea12b      "chaincode -peer.add…"   33 minutes ago      Exited (0) About a minute ago                       dev-peer0.marblesinc.com-marbles-1.0
62a185d148d2        dev-peer0.unitedmarbles.com-marbles-1.0-7e92f069adb7469939a96dcba723fa2019745461f05a562e81cec38e46424aa1   "chaincode -peer.add…"   41 minutes ago      Exited (0) About a minute ago                       dev-peer0.unitedmarbles.com-marbles-1.0
bcuser@ubuntu18042:~/zmarbles$
</code></pre>
<p><strong>Step 4.7:</strong> Enter this command to remove these containers:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles$ docker rm $(docker ps --all --quiet)
1e5c05183d6f
a7d6b658a35a
62a185d148d2
bcuser@ubuntu18042:~/zmarbles$
</code></pre>
<p><strong>Step 4.8:</strong> Repeat the command from <em>Step 4.6</em> and you should not see any containers:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles$ docker ps --all
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
bcuser@ubuntu18042:~/zmarbles$
</code></pre>
<p><strong>Step 4.9:</strong> List your Docker images:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles$ docker images
REPOSITORY                                                                                                 TAG                 IMAGE ID            CREATED             SIZE
dev-peer1.unitedmarbles.com-marbles-1.0-dea1aa08dc7c6f282a31dd498670173c21d3e75ef0ef1d170b95e1212fbacb77   latest              c0e41de218a2        30 minutes ago      137MB
dev-peer0.marblesinc.com-marbles-1.0-4077677f13838bacbfd8ff943e7348c00f3c4d6ca6e2838efd14204ca87ea12b      latest              ab7f5fa821ee        35 minutes ago      137MB
dev-peer0.unitedmarbles.com-marbles-1.0-7e92f069adb7469939a96dcba723fa2019745461f05a562e81cec38e46424aa1   latest              d41acea306aa        43 minutes ago      137MB
hyperledger/fabric-ca                                                                                      1.4.1               a836041637e8        2 weeks ago         220MB
hyperledger/fabric-tools                                                                                   1.4.1               330902566372        2 weeks ago         1.52GB
hyperledger/fabric-ccenv                                                                                   latest              8583516cfc43        2 weeks ago         1.41GB
hyperledger/fabric-orderer                                                                                 1.4.1               1b709e319b2d        2 weeks ago         148MB
hyperledger/fabric-peer                                                                                    1.4.1               719392658c28        2 weeks ago         154MB
hyperledger/fabric-couchdb                                                                                 s390x-0.4.15        81ee917e0be2        5 weeks ago         1.55GB
hyperledger/fabric-baseos                                                                                  s390x-0.4.15        d4eb16b952d6        5 weeks ago         120MB
bcuser@ubuntu18042:~/zmarbles$
</code></pre>
<p><strong>Step 4.10:</strong> This command will format the output from <em>docker images</em>:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles$ docker images --format '{{.Repository}}:{{.Tag}}'
dev-peer1.unitedmarbles.com-marbles-1.0-dea1aa08dc7c6f282a31dd498670173c21d3e75ef0ef1d170b95e1212fbacb77:latest
dev-peer0.marblesinc.com-marbles-1.0-4077677f13838bacbfd8ff943e7348c00f3c4d6ca6e2838efd14204ca87ea12b:latest
dev-peer0.unitedmarbles.com-marbles-1.0-7e92f069adb7469939a96dcba723fa2019745461f05a562e81cec38e46424aa1:latest
hyperledger/fabric-ca:1.4.1
hyperledger/fabric-tools:1.4.1
hyperledger/fabric-ccenv:latest
hyperledger/fabric-orderer:1.4.1
hyperledger/fabric-peer:1.4.1
hyperledger/fabric-couchdb:s390x-0.4.15
hyperledger/fabric-baseos:s390x-0.4.15
bcuser@ubuntu18042:~/zmarbles$
</code></pre>
<p><strong>Step 4.11:</strong> The output from the prior step is in a format acceptable to the Docker command to remove images, so 
this command will feed that output into the Docker <em>rmi</em> command, and remove these images:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles$ docker rmi $(docker images --format '{{.Repository}}:{{.Tag}}')
Untagged: dev-peer1.unitedmarbles.com-marbles-1.0-dea1aa08dc7c6f282a31dd498670173c21d3e75ef0ef1d170b95e1212fbacb77:latest
Deleted: sha256:c0e41de218a260a73053d538aa45ca0f925cd3ee7d8898151ea7df39dc1ac813
Deleted: sha256:40fc70560501ded0fbf1d7bc6a2e77de321041a62770822f692977cd363f16be
Deleted: sha256:4a8c59ccf0d503088d13b041260d4741509656336b431e6bb7e64b20a91b90fb
Deleted: sha256:8ce2cde820ef4ccfef99f8389315141614441b89219de487da33db3494874c8b
Untagged: dev-peer0.marblesinc.com-marbles-1.0-4077677f13838bacbfd8ff943e7348c00f3c4d6ca6e2838efd14204ca87ea12b:latest
Deleted: sha256:ab7f5fa821ee42c139722b2360909c95c1b2586cb437686122af1e571bd34802
Deleted: sha256:f7a0e17801a42a44340f27cb7c7332314534d1ed2d4573cb5334f27289dc5ff0
Deleted: sha256:8085444130169915f706aecfac10aaeee4d3e641e63e4686258c513e6fe85830
Deleted: sha256:e0f59705093caa197dde37fba5d05aa4635465b5d42e8d48234b9a28d3423a48
Untagged: dev-peer0.unitedmarbles.com-marbles-1.0-7e92f069adb7469939a96dcba723fa2019745461f05a562e81cec38e46424aa1:latest
Deleted: sha256:d41acea306aa6d858cca4f55bb92b20335da5a588550411d32fc77def25d3775
Deleted: sha256:493804d997703675b48104eed5e6868b1e6f14bf954fbb56ac5784a82838ccbf
Deleted: sha256:3504ecc13cf81ec4947132a9261600f1e9cdeee94672df62469f2061bd1a4b2a
Deleted: sha256:8267b35c52b6b78b7341b95c5c044a69feb53075c704b2eea87a4d4b6036be06
Untagged: hyperledger/fabric-ca:1.4.1
Untagged: hyperledger/fabric-ca@sha256:f77aa0ff885c572b090d1ff7564780daafd50d9e839b6241c2ab12c37f47b94a
Deleted: sha256:a836041637e817846f71541e47e8749f6188676a1ac282f006ca03758290f4ff
Deleted: sha256:8fa3260318e50be92f0118657fa3aa395e264cfa2fbe0dbedb9419fff1547bfd
Deleted: sha256:f0c44e96c65ce80eaeb561f89fa23ae82c5af54b1b1b050ecadd827b45bebd23
Deleted: sha256:e2e8ca9c5a2fb8c69e32428be2f27d6bb0c1e1b7e58af5d4d5aa788ce8d9fd68
Deleted: sha256:a353d8ddb009e3c0dd6bd0558a1e3ed847951f42ae632a91ad49029bb69b9fc0
Deleted: sha256:f1079f0f139b61ea01f32de10d58de81e1fc393038d3fa774221a736f942023f
Deleted: sha256:165d46e0e538aacfcecf19a4088c2e7b490384e7b3cecb090a16b19cba8722d9
Deleted: sha256:85fb95169355a4e6fcd52672b1e60739f120ee9e541413732cb53d8e5c97beae
Untagged: hyperledger/fabric-tools:1.4.1
Untagged: hyperledger/fabric-tools@sha256:c458ddc3109d3519b209baaf9abff113641267ec2adb01dfdcf8f4c9e77a2fa0
Deleted: sha256:330902566372ecfc06a396c05d026a0d17fa40379dc1327894869ad370023637
Deleted: sha256:1021b7b3b232c0954f944c6d2baec3ef80dc9481bcabea5a12db4f7d276c86f7
Deleted: sha256:9427db3491c3adcb8cecfcf50bb3c8deeab27d3739538c2cd246ee6b856515a9
Deleted: sha256:dba040b6371fcdc2b78128d10e952cc716b75ba67f2dc330086c908fb830fa1d
Untagged: hyperledger/fabric-ccenv:latest
Untagged: hyperledger/fabric-ccenv@sha256:bb929eef560b50e0fbd730c6b195e49fece28dd4612ec30db0ce2cc096483463
Deleted: sha256:8583516cfc43491e2db2e393408121b85636f622d39d2a8e3c46ac278d3d3ce2
Deleted: sha256:3d53a661451588e08ea4f0b1e6fac40633b4dcef9fb895ad12f9309453d85dfa
Deleted: sha256:04e554cb54244558f5567c17ebcb7a02b64822036ece595fefb4f98d2ab31a7a
Deleted: sha256:a2ec3c9f4ab3e2a789239638d99aa4a760998c8424d29313d5461bcfd2929612
Untagged: hyperledger/fabric-orderer:1.4.1
Untagged: hyperledger/fabric-orderer@sha256:09f31ca4dabe1eb2af870ea062561ca6686fc59a296ecc3b4bd7e32102c48934
Deleted: sha256:1b709e319b2d2e7d137112ff5e24b7b6a0ddf0a5bf8843c47adfc9095b3f8778
Deleted: sha256:43747e128cff58f58f5642bce1b27613ecb3dec5aa8fc7caf0ce5e2397415371
Deleted: sha256:fb1a267f0371757e83dcf6221291269b29a7089a0f7a8545ff3f538509e19e0e
Untagged: hyperledger/fabric-peer:1.4.1
Untagged: hyperledger/fabric-peer@sha256:05315d05b2892d34b4ed48f6502d28fe15a71090c36a39c97022a44475a984ad
Deleted: sha256:719392658c28f69bb25ccc71a8da86050f646f4ffaf51a279cdcea079b5f993e
Deleted: sha256:04d6dbf6b6fcdaaedb6d55a021bd1dcb0695ecfbe9e2538fe2dd1365987eea0b
Deleted: sha256:4c58d7859aeaf30d72dada842ce28df9d542e2ffc1ab2213b81483f080adceef
Deleted: sha256:6299707a98af34860777b48b86df6ec7ae8cf45ae76cbf4cbedcb1dc55888061
Untagged: hyperledger/fabric-couchdb:s390x-0.4.15
Untagged: hyperledger/fabric-couchdb@sha256:e8701a2dd7400d200a6c3b1ffd42331e2d5255d30c1efb117fc5a10bbf9063b6
Deleted: sha256:81ee917e0be2fe0b5f46cf6ed34d32169118c8d995cee636ce47ffb96d3afd95
Deleted: sha256:e4cdccb03102bce02d4e9179cf1eed5808e97bb77fb7bf7596776900caf3f22a
Deleted: sha256:12e70245586bf85d0f2eabc4ba33c1df77d51e604c294551e43c9dec425f619c
Deleted: sha256:f7a35da6c7b30fa6fa11e2f6e44938ea4df158db403064832a73d1e9b11aa719
Deleted: sha256:1b774897931652fde3bb2609e0f46fa4c3a3f522db395359a2aeee1a218aab54
Deleted: sha256:1132017bbb8c969f03a11ec80e77eea71a3fc54dbae9e2b588b01fc5c0502972
Deleted: sha256:de23c4b00ab7d92310f73b45cacf5b861a8f40c5b069c0660eb1bc6d472c98e7
Deleted: sha256:62306dc38b9fc0fb7922d4d1358d135e1c7411b01e51bb631fc5269308387c42
Deleted: sha256:8bc0cb77c66908a5059433ca0b41f453721de3bc529ecc258ff91818ce19e87f
Deleted: sha256:8445d7f0d5111f5ee7fe4ada50d718df0977e9b071045e09b3d619effd16d7e0
Deleted: sha256:f593f65839abaaf5f0c18604b7f065b4cab58bfeafa867b7be75fc6ca52e187a
Deleted: sha256:18eaede2be21b8fdba162857cbf79ce9a04cb2671da8c40dc804280e791e9742
Deleted: sha256:ef88e98e5731409ad689aec3233fcca8d5f1b38e435558308d8289fb3d5a5383
Deleted: sha256:9941b43bff58fff3234b1f356d65f1d383265156c82ba90805a00ba758e5fa14
Deleted: sha256:31699b2e24542ffbc8cf9678644e62ab195263be033713327992314d59ddffbb
Untagged: hyperledger/fabric-baseos:s390x-0.4.15
Untagged: hyperledger/fabric-baseos@sha256:94fefcbeb2c0da7ac6371ad589b66b2bbe7cfb76bf28ba7aaf85790bed82c839
Deleted: sha256:d4eb16b952d6c8b742cbe47caf6522c71f9b1654a31abc582918905d64db07e7
Deleted: sha256:234cfc5f3368cd92d65d03e5da6bc0bd985ab94c4931e692faa758bd6d811c7b
Deleted: sha256:3e2d2d75f895801cefdecac9e2584d964caf0ed7fb1d8afeffeaea5e287ea9cb
Deleted: sha256:d8e11f36fc45b7073d3b0eb3636428dedebb40f392bea9fa5751ed92848ca875
bcuser@ubuntu18042:~/zmarbles$
</code></pre>
<p><strong>Step 4.12:</strong>  Now you should not see any images:</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
bcuser@ubuntu18042:~/zmarbles$          IMAGE ID            CREATED             SIZE
</code></pre>
<p><strong>Step 4.13:</strong> You may type <em>exit</em> from your terminal session(s) to log out of the system</p>
<pre><code>bcuser@ubuntu18042:~/zmarbles$ exit
logout
Connection to 192.168.22.1xx closed.
Barrys-MacBook-Pro:ImmersionWorkshop silliman$
</code></pre>
<p><strong>End of lab!</strong></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c648116f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>